Template: libpam-llng/pam-mode
Type: select
Choices: none, mode-a, mode-b, mode-c, mode-d
Default: none
_Description: PAM authentication mode for LemonLDAP::NG:
 Choose how to configure PAM authentication:
 .
  * none: Do not configure PAM automatically
  * mode-a: LLNG token only (strictest)
  * mode-b: LLNG token OR Unix password (fallback)
  * mode-c: SSH key with LLNG authorization only
  * mode-d: All methods (SSH keys, LLNG tokens, Unix passwords)
 .
 All modes require LLNG authorization to access this server.

Template: libpam-llng/portal-url
Type: string
Default:
_Description: LemonLDAP::NG portal URL:
 Enter the URL of your LemonLDAP::NG portal (e.g., https://auth.example.com).

Template: libpam-llng/client-id
Type: string
Default: pam-access
_Description: OIDC client ID:
 Enter the OIDC client ID configured in LemonLDAP::NG for PAM access.

Template: libpam-llng/client-secret
Type: password
_Description: OIDC client secret:
 Enter the client secret for the OIDC client.

Template: libpam-llng/server-group
Type: string
Default: default
_Description: Server group name:
 Enter the server group name for authorization rules.
 This must match a group defined in LLNG's pamAccessServerGroups.

Template: libpam-llng/configure-sudo
Type: boolean
Default: false
_Description: Configure PAM for sudo?
 Set this to true if you want to configure /etc/pam.d/sudo with LLNG
 authentication. This allows using LLNG tokens for sudo commands.

Template: libpam-llng/sudo-server-group
Type: string
Default:
_Description: Server group name for sudo:
 Enter the server group name for sudo authorization rules.
 .
 This allows different authorization rules for SSH access and sudo usage.
 Leave empty to use the same group as SSH.

Template: libpam-llng/create-user
Type: boolean
Default: false
_Description: Auto-create Unix accounts on first login?
 If enabled, Unix accounts will be created automatically when a user
 authenticates for the first time via LemonLDAP::NG.
 .
 User attributes (gecos, shell, home) can be exported from LLNG via
 pamAccessExportedVars configuration.
