diff --git a/doc/sources/admin/idpopenidconnect.rst b/doc/sources/admin/idpopenidconnect.rst
index a3935fbd4..3ce0dd7a4 100644
--- a/doc/sources/admin/idpopenidconnect.rst
+++ b/doc/sources/admin/idpopenidconnect.rst
@@ -39,6 +39,7 @@ As an OP, LL::NG supports many OpenID Connect features:
 -  Optional JWT Access Tokens (Since ``2.0.12``) - See :rfc:`9068`
 -  `Form Post Response Mode <https://openid.net/specs/oauth-v2-form-post-response-mode-1_0.html>`__ (Since ``2.0.16``)
 -  Encrypted JWT (Since ``2.18.0``) - See :rfc:`7516`
+-  :doc:`Device Authorization Grant<oidcdeviceauthorization>` (Since ``2.23.0``) - See :rfc:`8628`
 
 Configuration
 -------------
diff --git a/doc/sources/admin/index_dev.rst b/doc/sources/admin/index_dev.rst
index e1c2a0daa..484e3b323 100644
--- a/doc/sources/admin/index_dev.rst
+++ b/doc/sources/admin/index_dev.rst
@@ -12,3 +12,4 @@ Development
    customhandlers
    customconfigplaceholder
    oidctokenexchange
+   oidcdeviceauthorization
diff --git a/doc/sources/admin/index_plugins.rst b/doc/sources/admin/index_plugins.rst
index 89fbca7e2..558af802d 100644
--- a/doc/sources/admin/index_plugins.rst
+++ b/doc/sources/admin/index_plugins.rst
@@ -26,6 +26,7 @@ Plugins
    locationdetect
    loginhistory
    notifications
+   pamaccess
    public_pages
    refreshsessionapi
    rememberauthchoice
diff --git a/doc/sources/admin/oidcdeviceauthorization.rst b/doc/sources/admin/oidcdeviceauthorization.rst
new file mode 100644
index 000000000..b478d7656
--- /dev/null
+++ b/doc/sources/admin/oidcdeviceauthorization.rst
@@ -0,0 +1,159 @@
+OpenID Connect Device Authorization Grant
+=========================================
+
+Presentation
+------------
+
+The Device Authorization Grant (defined in :rfc:`8628`) is an OAuth 2.0
+extension that enables devices with limited input capabilities (such as
+smart TVs, IoT devices, or CLI tools) to obtain user authorization.
+
+The flow works as follows:
+
+1. The device requests authorization from the server and receives a
+   ``device_code`` and a ``user_code``
+2. The device displays the ``user_code`` and a verification URL to the user
+3. The user visits the verification URL on another device (e.g., smartphone)
+   and enters the ``user_code``
+4. The user authenticates and approves the authorization
+5. The device polls the token endpoint until the user completes authorization
+6. Once approved, the device receives access and refresh tokens
+
+Configuration
+-------------
+
+Global Settings
+~~~~~~~~~~~~~~~
+
+Go to ``General Parameters`` » ``Issuer modules`` » ``OpenID Connect`` »
+``OpenID Connect Service`` » ``Device Authorization``:
+
+-  **Expiration**: Time in seconds before the device code expires
+   (default: 600 seconds / 10 minutes)
+-  **Polling interval**: Minimum time in seconds between polling requests
+   from the device (default: 5 seconds)
+-  **User code length**: Number of characters in the user code
+   (default: 8 characters)
+
+Relying Party Settings
+~~~~~~~~~~~~~~~~~~~~~~
+
+For each Relying Party that needs Device Authorization Grant support,
+go to ``OpenID Connect Relying Parties`` » *your RP* » ``Options`` »
+``Advanced`` and enable:
+
+-  **Allow Device Authorization Grant**: Set to ``On``
+
+Endpoints
+---------
+
+Device Authorization Endpoint
+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+
+**URL**: ``/oauth2/device``
+
+**Method**: POST
+
+**Parameters**:
+
+-  ``client_id`` (required): The client identifier
+-  ``scope`` (optional): Space-separated list of requested scopes
+   (default: ``openid``)
+
+**Example request**:
+
+::
+
+   curl -X POST \
+     -d "client_id=my-device-app" \
+     -d "scope=openid profile email" \
+     https://auth.example.com/oauth2/device
+
+**Example response**:
+
+.. code-block:: json
+
+   {
+     "device_code": "GmRhmhcxhwAzkoEqiMEg_DnyEysNkuNhszIySk9eS",
+     "user_code": "WDJB-MJHT",
+     "verification_uri": "https://auth.example.com/device",
+     "verification_uri_complete": "https://auth.example.com/device?user_code=WDJBMJHT",
+     "expires_in": 600,
+     "interval": 5
+   }
+
+User Verification Endpoint
+~~~~~~~~~~~~~~~~~~~~~~~~~~
+
+**URL**: ``/device``
+
+This is a web page where authenticated users enter the ``user_code`` to
+approve or deny the device authorization request.
+
+Users can either:
+
+-  Visit ``verification_uri`` and manually enter the code
+-  Visit ``verification_uri_complete`` which pre-fills the code
+
+Token Endpoint (Polling)
+~~~~~~~~~~~~~~~~~~~~~~~~
+
+**URL**: ``/oauth2/token``
+
+**Method**: POST
+
+**Parameters**:
+
+-  ``grant_type``: Must be ``urn:ietf:params:oauth:grant-type:device_code``
+-  ``device_code``: The device code received from the authorization endpoint
+-  ``client_id``: The client identifier (or use HTTP Basic authentication)
+
+**Example request**:
+
+::
+
+   curl -X POST \
+     -d "grant_type=urn:ietf:params:oauth:grant-type:device_code" \
+     -d "device_code=GmRhmhcxhwAzkoEqiMEg_DnyEysNkuNhszIySk9eS" \
+     -d "client_id=my-device-app" \
+     -d "client_secret=my-secret" \
+     https://auth.example.com/oauth2/token
+
+**Possible responses**:
+
+-  **authorization_pending**: User hasn't completed authorization yet,
+   continue polling
+-  **slow_down**: Polling too frequently, increase interval
+-  **access_denied**: User denied the authorization request
+-  **expired_token**: Device code has expired, restart the flow
+-  **Success**: Returns ``access_token``, ``id_token``, and optionally
+   ``refresh_token``
+
+User Code Format
+----------------
+
+The user code follows RFC 8628 recommendations:
+
+-  Uses only uppercase consonants (BCDFGHJKLMNPQRSTVWXZ) and digits (23456789)
+-  Excludes vowels to avoid accidentally forming offensive words
+-  Excludes confusing characters (0/O, 1/I/L)
+-  Displayed with a hyphen for readability (e.g., ``WDJB-MJHT``)
+-  Input is case-insensitive and hyphens are optional
+
+Security Considerations
+-----------------------
+
+-  Device codes and user codes are single-use and expire after the
+   configured timeout
+-  The polling interval prevents brute-force attacks on user codes
+-  User codes have sufficient entropy to resist guessing attacks
+-  Users must be authenticated before approving device requests
+-  The verification page shows the requesting application details
+   before approval
+
+See Also
+--------
+
+-  :rfc:`8628` - OAuth 2.0 Device Authorization Grant
+-  :doc:`OpenID Connect Provider documentation<idpopenidconnect>`
+-  :doc:`OpenID Connect Service configuration<openidconnectservice>`
diff --git a/doc/sources/admin/pamaccess.rst b/doc/sources/admin/pamaccess.rst
new file mode 100644
index 000000000..b14d500d9
--- /dev/null
+++ b/doc/sources/admin/pamaccess.rst
@@ -0,0 +1,824 @@
+PAM Access
+==========
+
+Presentation
+------------
+
+The PAM Access plugin provides a bridge between LemonLDAP::NG and PAM-enabled
+services (such as SSH servers). It enables two authentication scenarios:
+
+1. **Token-based authentication**: Users generate temporary tokens via the
+   portal that can be used as passwords for PAM services
+2. **Authorization-only**: Servers can verify user authorization even when
+   authentication happens via other means (e.g., SSH keys)
+
+This plugin requires:
+
+- :doc:`OpenID Connect Provider<idpopenidconnect>` to be enabled
+- :doc:`Device Authorization Grant<oidcdeviceauthorization>` for server enrollment
+
+Architecture
+------------
+
+.. code-block:: text
+
+   ┌─────────────────┐     ┌──────────────────┐     ┌─────────────────┐
+   │   User          │     │  PAM Server      │     │  LLNG Portal    │
+   │                 │     │  (pam_llng.so)   │     │                 │
+   └────────┬────────┘     └────────┬─────────┘     └────────┬────────┘
+            │                       │                        │
+            │ 1. /pam → generate    │                        │
+            │    access_token       │                        │
+            │───────────────────────┼───────────────────────>│
+            │<──────────────────────┼────────────────────────│
+            │   token + login       │                        │
+            │                       │                        │
+            │ 2. ssh user@server    │                        │
+            │   password: <token>   │                        │
+            │──────────────────────>│                        │
+            │                       │ 3. introspection       │
+            │                       │───────────────────────>│
+            │                       │<───────────────────────│
+            │                       │   active, sub, groups  │
+            │                       │                        │
+            │                       │ 4. /pam/authorize      │
+            │                       │   (for SSH key auth)   │
+            │                       │───────────────────────>│
+            │                       │<───────────────────────│
+            │<──────────────────────│   authorized: true     │
+            │   SSH session         │                        │
+
+Configuration
+-------------
+
+Global Settings
+~~~~~~~~~~~~~~~
+
+Go to ``General Parameters`` » ``Plugins`` » ``PAM Access``:
+
+- **Activation**: Enable the PAM Access plugin
+- **Default token duration**: Default validity of generated tokens in seconds
+  (default: 600)
+- **Maximum token duration**: Maximum allowed token validity in seconds
+  (default: 3600)
+- **Server groups**: Hash of server group names to authorization rules (see below)
+- **OIDC Relying Party**: Name of the OIDC RP to use for token generation
+  (default: ``pam-access``)
+
+Portal Display
+~~~~~~~~~~~~~~
+
+Go to ``General Parameters`` » ``Portal`` » ``Menu`` » ``Modules``:
+
+- **Display PAM Access**: Rule to display the PAM Access tab in user portal
+  (default: ``0``, disabled)
+
+OIDC Relying Party Setup
+~~~~~~~~~~~~~~~~~~~~~~~~
+
+Create a dedicated Relying Party for PAM tokens:
+
+1. Go to ``OpenID Connect Relying Parties`` » ``Add RP``
+2. Configure:
+
+   - **Client ID**: ``pam-access``
+   - **Client secret**: Generate a secure secret
+   - **Access token expiration**: 600 (or desired default)
+   - **Allow Device Authorization Grant**: ``On`` (for server enrollment)
+
+3. Add scope rules in ``Scope values`` » ``Extra scopes``:
+
+   - ``pam``: ``1``
+   - ``pam:server``: ``1``
+
+Server Enrollment
+-----------------
+
+PAM servers must enroll using the :doc:`Device Authorization Grant<oidcdeviceauthorization>`
+before they can use the ``/pam/authorize`` endpoint.
+
+Enrollment Script
+~~~~~~~~~~~~~~~~~
+
+Run on the PAM server:
+
+.. code-block:: bash
+
+   #!/bin/bash
+   PORTAL_URL="https://auth.example.com"
+   CLIENT_ID="pam-access"
+   CLIENT_SECRET="your-secret"
+
+   # 1. Initiate Device Authorization
+   response=$(curl -s -X POST "${PORTAL_URL}/oauth2/device" \
+       -d "client_id=${CLIENT_ID}" \
+       -d "scope=pam:server")
+
+   device_code=$(echo "$response" | jq -r '.device_code')
+   user_code=$(echo "$response" | jq -r '.user_code')
+   verification_uri=$(echo "$response" | jq -r '.verification_uri')
+   interval=$(echo "$response" | jq -r '.interval')
+
+   echo "================================================"
+   echo "Enrollment code: $user_code"
+   echo "Validation URL:  $verification_uri"
+   echo "================================================"
+   echo "Ask an administrator to validate this code."
+   echo "Waiting for approval..."
+
+   # 2. Poll for token
+   while true; do
+       sleep $interval
+       token_response=$(curl -s -X POST "${PORTAL_URL}/oauth2/token" \
+           -d "grant_type=urn:ietf:params:oauth:grant-type:device_code" \
+           -d "device_code=${device_code}" \
+           -d "client_id=${CLIENT_ID}" \
+           -d "client_secret=${CLIENT_SECRET}")
+
+       error=$(echo "$token_response" | jq -r '.error // empty')
+       if [[ -z "$error" ]]; then
+           echo "$token_response" > /etc/pam-llng/credentials.json
+           chmod 600 /etc/pam-llng/credentials.json
+           echo "Enrollment successful!"
+           exit 0
+       elif [[ "$error" == "authorization_pending" ]]; then
+           continue
+       elif [[ "$error" == "slow_down" ]]; then
+           interval=$((interval + 5))
+       else
+           echo "Error: $error"
+           exit 1
+       fi
+   done
+
+Admin Approval
+~~~~~~~~~~~~~~
+
+1. Administrator logs into the LemonLDAP::NG portal
+2. Navigate to the verification URL (e.g., ``https://auth.example.com/device``)
+3. Enter the user code displayed by the enrollment script
+4. Review the server details and approve
+
+Endpoints
+---------
+
+User Token Generation
+~~~~~~~~~~~~~~~~~~~~~
+
+**URL**: ``/pam``
+
+**Methods**: GET, POST
+
+**Authentication**: Required (SSO session)
+
+GET Request
+^^^^^^^^^^^
+
+Displays the token generation interface in the portal.
+
+POST Request
+^^^^^^^^^^^^
+
+Generates a new PAM access token.
+
+**Parameters**:
+
+- ``duration`` (optional): Token validity in seconds (default: configured value)
+
+**Example request**:
+
+.. code-block:: bash
+
+   curl -X POST \
+     -b "lemonldap=session_cookie" \
+     -d "duration=300" \
+     https://auth.example.com/pam
+
+**Example response**:
+
+.. code-block:: json
+
+   {
+     "token": "abc123def456...",
+     "login": "jdoe",
+     "expires_in": 300
+   }
+
+Server Authorization Check
+~~~~~~~~~~~~~~~~~~~~~~~~~~
+
+**URL**: ``/pam/authorize``
+
+**Method**: POST
+
+**Authentication**: Bearer token (from Device Authorization Grant)
+
+This endpoint allows enrolled PAM servers to check if a user is authorized,
+even when the user authenticates via SSH key (no user token involved).
+
+**Request headers**:
+
+- ``Authorization: Bearer <server_access_token>``
+- ``Content-Type: application/json``
+
+**Request body**:
+
+.. code-block:: json
+
+   {
+     "user": "jdoe",
+     "host": "srv01.example.com",
+     "server_group": "production",
+     "service": "ssh"
+   }
+
+**Parameters**:
+
+- ``user`` (required): Username to check
+- ``host`` (optional): Target host for rule evaluation
+- ``server_group`` (optional): Server group name for rule selection (default: ``default``)
+- ``service`` (optional): Service name for rule evaluation (default: ``ssh``)
+
+**Example request**:
+
+.. code-block:: bash
+
+   curl -X POST \
+     -H "Authorization: Bearer server_token_here" \
+     -H "Content-Type: application/json" \
+     -d '{"user": "jdoe", "host": "srv01.example.com"}' \
+     https://auth.example.com/pam/authorize
+
+**Success response** (HTTP 200):
+
+.. code-block:: json
+
+   {
+     "authorized": true,
+     "user": "jdoe",
+     "groups": ["ssh-users", "developers"]
+   }
+
+**Denied response** (HTTP 200):
+
+.. code-block:: json
+
+   {
+     "authorized": false,
+     "user": "jdoe",
+     "groups": ["guests"],
+     "reason": "Access denied by rule"
+   }
+
+**Error responses**:
+
+- ``401 Unauthorized``: Missing or invalid Bearer token
+- ``403 Forbidden``: Token not from Device Authorization Grant (server not enrolled)
+- ``400 Bad Request``: Missing user parameter or invalid JSON
+
+Server Groups and Authorization Rules
+-------------------------------------
+
+The ``pamAccessServerGroups`` configuration allows you to define different
+authorization rules for different groups of servers. Each PAM server specifies
+its group via the ``server_group`` parameter in the authorization request.
+
+Configuration
+~~~~~~~~~~~~~
+
+In the Manager, go to ``General Parameters`` » ``Plugins`` » ``PAM Access`` »
+``Server groups`` and add entries:
+
+.. list-table::
+   :header-rows: 1
+
+   * - Server Group
+     - Authorization Rule
+   * - ``default``
+     - ``1`` (fallback for servers without a specific group)
+   * - ``production``
+     - ``$hGroup->{ops}``
+   * - ``staging``
+     - ``$hGroup->{ops} or $hGroup->{dev}``
+   * - ``dev``
+     - ``$hGroup->{dev} or $uid eq 'admin'``
+
+How It Works
+~~~~~~~~~~~~
+
+1. The PAM server sends its ``server_group`` in the authorization request
+2. LemonLDAP::NG looks up the corresponding rule in ``pamAccessServerGroups``
+3. If the group is not found, the ``default`` rule is used
+4. If no ``default`` rule exists, access is denied
+
+PAM Server Configuration
+~~~~~~~~~~~~~~~~~~~~~~~~
+
+On each PAM server, configure the server group in ``/etc/pam-llng/config``:
+
+.. code-block:: ini
+
+   [server]
+   portal_url = https://auth.example.com
+   server_group = production
+
+Available Variables in Rules
+~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+
+- ``$user`` or ``$uid``: Username
+- ``$groups``: User's groups (comma-separated string)
+- ``$hGroup``: Hash of groups (for ``$hGroup->{groupname}`` syntax)
+- ``$_pamHost``: Target host (from request)
+- ``$_pamService``: Service name (from request)
+- ``$_pamServerGroup``: Server group name
+- All session attributes and macros
+
+Rule Examples
+~~~~~~~~~~~~~
+
+**Allow all authenticated users:**
+
+.. code-block:: perl
+
+   1
+
+**Deny all (useful for explicit whitelisting):**
+
+.. code-block:: perl
+
+   0
+
+**Allow only users in a specific group:**
+
+.. code-block:: perl
+
+   $hGroup->{ssh-users}
+
+**Allow multiple groups:**
+
+.. code-block:: perl
+
+   $hGroup->{ops} or $hGroup->{developers}
+
+**Allow a specific user:**
+
+.. code-block:: perl
+
+   $uid eq 'admin'
+
+**Combine group and user conditions:**
+
+.. code-block:: perl
+
+   $hGroup->{dev} or $uid eq 'contractor1'
+
+**Use regex on groups string:**
+
+.. code-block:: perl
+
+   $groups =~ /\b(ops|sysadmin)\b/
+
+User Guide
+----------
+
+This section describes the end-user experience for SSH authentication using
+PAM Access tokens.
+
+Step 1: Log into the Portal
+~~~~~~~~~~~~~~~~~~~~~~~~~~~
+
+Open your web browser and navigate to your organization's LemonLDAP::NG portal
+(e.g., ``https://auth.example.com``). Authenticate using your usual credentials
+(username/password, second factor if required, etc.).
+
+Step 2: Access the PAM Access Interface
+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+
+Once logged in, look for the **PAM Access** tab in the portal menu. Click on it
+to access the token generation interface.
+
+.. note::
+   If you don't see the PAM Access tab, contact your administrator. The tab
+   visibility is controlled by access rules and may be restricted to certain
+   users or groups.
+
+Step 3: Generate a Token
+~~~~~~~~~~~~~~~~~~~~~~~~
+
+On the PAM Access page, you will see:
+
+- A **duration selector** allowing you to choose how long the token will be valid
+  (e.g., 5 minutes, 10 minutes, up to the maximum allowed by your administrator)
+- A **Generate** button
+
+Select your desired duration and click **Generate**. The system will create a
+temporary access token and display:
+
+- Your **login name** (the username to use for SSH)
+- The **token** (a long string of characters)
+- The **expiration time**
+
+.. warning::
+   The token is displayed only once. Copy it immediately! If you lose it,
+   you'll need to generate a new one.
+
+Step 4: Connect via SSH
+~~~~~~~~~~~~~~~~~~~~~~~
+
+Open a terminal and connect to your target server:
+
+.. code-block:: bash
+
+   ssh jdoe@server.example.com
+
+When prompted for a password, **paste the token** you just generated:
+
+.. code-block:: text
+
+   jdoe@server.example.com's password: <paste your token here>
+
+If the token is valid and you are authorized to access this server, you will
+be logged in.
+
+Step 5: Token Expiration
+~~~~~~~~~~~~~~~~~~~~~~~~
+
+Your token is temporary by design. Once it expires:
+
+- You cannot use it for new connections
+- Existing SSH sessions remain active (the token was only used for authentication)
+- Generate a new token from the portal when needed
+
+.. tip::
+   **Best practice**: Generate tokens with short validity (5-10 minutes).
+   This limits the risk if a token is accidentally exposed.
+
+SSH Key Authentication
+~~~~~~~~~~~~~~~~~~~~~
+
+If you have deployed your SSH public key on the target server, you can
+authenticate without generating a token. The server will still verify your
+authorization through LemonLDAP::NG.
+
+Step 1: Ensure Your SSH Key is Deployed
+^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
+
+Your SSH public key must be installed on the target server. This is typically
+done by:
+
+- Your system administrator (via centralized key management)
+- Yourself, if you have existing access to the server
+- An automated provisioning system
+
+Your public key is usually located at ``~/.ssh/id_rsa.pub``, ``~/.ssh/id_ed25519.pub``,
+or similar.
+
+Step 2: Connect to the Server
+^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
+
+Simply connect using SSH as you normally would:
+
+.. code-block:: bash
+
+   ssh jdoe@server.example.com
+
+SSH will automatically use your private key for authentication. You won't be
+prompted for a password.
+
+Step 3: Authorization Check (Transparent)
+^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
+
+Behind the scenes, even though SSH authenticated you with your key, the server's
+PAM module contacts LemonLDAP::NG to verify you are authorized:
+
+1. The PAM module sends your username and the server hostname to ``/pam/authorize``
+2. LemonLDAP::NG looks up your account in the identity provider
+3. Your groups and attributes are retrieved
+4. The authorization rule is evaluated
+5. Access is granted or denied
+
+This happens transparently - you don't see any of this, you're simply logged in
+(or rejected with "Permission denied").
+
+Step 4: Troubleshooting Access Denied
+^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
+
+If you receive "Permission denied" despite having a valid SSH key:
+
+- **Check your account**: Ensure you exist in the identity provider (LDAP, etc.)
+- **Check your groups**: You may not be in a group authorized for this server
+- **Contact your administrator**: They can check the authorization logs to see
+  why access was denied
+
+.. note::
+   With SSH key authentication, you don't need to visit the portal or generate
+   any token. However, your access is still controlled by LemonLDAP::NG policies,
+   ensuring centralized authorization management.
+
+Authorization Management
+------------------------
+
+This section is for administrators who need to configure access control rules
+for PAM-enabled servers.
+
+Understanding the Authorization Model
+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+
+PAM Access uses a **server group** based authorization system. Servers are
+organized into logical groups (e.g., ``production``, ``staging``, ``dev``),
+and each group has its own authorization rule.
+
+When a user attempts to access a server:
+
+1. The PAM module sends the user identity and the server's ``server_group``
+2. LemonLDAP::NG selects the rule for that group (or ``default`` if not found)
+3. The rule is evaluated against the user's session attributes
+4. Access is granted or denied
+
+This model allows you to:
+
+- Give developers access to dev servers only
+- Restrict production access to ops team
+- Allow specific users exceptions on certain server groups
+
+Setting Up Server Groups
+~~~~~~~~~~~~~~~~~~~~~~~~
+
+Go to ``General Parameters`` » ``Plugins`` » ``PAM Access`` » ``Server groups``
+and create entries for each server group:
+
+.. list-table::
+   :header-rows: 1
+
+   * - Server Group
+     - Rule
+     - Description
+   * - ``default``
+     - ``1``
+     - Fallback for uncategorized servers
+   * - ``production``
+     - ``$hGroup->{ops}``
+     - Only ops team
+   * - ``staging``
+     - ``$hGroup->{ops} or $hGroup->{dev}``
+     - Ops and developers
+   * - ``dev``
+     - ``$hGroup->{dev} or $uid eq 'contractor1'``
+     - Developers + specific contractor
+
+Basic Authorization Scenarios
+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+
+**Scenario 1: Simple setup - allow all authenticated users**
+
+Create a single ``default`` group with rule ``1``:
+
+.. code-block:: perl
+
+   default => 1
+
+**Scenario 2: Restrict all servers to a specific group**
+
+Create a ``default`` group that requires membership:
+
+.. code-block:: perl
+
+   $groups =~ /\bssh-users\b/
+
+**Scenario 3: Multiple allowed groups**
+
+Allow users who are in either ``developers`` or ``sysadmins`` groups:
+
+.. code-block:: perl
+
+   $groups =~ /\b(developers|sysadmins)\b/
+
+Host-Based Authorization
+~~~~~~~~~~~~~~~~~~~~~~~~
+
+The ``$_pamHost`` variable contains the target server's hostname, allowing
+you to implement per-server access control.
+
+**Scenario 4: Restrict access to specific servers**
+
+Allow access only to servers ``srv01`` and ``srv02``:
+
+.. code-block:: perl
+
+   $_pamHost =~ /^(srv01|srv02)\.example\.com$/
+
+**Scenario 5: Server groups with user groups**
+
+Create a matrix of access: developers can access dev servers, admins can
+access all servers:
+
+.. code-block:: perl
+
+   ($groups =~ /\badmins\b/) or
+   ($groups =~ /\bdevelopers\b/ and $_pamHost =~ /^dev-/)
+
+**Scenario 6: Production servers restricted to ops team**
+
+.. code-block:: perl
+
+   $_pamHost !~ /^prod-/ or $groups =~ /\bops-team\b/
+
+This allows:
+
+- Anyone to access non-production servers
+- Only ``ops-team`` members to access production servers (hostnames starting with ``prod-``)
+
+Department-Based Authorization
+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+
+Using LDAP attributes like ``department`` or custom attributes:
+
+**Scenario 7: Department-based server access**
+
+.. code-block:: perl
+
+   ($department eq 'IT' and $_pamHost =~ /^(srv|db)-/) or
+   ($department eq 'Finance' and $_pamHost =~ /^fin-/) or
+   ($department eq 'HR' and $_pamHost =~ /^hr-/)
+
+Service-Based Authorization
+~~~~~~~~~~~~~~~~~~~~~~~~~~~
+
+The ``$_pamService`` variable contains the PAM service name (default: ``ssh``).
+This allows different rules for different services.
+
+**Scenario 8: Different rules for SSH vs sudo**
+
+.. code-block:: perl
+
+   ($_pamService eq 'ssh' and $groups =~ /\bssh-users\b/) or
+   ($_pamService eq 'sudo' and $groups =~ /\bsudoers\b/)
+
+Complex Authorization Examples
+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+
+**Scenario 9: Time-based access (using macros)**
+
+First, define a macro in LemonLDAP::NG to compute business hours:
+
+.. code-block:: perl
+
+   # Macro: _businessHours
+   (localtime)[2] >= 8 and (localtime)[2] < 18
+
+Then use it in the PAM access rule:
+
+.. code-block:: perl
+
+   $groups =~ /\badmins\b/ or
+   ($groups =~ /\busers\b/ and $_businessHours)
+
+This allows:
+
+- Admins: 24/7 access
+- Regular users: access only during business hours (8:00-18:00)
+
+**Scenario 10: Combining multiple criteria**
+
+.. code-block:: perl
+
+   # Full example: tiered access control
+   (
+     # Tier 1: Full admins - access everything
+     $groups =~ /\bfull-admins\b/
+   ) or (
+     # Tier 2: Server admins - production and staging
+     $groups =~ /\bserver-admins\b/ and
+     $_pamHost =~ /^(prod|staging)-/
+   ) or (
+     # Tier 3: Developers - dev and staging only
+     $groups =~ /\bdevelopers\b/ and
+     $_pamHost =~ /^(dev|staging)-/
+   ) or (
+     # Tier 4: Contractors - dev only, SSH only (no sudo)
+     $groups =~ /\bcontractors\b/ and
+     $_pamHost =~ /^dev-/ and
+     $_pamService eq 'ssh'
+   )
+
+Organizing Servers into Groups
+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+
+With the ``pamAccessServerGroups`` feature, organizing servers is straightforward:
+
+1. **Define server groups** in LemonLDAP::NG Manager with their authorization rules
+2. **Configure each server** with its ``server_group`` in ``/etc/pam-llng/config``
+
+**Example deployment:**
+
+.. list-table::
+   :header-rows: 1
+
+   * - Server
+     - server_group
+     - Rule in LLNG
+   * - prod-web-01, prod-db-01
+     - ``production``
+     - ``$hGroup->{ops}``
+   * - staging-web-01
+     - ``staging``
+     - ``$hGroup->{ops} or $hGroup->{dev}``
+   * - dev-app-01
+     - ``dev``
+     - ``$hGroup->{dev}``
+   * - legacy-server
+     - (not set)
+     - Uses ``default`` rule
+
+This is simpler than hostname-based patterns because:
+
+- No complex regex needed in rules
+- Each server explicitly declares its group
+- Easy to move a server between groups (just change config)
+- Clear audit trail (server identifies itself)
+
+Testing Authorization Rules
+~~~~~~~~~~~~~~~~~~~~~~~~~~~
+
+Before deploying a new rule, test it using the ``/pam/authorize`` endpoint:
+
+.. code-block:: bash
+
+   # Test if user 'jdoe' can access 'prod-web-01'
+   curl -X POST \
+     -H "Authorization: Bearer $SERVER_TOKEN" \
+     -H "Content-Type: application/json" \
+     -d '{"user": "jdoe", "host": "prod-web-01.example.com", "service": "ssh"}' \
+     https://auth.example.com/pam/authorize
+
+The response will show:
+
+- ``authorized``: true/false
+- ``groups``: user's group memberships (useful for debugging)
+- ``reason``: explanation if access is denied
+
+Audit and Troubleshooting
+~~~~~~~~~~~~~~~~~~~~~~~~~
+
+LemonLDAP::NG logs all authorization decisions. Check your portal logs for
+entries containing ``PAM authorize`` to see:
+
+- Which user attempted access
+- Which server was the target
+- Whether access was granted or denied
+- The user's group memberships at the time
+
+Use Cases Summary
+-----------------
+
+Token-based SSH Authentication
+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+
+Best for:
+
+- Users without SSH keys
+- Temporary or one-time access
+- Environments where password-based SSH is required
+
+Flow:
+
+1. User authenticates to the portal
+2. User generates a temporary token
+3. User connects via SSH using the token as password
+4. PAM module validates the token via OIDC introspection
+
+SSH Key Authentication with SSO Authorization
+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+
+Best for:
+
+- Users with SSH keys already deployed
+- Environments requiring both SSH key security and centralized authorization
+- Compliance scenarios requiring SSO-based access control
+
+Flow:
+
+1. User connects via SSH using their SSH key (no password)
+2. SSH authenticates the user via public key
+3. PAM module calls ``/pam/authorize`` to check SSO authorization
+4. LemonLDAP::NG looks up user attributes and evaluates rules
+5. Access granted or denied based on SSO policy
+
+Security Considerations
+-----------------------
+
+- **Token lifetime**: Use short-lived tokens (5-10 minutes recommended)
+- **Server enrollment**: Each server has its own token for audit trail
+- **Token storage**: Server tokens should be stored with restricted permissions
+  (``chmod 600``)
+- **Scope separation**: Use ``pam:server`` scope for server tokens to
+  distinguish from user tokens
+- **Rule evaluation**: Authorization rules are evaluated server-side, ensuring
+  consistent policy enforcement
+
+See Also
+--------
+
+- :doc:`OpenID Connect Provider<idpopenidconnect>`
+- :doc:`Device Authorization Grant<oidcdeviceauthorization>`
+- :rfc:`8628` - OAuth 2.0 Device Authorization Grant
diff --git a/e2e-tests/env.conf b/e2e-tests/env.conf
index 4132016c6..5b11ac5b4 100644
--- a/e2e-tests/env.conf
+++ b/e2e-tests/env.conf
@@ -1,5 +1,5 @@
-Listen 127.0.0.1:__port__
-Listen ::1:__port__
+Listen 0.0.0.0:__port__
+Listen [::]:__port__
 FcgidInitialEnv LLNG_DEFAULTCONFFILE __pwd__/e2e-tests/conf/lemonldap-ng.ini
 SetEnv LLNG_DEFAULTCONFFILE __pwd__/e2e-tests/conf/lemonldap-ng.ini
 <perl>
diff --git a/e2e-tests/lmConf-1.json b/e2e-tests/lmConf-1.json
index 2bd7ffffe..4c443b55f 100644
--- a/e2e-tests/lmConf-1.json
+++ b/e2e-tests/lmConf-1.json
@@ -217,5 +217,57 @@
   "timeout": 72000,
   "userDB": "Same",
   "whatToTrace": "_whatToTrace",
-  "customToTrace": "mail"
+  "customToTrace": "mail",
+
+  "issuerDBOpenIDConnectActivation": 1,
+  "oidcServiceMetaDataAuthorizeURI": "authorize",
+  "oidcServiceMetaDataCheckSessionURI": "check_session",
+  "oidcServiceMetaDataJWKSURI": "jwks",
+  "oidcServiceMetaDataEndSessionURI": "logout",
+  "oidcServiceMetaDataRegistrationURI": "register",
+  "oidcServiceMetaDataTokenURI": "token",
+  "oidcServiceMetaDataUserInfoURI": "userinfo",
+  "oidcServiceMetaDataIntrospectionURI": "introspect",
+  "oidcServiceAllowHybridFlow": 1,
+  "oidcServiceAllowImplicitFlow": 1,
+  "oidcServiceAllowAuthorizationCodeFlow": 1,
+  "oidcServicePrivateKeySig": "-----BEGIN RSA PRIVATE KEY-----\nMIIEowIBAAKCAQEAs2jsmIoFuWzMkilJaA8//5/T30cnuzX9GImXUrFR2k9EKTMt\nGMHCdKlWOl3BV+BTAU9TLz7Jzd/iJ5GJ6B8TrH1PHFmHpy8/qE/S5OhinIpIi7eb\nABqnoVcwDdCa8ugzq8k8SWxhRNXfVIlwz4NH1caJ8lmiERFj7IvNKqEhzAk0pyDr\n8hubveTC39xREujKlsqutpPAFPJ3f2ybVsdykX5rx0h5SslG3jVWYhZ/SOb2aIzO\nr0RMjhQmsYRwbpt3anjlBZ98aOzg7GAkbO8093X5VVk9vaPRg0zxJQ0Do0YLyzkR\nisSAIFb0tdKuDnjRGK6y/N2j6At2HjkxntbtGQIDAQABAoIBADYq6LxJd977LWy3\n0HT9nboFPIf+SM2qSEc/S5Po+6ipJBA4ZlZCMf7dHa6znet1TDpqA9iQ4YcqIHMH\n6xZNQ7hhgSAzG9TrXBHqP+djDlrrGWotvjuy0IfS9ixFnnLWjrtAH9afRWLuG+a/\nNHNC1M6DiiTE0TzL/lpt/zzut3CNmWzH+t19X6UsxUg95AzooEeewEYkv25eumWD\nmfQZfCtSlIw1sp/QwxeJa/6LJw7KcPZ1wXUm1BN0b9eiKt9Cmni1MS7elgpZlgGt\nxtfGTZtNLQ7bgDiM8MHzUfPBhbceNSIx2BeCuOCs/7eaqgpyYHBbAbuBQex2H61l\nLcc3Tz0CgYEA4Kx/avpCPxnvsJ+nHVQm5d/WERuDxk4vH1DNuCYBvXTdVCGADf6a\nF5No1JcTH3nPTyPWazOyGdT9LcsEJicLyD8vCM6hBFstG4XjqcAuqG/9DRsElpHQ\nyi1zc5DNP7Vxmiz9wII0Mjy0abYKtxnXh9YK4a9g6wrcTpvShhIcIb8CgYEAzGzG\nlorVCfX9jXULIznnR/uuP5aSnTEsn0xJeqTlbW0RFWLdj8aIL1peirh1X89HroB9\nGeTNqEJXD+3CVL2cx+BRggMDUmEz4hR59meZCDGUyT5fex4LIsceb/ESUl2jo6Sw\nHXwWbN67rQ55N4oiOcOppsGxzOHkl5HdExKidycCgYEAr5Qev2tz+fw65LzfzHvH\nKj4S/KuT/5V6He731cFd+sEpdmX3vPgLVAFPG1Q1DZQT/rTzDDQKK0XX1cGiLG63\nNnaqOye/jbfzOF8Z277kt51NFMDYhRLPKDD82IOA4xjY/rPKWndmcxwdob8yAIWh\nefY76sMz6ntCT+xWSZA9i+ECgYBWMZM2TIlxLsBfEbfFfZewOUWKWEGvd9l5vV/K\nD5cRIYivfMUw5yPq2267jPUolayCvniBH4E7beVpuPVUZ7KgcEvNxtlytbt7muil\n5Z6X3tf+VodJ0Swe2NhTmNEB26uwxzLe68BE3VFCsbSYn2y48HAq+MawPZr18bHG\nZfgMxwKBgHHRg6HYqF5Pegzk1746uH2G+OoCovk5ylGGYzcH2ghWTK4agCHfBcDt\nEYqYAev/l82wi+OZ5O8U+qjFUpT1CVeUJdDs0o5u19v0UJjunU1cwh9jsxBZAWLy\nPAGd6SWf4S3uQCTw6dLeMna25YIlPh5qPA6I/pAahe8e3nSu2ckl\n-----END RSA PRIVATE KEY-----",
+  "oidcServicePublicKeySig": "-----BEGIN CERTIFICATE-----\nMIIC/zCCAeegAwIBAgIUYFySF9bmkPZK1u+wdkwTSS9bxnMwDQYJKoZIhvcNAQEL\nBQAwDzENMAsGA1UEAwwEVGVzdDAeFw0yMjExMjkxNDI2MTFaFw00MjAxMjgxNDI2\nMTFaMA8xDTALBgNVBAMMBFRlc3QwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEK\nAoIBAQCzaOyYigW5bMySKUloDz//n9PfRye7Nf0YiZdSsVHaT0QpMy0YwcJ0qVY6\nXcFX4FMBT1MvPsnN3+InkYnoHxOsfU8cWYenLz+oT9Lk6GKcikiLt5sAGqehVzAN\n0Jry6DOryTxJbGFE1d9UiXDPg0fVxonyWaIREWPsi80qoSHMCTSnIOvyG5u95MLf\n3FES6MqWyq62k8AU8nd/bJtWx3KRfmvHSHlKyUbeNVZiFn9I5vZojM6vREyOFCax\nhHBum3dqeOUFn3xo7ODsYCRs7zT3dflVWT29o9GDTPElDQOjRgvLORGKxIAgVvS1\n0q4OeNEYrrL83aPoC3YeOTGe1u0ZAgMBAAGjUzBRMB0GA1UdDgQWBBS/LX4E0Ipq\nh/4wcxNIXvoksj4vizAfBgNVHSMEGDAWgBS/LX4E0Ipqh/4wcxNIXvoksj4vizAP\nBgNVHRMBAf8EBTADAQH/MA0GCSqGSIb3DQEBCwUAA4IBAQAZk2m++tQ/FkZedpoA\nBlbRjvWjQ8u6qH5zaqS5oxnNX/JfJEFOsqL2n37g/0wuu6HhSYh2vD+zc4KfVMrj\nv6wzzmspJaZnACQLlEoB+ZKC1P+a8R95BK8iL1Dp1Iy0SC8CR6ZvQDEHNGWm8SAC\nK/cm2ee4wv4obg336SjXZ+Wid8lmdKDpJ7/XjiK2NQuvDLw6Jt7QpItKqwajEcJ/\nBOYQi7AAYtRBfi0v99nm3L2XF2ijTsIHDGhQqliFTXYwKO6ErCevEpDfDF28txqT\nR333fBH0ADco70lNPVTfOtpfdTjKvJ3N9SmU9V0BbhtegzMeung3QBmtMxApt8++\nLcJp\n-----END CERTIFICATE-----",
+
+  "oidcRPMetaDataExportedVars": {
+    "pam-access": {
+      "email": "mail",
+      "name": "cn",
+      "groups": "groups"
+    }
+  },
+  "oidcRPMetaDataOptions": {
+    "pam-access": {
+      "oidcRPMetaDataOptionsDisplayName": "PAM Access",
+      "oidcRPMetaDataOptionsClientID": "pam-access",
+      "oidcRPMetaDataOptionsClientSecret": "pamsecret",
+      "oidcRPMetaDataOptionsAccessTokenExpiration": 3600,
+      "oidcRPMetaDataOptionsRefreshToken": 1,
+      "oidcRPMetaDataOptionsAllowDeviceAuthorizationGrant": 1
+    }
+  },
+  "oidcRPMetaDataScopeRules": {
+    "pam-access": {
+      "pam": "1",
+      "pam:server": "1"
+    }
+  },
+  "oidcOPMetaDataOptions": {},
+  "oidcOPMetaDataJSON": {},
+  "oidcOPMetaDataJWKS": {},
+
+  "pamAccessActivation": 1,
+  "portalDisplayPamAccess": 1,
+  "pamAccessTokenDuration": 600,
+  "pamAccessMaxDuration": 3600,
+  "pamAccessRp": "pam-access",
+  "pamAccessServerGroups": {
+    "default": "$uid eq 'dwho' or $uid eq 'rtyler'",
+    "sudo": "$uid eq 'rtyler'"
+  }
 }
diff --git a/e2e-tests/pam/Dockerfile b/e2e-tests/pam/Dockerfile
new file mode 100644
index 000000000..c8a63a58b
--- /dev/null
+++ b/e2e-tests/pam/Dockerfile
@@ -0,0 +1,74 @@
+FROM debian:13-slim
+
+# Install runtime dependencies AND build dependencies
+RUN apt-get update && apt-get install -y \
+    openssh-server \
+    sudo \
+    libcurl4-gnutls-dev \
+    libjson-c-dev \
+    libssl-dev \
+    libpam0g-dev \
+    curl \
+    jq \
+    cmake \
+    gcc \
+    make \
+    locales \
+    && rm -rf /var/lib/apt/lists/*
+
+# Generate locales
+RUN sed -i '/fr_FR.UTF-8/s/^# //g' /etc/locale.gen && \
+    sed -i '/en_US.UTF-8/s/^# //g' /etc/locale.gen && \
+    locale-gen
+
+# Create directories
+RUN mkdir -p /var/run/sshd /var/cache/pam_llng /var/log/pam_llng /var/cache/nss_llng
+
+# Fix PAM loginuid for Docker (audit capabilities dropped)
+RUN sed -i 's/session\s*required\s*pam_loginuid.so/session optional pam_loginuid.so/' /etc/pam.d/sshd
+
+# Configure SSH
+RUN sed -i 's/#PasswordAuthentication yes/PasswordAuthentication yes/' /etc/ssh/sshd_config && \
+    sed -i 's/#UsePAM yes/UsePAM yes/' /etc/ssh/sshd_config
+
+# Users will be resolved via libnss_llng (no useradd needed!)
+# The NSS module queries LLNG /pam/userinfo to resolve unknown users.
+
+# Allow all users to use sudo without password (PAM account module handles authorization)
+RUN echo "ALL ALL=(ALL:ALL) NOPASSWD: ALL" >> /etc/sudoers
+
+# Copy PAM module source and build inside container
+COPY llng-pam-module/ /tmp/llng-pam-module/
+
+# Build PAM module and NSS module (both built from root CMakeLists.txt)
+RUN cd /tmp/llng-pam-module && \
+    mkdir -p build && cd build && \
+    cmake .. && \
+    make -j$(nproc) && \
+    cp pam_llng.so /usr/lib/x86_64-linux-gnu/security/ && \
+    cp nss/libnss_llng.so.2 /lib/x86_64-linux-gnu/ && \
+    ldconfig
+
+# Cleanup build files
+RUN rm -rf /tmp/llng-pam-module
+
+# Copy PAM configurations
+COPY pam.d.sshd /etc/pam.d/sshd
+COPY pam.d.sudo /etc/pam.d/sudo
+
+# Copy pam_llng configuration (must be owned by root with restricted permissions)
+COPY pam_llng.conf /etc/security/pam_llng.conf
+RUN chmod 600 /etc/security/pam_llng.conf
+
+# Copy NSS configuration
+COPY nss_llng.conf /etc/nss_llng.conf
+
+# Configure NSS to use libnss_llng for passwd lookups
+# Order: files first (root, system users), then llng for LLNG users
+RUN sed -i 's/^passwd:.*/passwd:         files llng/' /etc/nsswitch.conf
+
+# Generate SSH host keys
+RUN ssh-keygen -A
+
+EXPOSE 22
+CMD ["/usr/sbin/sshd", "-D", "-e"]
diff --git a/e2e-tests/pam/README.md b/e2e-tests/pam/README.md
new file mode 100644
index 000000000..a0877226d
--- /dev/null
+++ b/e2e-tests/pam/README.md
@@ -0,0 +1,179 @@
+# PAM E2E Tests for LemonLDAP::NG
+
+This directory contains end-to-end tests for the PAM authentication module with LemonLDAP::NG.
+
+## Prerequisites
+
+- Docker installed and running
+- PAM module source code at `~/dev/github/llng-pam-module`
+- LemonLDAP::NG built (run `make` in the parent directory)
+
+## Quick Start
+
+```bash
+# Start the test environment
+./run-pam-e2e.sh start
+
+# The script will:
+# 1. Build the PAM module
+# 2. Start the LLNG web server (if not running)
+# 3. Build and start a Docker container with SSH server
+# 4. Run the enrollment process (you need to approve it)
+```
+
+## Enrollment Process
+
+When the script runs, it will display a **user code** like `ABCD-EFGH`.
+
+1. Open your browser to http://auth.example.com:19876/
+2. Login as `dwho` (password: `dwho`)
+3. Go to http://auth.example.com:19876/device
+4. Enter the user code displayed by the script
+5. Click "Approve"
+
+The script will then complete the enrollment and display test instructions.
+
+## Test Users
+
+| User | Password | SSH Access | sudo Access |
+|------|----------|------------|-------------|
+| dwho | dwho | Yes | No |
+| rtyler | rtyler | Yes | Yes |
+| msmith | msmith | No | No |
+
+## Test Scenarios
+
+### Test 1: SSH with dwho (allowed)
+
+1. Login to portal as `dwho` (password: `dwho`)
+2. Generate a PAM token in the "PAM Access" tab
+3. Connect via SSH:
+   ```bash
+   ssh -p 2222 dwho@localhost
+   ```
+4. Use the generated token as password
+5. **Expected**: Connection successful
+
+### Test 2: SSH with rtyler (allowed)
+
+1. Login to portal as `rtyler` (password: `rtyler`)
+2. Generate a PAM token
+3. Connect via SSH:
+   ```bash
+   ssh -p 2222 rtyler@localhost
+   ```
+4. **Expected**: Connection successful
+
+### Test 3: SSH with msmith (denied)
+
+1. Login to portal as `msmith` (password: `msmith`)
+2. Generate a PAM token
+3. Connect via SSH:
+   ```bash
+   ssh -p 2222 msmith@localhost
+   ```
+4. **Expected**: Connection denied (msmith is not in the default server_group rule)
+
+### Test 4: sudo with rtyler (allowed)
+
+1. Connect as `rtyler` via SSH
+2. Run:
+   ```bash
+   sudo whoami
+   ```
+3. **Expected**: Returns "root" (rtyler is allowed in the sudo server_group)
+
+### Test 5: sudo with dwho (denied)
+
+1. Connect as `dwho` via SSH
+2. Run:
+   ```bash
+   sudo whoami
+   ```
+3. **Expected**: Access denied (dwho is not allowed in the sudo server_group)
+
+### Test 6: One-time token
+
+1. Generate a new token
+2. Connect successfully once
+3. Try to connect again with the same token
+4. **Expected**: Second connection fails (token is consumed after first use)
+
+## Commands
+
+```bash
+# Start the test environment
+./run-pam-e2e.sh start
+
+# Stop and remove containers
+./run-pam-e2e.sh stop
+
+# Re-run enrollment (if needed)
+./run-pam-e2e.sh enroll
+
+# Show container status
+./run-pam-e2e.sh status
+
+# View container logs
+./run-pam-e2e.sh logs
+```
+
+## Configuration
+
+### Server Groups
+
+The PAM server groups are configured in `e2e-tests/lmConf-1.json`:
+
+```json
+"pamAccessServerGroups": {
+    "default": "$uid eq 'dwho' or $uid eq 'rtyler'",
+    "sudo": "$uid eq 'rtyler'"
+}
+```
+
+### PAM Configuration
+
+The SSH server uses `pam_llng.so` with:
+- `server_group=default` for `/etc/pam.d/sshd`
+- `server_group=sudo` for `/etc/pam.d/sudo`
+
+## Troubleshooting
+
+### Cannot connect to LLNG server
+
+Make sure the server is running:
+```bash
+cd ../..
+make start_web_server
+```
+
+Verify it's accessible:
+```bash
+curl http://auth.example.com:19876/
+```
+
+### Enrollment fails
+
+Check that the LLNG server is properly configured with OIDC and PAM Access plugins.
+The configuration is in `e2e-tests/lmConf-1.json`.
+
+### SSH connection refused
+
+Check if the container is running:
+```bash
+docker ps | grep pam-ssh-test
+```
+
+Check container logs:
+```bash
+./run-pam-e2e.sh logs
+```
+
+### Token not working
+
+1. Make sure the token is fresh (not expired)
+2. Remember that tokens are one-time use only
+3. Check the PAM audit log in the container:
+   ```bash
+   docker exec pam-ssh-test cat /var/log/pam_llng/audit.json
+   ```
diff --git a/e2e-tests/pam/llng-set-groups.sh b/e2e-tests/pam/llng-set-groups.sh
new file mode 100644
index 000000000..79467897d
--- /dev/null
+++ b/e2e-tests/pam/llng-set-groups.sh
@@ -0,0 +1,31 @@
+#!/bin/bash
+# Script called by pam_exec during session setup
+# Checks if user is authorized for sudo group in LLNG and adds supplementary group
+
+# Only run for session open
+[ "$PAM_TYPE" = "open_session" ] || exit 0
+
+USER="$PAM_USER"
+SERVER_TOKEN=$(cat /etc/security/pam_llng.token 2>/dev/null)
+PORTAL_URL=$(grep -E '^portal_url\s*=' /etc/security/pam_llng.conf | sed 's/.*=\s*//')
+
+[ -z "$SERVER_TOKEN" ] && exit 0
+[ -z "$PORTAL_URL" ] && exit 0
+[ -z "$USER" ] && exit 0
+
+# Check if user is authorized for sudo server_group
+RESPONSE=$(curl -s -X POST "${PORTAL_URL}/pam/authorize" \
+    -H "Authorization: Bearer $SERVER_TOKEN" \
+    -H "Content-Type: application/json" \
+    -H "Accept: application/json" \
+    -d "{\"user\":\"$USER\",\"server_group\":\"sudo\"}" 2>/dev/null)
+
+AUTHORIZED=$(echo "$RESPONSE" | jq -r '.authorized' 2>/dev/null)
+
+if [ "$AUTHORIZED" = "true" ]; then
+    # Add user to sudo group for this session only using newgrp approach
+    # We set an environment variable that can be used by the shell
+    echo "LLNG_SUDO_AUTHORIZED=1"
+fi
+
+exit 0
diff --git a/e2e-tests/pam/nss_llng.conf b/e2e-tests/pam/nss_llng.conf
new file mode 100644
index 000000000..36b004097
--- /dev/null
+++ b/e2e-tests/pam/nss_llng.conf
@@ -0,0 +1,19 @@
+# NSS LLNG configuration for e2e tests
+# This file is used by libnss_llng.so to resolve users from LLNG
+
+portal_url = http://auth.example.com:19876
+server_token_file = /etc/security/pam_llng.token
+
+# HTTP settings
+timeout = 5
+verify_ssl = false
+
+# Cache settings
+cache_ttl = 60
+
+# User defaults
+default_shell = /bin/bash
+default_home_base = /home
+default_gid = 100
+min_uid = 10000
+max_uid = 60000
diff --git a/e2e-tests/pam/pam.d.sshd b/e2e-tests/pam/pam.d.sshd
new file mode 100644
index 000000000..9032f35f9
--- /dev/null
+++ b/e2e-tests/pam/pam.d.sshd
@@ -0,0 +1,14 @@
+# PAM configuration for SSH with LLNG (server_group=default)
+# Users allowed: dwho, rtyler
+# Users denied: msmith
+
+auth       sufficient   pam_llng.so server_group=default
+auth       required     pam_deny.so
+
+account    required     pam_llng.so server_group=default
+account    required     pam_nologin.so
+
+session    required     pam_llng.so server_group=default
+session    optional     pam_loginuid.so
+session    required     pam_limits.so
+session    required     pam_unix.so
diff --git a/e2e-tests/pam/pam.d.sudo b/e2e-tests/pam/pam.d.sudo
new file mode 100644
index 000000000..2788b25c8
--- /dev/null
+++ b/e2e-tests/pam/pam.d.sudo
@@ -0,0 +1,10 @@
+# PAM configuration for sudo with LLNG (server_group=sudo)
+# Users allowed: rtyler only
+# Users denied: dwho, msmith
+#
+# Note: Authentication is skipped (pam_permit) because the user already
+# authenticated via SSH. Authorization is checked via pam_llng account module.
+
+auth       sufficient   pam_permit.so
+
+account    required     pam_llng.so server_group=sudo
diff --git a/e2e-tests/pam/pam_llng.conf b/e2e-tests/pam/pam_llng.conf
new file mode 100644
index 000000000..16f619d5b
--- /dev/null
+++ b/e2e-tests/pam/pam_llng.conf
@@ -0,0 +1,27 @@
+# PAM LLNG configuration for e2e tests
+# This file is used by pam_llng.so module
+
+portal_url = http://auth.example.com:19876
+client_id = pam-access
+client_secret = pamsecret
+server_token_file = /etc/security/pam_llng.token
+
+# Default server_group (overridden by PAM module argument)
+server_group = default
+
+# HTTP settings
+timeout = 10
+verify_ssl = false
+
+# Cache disabled for testing (to see real-time behavior)
+cache_enabled = false
+
+# Debug logging
+log_level = debug
+
+# Audit logging
+audit_enabled = true
+audit_log_file = /var/log/pam_llng/audit.json
+
+# Auto-create Unix accounts on first login
+create_user = true
diff --git a/e2e-tests/pam/pam_llng.so b/e2e-tests/pam/pam_llng.so
new file mode 100755
index 000000000..bd98e6497
Binary files /dev/null and b/e2e-tests/pam/pam_llng.so differ
diff --git a/e2e-tests/pam/run-pam-e2e.sh b/e2e-tests/pam/run-pam-e2e.sh
new file mode 100755
index 000000000..c90ceec90
--- /dev/null
+++ b/e2e-tests/pam/run-pam-e2e.sh
@@ -0,0 +1,297 @@
+#!/bin/bash
+# PAM E2E Test Setup Script
+# This script sets up the environment for testing PAM authentication with LemonLDAP::NG
+
+set -e
+
+SCRIPT_DIR="$(cd "$(dirname "$0")" && pwd)"
+LLNG_DIR="$(cd "$SCRIPT_DIR/../.." && pwd)"
+PAM_MODULE_DIR="$HOME/dev/github/llng-pam-module"
+CONTAINER_NAME="pam-ssh-test"
+SSH_PORT=2222
+
+# Colors for output
+RED='\033[0;31m'
+GREEN='\033[0;32m'
+YELLOW='\033[1;33m'
+NC='\033[0m' # No Color
+
+log_info() { echo -e "${GREEN}[INFO]${NC} $1"; }
+log_warn() { echo -e "${YELLOW}[WARN]${NC} $1"; }
+log_error() { echo -e "${RED}[ERROR]${NC} $1"; }
+
+cleanup() {
+    log_info "Cleaning up..."
+    docker rm -f "$CONTAINER_NAME" 2>/dev/null || true
+    log_info "Cleanup complete"
+}
+
+show_help() {
+    cat << EOF
+Usage: $0 [COMMAND]
+
+Commands:
+    start       Start the test environment (default)
+    stop        Stop and remove containers
+    enroll      Run enrollment for the container
+    status      Show status of containers
+    logs        Show container logs
+    help        Show this help
+
+Environment:
+    PAM_MODULE_DIR  Path to llng-pam-module (default: ~/dev/github/llng-pam-module)
+EOF
+}
+
+check_prerequisites() {
+    log_info "Checking prerequisites..."
+
+    # Check Docker
+    if ! command -v docker &> /dev/null; then
+        log_error "Docker is not installed"
+        exit 1
+    fi
+
+    # Check PAM module source
+    if [ ! -d "$PAM_MODULE_DIR" ]; then
+        log_error "PAM module directory not found: $PAM_MODULE_DIR"
+        exit 1
+    fi
+
+    # Get host IP for container to reach host
+    HOST_IP=$(hostname -I | awk '{print $1}')
+    if [ -z "$HOST_IP" ]; then
+        log_error "Could not determine host IP"
+        exit 1
+    fi
+    log_info "Host IP: $HOST_IP"
+}
+
+prepare_pam_module_source() {
+    log_info "Preparing PAM module source for Docker build..."
+
+    # Copy PAM module source to build context
+    rm -rf "$SCRIPT_DIR/llng-pam-module"
+    cp -r "$PAM_MODULE_DIR" "$SCRIPT_DIR/llng-pam-module"
+
+    # Remove build directory if exists (to keep image smaller)
+    rm -rf "$SCRIPT_DIR/llng-pam-module/build"
+
+    log_info "PAM module source prepared"
+}
+
+check_llng_server() {
+    log_info "Checking LLNG server..."
+
+    if curl -s http://auth.example.com:19876/ > /dev/null 2>&1; then
+        log_info "LLNG server is running"
+        return 0
+    else
+        log_warn "LLNG server is not running"
+        log_info "Starting LLNG server with 'make start_web_server'..."
+        cd "$LLNG_DIR"
+        make start_web_server &
+
+        # Wait for server to start
+        for i in {1..30}; do
+            if curl -s http://auth.example.com:19876/ > /dev/null 2>&1; then
+                log_info "LLNG server started"
+                return 0
+            fi
+            sleep 1
+        done
+
+        log_error "LLNG server failed to start"
+        exit 1
+    fi
+}
+
+build_docker_image() {
+    log_info "Building Docker image..."
+    cd "$SCRIPT_DIR"
+    docker build -t pam-ssh-test . >/dev/null
+    log_info "Docker image built"
+}
+
+start_container() {
+    log_info "Starting SSH container..."
+
+    # Remove existing container if any
+    docker rm -f "$CONTAINER_NAME" 2>/dev/null || true
+
+    HOST_IP=$(hostname -I | awk '{print $1}')
+
+    docker run --rm -d \
+        --name "$CONTAINER_NAME" \
+        --add-host=auth.example.com:$HOST_IP \
+        -p ${SSH_PORT}:22 \
+        pam-ssh-test
+
+    # Wait for SSH to be ready
+    sleep 2
+    log_info "Container started on port $SSH_PORT"
+}
+
+run_enrollment() {
+    log_info "Running server enrollment..."
+    log_info ""
+    log_info "The enrollment process will display a user code."
+    log_info "You need to:"
+    log_info "  1. Go to http://auth.example.com:19876/"
+    log_info "  2. Login as 'dwho' (password: dwho)"
+    log_info "  3. Go to http://auth.example.com:19876/device"
+    log_info "  4. Enter the user code displayed below"
+    log_info "  5. Click 'Approve'"
+    log_info ""
+
+    # Copy enrollment script to container and run it
+    docker exec "$CONTAINER_NAME" /bin/bash -c '
+        # Initiate device authorization
+        RESPONSE=$(curl -s -X POST http://auth.example.com:19876/oauth2/device \
+            -d "client_id=pam-access" \
+            -d "scope=pam:server")
+
+        DEVICE_CODE=$(echo "$RESPONSE" | jq -r .device_code)
+        USER_CODE=$(echo "$RESPONSE" | jq -r .user_code)
+        INTERVAL=$(echo "$RESPONSE" | jq -r .interval)
+        EXPIRES_IN=$(echo "$RESPONSE" | jq -r .expires_in)
+
+        if [ -z "$DEVICE_CODE" ] || [ "$DEVICE_CODE" = "null" ]; then
+            echo "ERROR: Failed to get device code"
+            echo "Response: $RESPONSE"
+            exit 1
+        fi
+
+        echo ""
+        echo "=========================================="
+        echo "  USER CODE: $USER_CODE"
+        echo "=========================================="
+        echo ""
+        echo "Go to: http://auth.example.com:19876/device"
+        echo "Enter the code above and approve."
+        echo ""
+        echo "Waiting for approval (timeout: ${EXPIRES_IN}s)..."
+        echo ""
+
+        # Poll for token
+        while true; do
+            sleep ${INTERVAL:-5}
+
+            TOKEN_RESPONSE=$(curl -s -X POST http://auth.example.com:19876/oauth2/token \
+                -d "grant_type=urn:ietf:params:oauth:grant-type:device_code" \
+                -d "device_code=$DEVICE_CODE" \
+                -d "client_id=pam-access" \
+                -d "client_secret=pamsecret")
+
+            ACCESS_TOKEN=$(echo "$TOKEN_RESPONSE" | jq -r .access_token)
+            ERROR=$(echo "$TOKEN_RESPONSE" | jq -r .error)
+
+            if [ "$ACCESS_TOKEN" != "null" ] && [ -n "$ACCESS_TOKEN" ]; then
+                echo "Enrollment successful!"
+
+                # Save token (raw token only, not JSON)
+                echo "$ACCESS_TOKEN" > /etc/security/pam_llng.token
+                chmod 600 /etc/security/pam_llng.token
+
+                echo "Token saved to /etc/security/pam_llng.token"
+                break
+            elif [ "$ERROR" = "authorization_pending" ]; then
+                echo -n "."
+            elif [ "$ERROR" = "slow_down" ]; then
+                INTERVAL=$((INTERVAL + 5))
+            elif [ "$ERROR" = "expired_token" ]; then
+                echo "ERROR: Device code expired"
+                exit 1
+            elif [ "$ERROR" = "access_denied" ]; then
+                echo "ERROR: Access denied"
+                exit 1
+            else
+                echo "ERROR: $ERROR"
+                echo "Response: $TOKEN_RESPONSE"
+                exit 1
+            fi
+        done
+    '
+}
+
+show_status() {
+    echo ""
+    echo "=== Container Status ==="
+    docker ps -a --filter "name=$CONTAINER_NAME" --format "table {{.Names}}\t{{.Status}}\t{{.Ports}}"
+    echo ""
+
+    if docker ps -q --filter "name=$CONTAINER_NAME" | grep -q .; then
+        echo "=== Token Status ==="
+        docker exec "$CONTAINER_NAME" cat /etc/security/pam_llng.token 2>/dev/null || echo "No token file"
+        echo ""
+    fi
+}
+
+show_logs() {
+    docker logs -f "$CONTAINER_NAME"
+}
+
+show_test_instructions() {
+    echo ""
+    echo "=========================================="
+    echo "  PAM E2E Test Environment Ready"
+    echo "=========================================="
+    echo ""
+    echo "LLNG Portal: http://auth.example.com:19876/"
+    echo "SSH Server:  localhost:$SSH_PORT"
+    echo ""
+    echo "Test accounts:"
+    echo "  - dwho/dwho   : SSH allowed, sudo denied"
+    echo "  - rtyler/rtyler: SSH allowed, sudo allowed"
+    echo "  - msmith/msmith: SSH denied, sudo denied"
+    echo ""
+    echo "Test commands:"
+    echo ""
+    echo "  1. Login to portal and generate a PAM token"
+    echo "  2. Test SSH (should work for dwho/rtyler):"
+    echo "     ssh -p $SSH_PORT dwho@localhost"
+    echo ""
+    echo "  3. Test sudo (should work only for rtyler):"
+    echo "     ssh -p $SSH_PORT rtyler@localhost"
+    echo "     Then: sudo whoami"
+    echo ""
+    echo "  4. Test denied access (msmith):"
+    echo "     ssh -p $SSH_PORT msmith@localhost"
+    echo ""
+    echo "To view logs:    $0 logs"
+    echo "To stop:         $0 stop"
+    echo ""
+}
+
+# Main
+case "${1:-start}" in
+    start)
+        check_prerequisites
+        prepare_pam_module_source
+        check_llng_server
+        build_docker_image
+        start_container
+        run_enrollment
+        show_test_instructions
+        ;;
+    stop)
+        cleanup
+        ;;
+    enroll)
+        run_enrollment
+        ;;
+    status)
+        show_status
+        ;;
+    logs)
+        show_logs
+        ;;
+    help|--help|-h)
+        show_help
+        ;;
+    *)
+        log_error "Unknown command: $1"
+        show_help
+        exit 1
+        ;;
+esac
diff --git a/lemonldap-ng-manager/lib/Lemonldap/NG/Manager/Build/Attributes.pm b/lemonldap-ng-manager/lib/Lemonldap/NG/Manager/Build/Attributes.pm
index e2e72e2b4..35578c468 100644
--- a/lemonldap-ng-manager/lib/Lemonldap/NG/Manager/Build/Attributes.pm
+++ b/lemonldap-ng-manager/lib/Lemonldap/NG/Manager/Build/Attributes.pm
@@ -1551,6 +1551,81 @@ sub attributes {
             documentation => 'OIDC personnal offline token removal',
         },
 
+        # PAM Access
+        pamAccessActivation => {
+            type          => 'bool',
+            default       => 0,
+            documentation => 'PAM access token generation activation',
+        },
+        pamAccessTokenDuration => {
+            type          => 'int',
+            default       => 600,
+            documentation => 'Default PAM access token validity (seconds)',
+        },
+        pamAccessMaxDuration => {
+            type          => 'int',
+            default       => 3600,
+            documentation => 'Maximum PAM access token validity (seconds)',
+        },
+        pamAccessServerGroups => {
+            type          => 'keyTextContainer',
+            keyTest       => qr/^[\w\-]+$/,
+            keyMsgFail    => '__badPamServerGroupName__',
+            test          => sub { return perlExpr(@_) },
+            msgFail       => '__badExpression__',
+            default       => { default => 1 },
+            documentation => 'Authorization rules per PAM server group (legacy, use SSH/Sudo rules)',
+        },
+        pamAccessSshRules => {
+            type          => 'keyTextContainer',
+            keyTest       => qr/^[\w\-]+$/,
+            keyMsgFail    => '__badPamServerGroupName__',
+            test          => sub { return perlExpr(@_) },
+            msgFail       => '__badExpression__',
+            default       => {},
+            documentation => 'SSH authorization rules per server group',
+        },
+        pamAccessSudoRules => {
+            type          => 'keyTextContainer',
+            keyTest       => qr/^[\w\-]+$/,
+            keyMsgFail    => '__badPamServerGroupName__',
+            test          => sub { return perlExpr(@_) },
+            msgFail       => '__badExpression__',
+            default       => {},
+            documentation => 'Sudo authorization rules per server group',
+        },
+        pamAccessRp => {
+            type          => 'text',
+            default       => 'pam-access',
+            documentation => 'OIDC RP name for PAM tokens',
+        },
+        pamAccessHeartbeatInterval => {
+            type          => 'int',
+            default       => 300,
+            documentation => 'Expected heartbeat interval from PAM servers (seconds)',
+        },
+        pamAccessInactiveThreshold => {
+            type          => 'int',
+            default       => 900,
+            documentation =>
+              'Time after which a PAM server is considered inactive (seconds)',
+        },
+        pamAccessHeartbeatRequired => {
+            type          => 'bool',
+            default       => 0,
+            documentation =>
+              'Require recent heartbeat for /pam/authorize requests',
+        },
+        pamAccessExportedVars => {
+            type          => 'keyTextContainer',
+            keyTest       => qr/^[a-zA-Z][a-zA-Z0-9_-]*$/,
+            keyMsgFail    => '__badVariableName__',
+            test          => qr/^[a-zA-Z][a-zA-Z0-9_:\-]*$/,
+            msgFail       => '__badValue__',
+            default       => {},
+            documentation => 'Exported variables for PAM user provisioning',
+        },
+
         # History
         failedLoginNumber => {
             default       => 5,
@@ -1610,6 +1685,11 @@ sub attributes {
             'default' => '$_auth eq \'OIDC\'',
             'type'    => 'boolOrExpr'
         },
+        portalDisplayPamAccess => {
+            type          => 'boolOrExpr',
+            default       => 0,
+            documentation => 'Display PAM access token tab in portal',
+        },
         portalDisplayOidcConsents => {
             type          => 'boolOrExpr',
             default       => '$_oidcConsents && $_oidcConsents =~ /\w+/',
@@ -5150,6 +5230,24 @@ m{^(?:ldapi://[^/]*/?|\w[\w\-\.]*(?::\d{1,5})?|ldap(?:s|\+tls)?://\w[\w\-\.]*(?:
             default       => 2592000,
             documentation => 'OpenID Connect global offline session TTL',
         },
+        oidcServiceDeviceAuthorizationExpiration => {
+            type          => 'int',
+            default       => 600,
+            documentation =>
+              'OpenID Connect Device Authorization code TTL (RFC 8628)',
+        },
+        oidcServiceDeviceAuthorizationPollingInterval => {
+            type          => 'int',
+            default       => 5,
+            documentation =>
+              'OpenID Connect Device Authorization polling interval (RFC 8628)',
+        },
+        oidcServiceDeviceAuthorizationUserCodeLength => {
+            type          => 'int',
+            default       => 8,
+            documentation =>
+              'OpenID Connect Device Authorization user code length (RFC 8628)',
+        },
         oidcStorage => {
             type          => 'PerlModule',
             documentation => 'Apache::Session module to store OIDC user data',
@@ -5432,6 +5530,12 @@ m{^(?:ldapi://[^/]*/?|\w[\w\-\.]*(?::\d{1,5})?|ldap(?:s|\+tls)?://\w[\w\-\.]*(?:
             default       => 0,
             documentation => 'Allow OAuth2 Client Credentials Grant',
         },
+        oidcRPMetaDataOptionsAllowDeviceAuthorizationGrant => {
+            type          => 'bool',
+            default       => 0,
+            documentation =>
+              'Allow OAuth2 Device Authorization Grant (RFC 8628)',
+        },
         oidcRPMetaDataOptionsRefreshToken => {
             type          => 'bool',
             default       => 0,
@@ -5575,6 +5679,52 @@ m{^(?:ldapi://[^/]*/?|\w[\w\-\.]*(?::\d{1,5})?|ldap(?:s|\+tls)?://\w[\w\-\.]*(?:
 'Shall OIDC/SAML/CAS protected apps access be recorded to session?'
         },
 
+        # SSH CA
+        sshCaActivation => {
+            type          => 'bool',
+            default       => 0,
+            documentation => 'SSH CA activation',
+        },
+        sshCaKeyType => {
+            type          => 'select',
+            select        => [
+                { k => 'ed25519', v => 'Ed25519' },
+                { k => 'ecdsa',   v => 'ECDSA' },
+                { k => 'rsa',     v => 'RSA' },
+            ],
+            default       => 'ed25519',
+            documentation => 'SSH CA key type',
+        },
+        sshCaKeyRef => {
+            type          => 'text',
+            documentation => 'SSH CA key reference (key ID from LLNG keys)',
+        },
+        sshCaCertDefaultValidity => {
+            type          => 'int',
+            default       => 30,
+            documentation => 'SSH certificate default validity (minutes)',
+        },
+        sshCaCertMaxValidity => {
+            type          => 'int',
+            default       => 60,
+            documentation => 'SSH certificate max validity (minutes)',
+        },
+        sshCaPrincipalSources => {
+            type          => 'text',
+            default       => '$uid',
+            documentation => 'SSH certificate principal sources (Perl expression)',
+        },
+        sshCaKrlPath => {
+            type          => 'text',
+            default       => '/var/lib/lemonldap-ng/ssh/revoked_keys',
+            documentation => 'Path to SSH Key Revocation List file',
+        },
+        sshCaSerialPath => {
+            type          => 'text',
+            default       => '/var/lib/lemonldap-ng/ssh/serial',
+            documentation => 'Path to SSH certificate serial number file',
+        },
+
         # Fake attribute: used by manager REST API to agglomerate all other
         # nodes
         keyNodes => {
diff --git a/lemonldap-ng-manager/lib/Lemonldap/NG/Manager/Build/CTrees.pm b/lemonldap-ng-manager/lib/Lemonldap/NG/Manager/Build/CTrees.pm
index 4b11f02b2..330804d65 100644
--- a/lemonldap-ng-manager/lib/Lemonldap/NG/Manager/Build/CTrees.pm
+++ b/lemonldap-ng-manager/lib/Lemonldap/NG/Manager/Build/CTrees.pm
@@ -274,6 +274,7 @@ sub cTrees {
                             'oidcRPMetaDataOptionsAllowNativeSso',
                             'oidcRPMetaDataOptionsAllowPasswordGrant',
                             'oidcRPMetaDataOptionsAllowClientCredentialsGrant',
+                            'oidcRPMetaDataOptionsAllowDeviceAuthorizationGrant',
                             'oidcRPMetaDataOptionsRequestUris',
                             'oidcRPMetaDataOptionsAuthnLevel',
                             'oidcRPMetaDataOptionsRule',
diff --git a/lemonldap-ng-manager/lib/Lemonldap/NG/Manager/Build/Tree.pm b/lemonldap-ng-manager/lib/Lemonldap/NG/Manager/Build/Tree.pm
index 933ff188a..97ec4e838 100644
--- a/lemonldap-ng-manager/lib/Lemonldap/NG/Manager/Build/Tree.pm
+++ b/lemonldap-ng-manager/lib/Lemonldap/NG/Manager/Build/Tree.pm
@@ -40,6 +40,7 @@ sub tree {
                                         'portalDisplayChangePassword',
                                         'portalDisplayOidcConsents',
                                         'portalDisplayOfflineTokens',
+                                        'portalDisplayPamAccess',
                                         'portalDisplayLogout',
                                         'portalDisplayOrder'
                                     ]
@@ -977,6 +978,45 @@ sub tree {
                             nodes => ['adminLogoutServerSecret']
                         },
                         'oidcOfflineTokens',
+                        {
+                            title => 'pamAccess',
+                            help  => 'pamaccess.html',
+                            form  => 'simpleInputContainer',
+                            nodes => [
+                                'pamAccessActivation',
+                                'pamAccessTokenDuration',
+                                'pamAccessMaxDuration',
+                                {
+                                    title => 'pamAccessAuthzRules',
+                                    form  => 'simpleInputContainer',
+                                    nodes => [
+                                        'pamAccessServerGroups',
+                                        'pamAccessSshRules',
+                                        'pamAccessSudoRules',
+                                    ]
+                                },
+                                'pamAccessRp',
+                                'pamAccessHeartbeatInterval',
+                                'pamAccessInactiveThreshold',
+                                'pamAccessHeartbeatRequired',
+                                'pamAccessExportedVars',
+                            ]
+                        },
+                        {
+                            title => 'sshCa',
+                            help  => 'sshca.html',
+                            form  => 'simpleInputContainer',
+                            nodes => [
+                                'sshCaActivation',
+                                'sshCaKeyType',
+                                'sshCaKeyRef',
+                                'sshCaCertDefaultValidity',
+                                'sshCaCertMaxValidity',
+                                'sshCaPrincipalSources',
+                                'sshCaKrlPath',
+                                'sshCaSerialPath',
+                            ]
+                        },
                     ]
                 },
                 {
@@ -1653,6 +1693,16 @@ sub tree {
                         'oidcServiceMetadataTtl',
                     ]
                 },
+                {
+                    title => 'oidcServiceMetaDataDeviceAuthorization',
+                    help  => 'openidconnectservice.html#device-authorization',
+                    form  => 'simpleInputContainer',
+                    nodes => [
+                        'oidcServiceDeviceAuthorizationExpiration',
+                        'oidcServiceDeviceAuthorizationPollingInterval',
+                        'oidcServiceDeviceAuthorizationUserCodeLength',
+                    ]
+                },
                 {
                     title => "oidcServiceMetaDataSessions",
                     help  => 'openidconnectservice.html#sessions',
diff --git a/lemonldap-ng-manager/site/htdocs/static/js/conftree.js b/lemonldap-ng-manager/site/htdocs/static/js/conftree.js
index 261306d85..7d4882d4f 100644
--- a/lemonldap-ng-manager/site/htdocs/static/js/conftree.js
+++ b/lemonldap-ng-manager/site/htdocs/static/js/conftree.js
@@ -881,6 +881,13 @@ function templates(tpl,key) {
                   "title" : "oidcRPMetaDataOptionsAllowClientCredentialsGrant",
                   "type" : "bool"
                },
+               {
+                  "default" : 0,
+                  "get" : tpl+"s/"+key+"/"+"oidcRPMetaDataOptionsAllowDeviceAuthorizationGrant",
+                  "id" : tpl+"s/"+key+"/"+"oidcRPMetaDataOptionsAllowDeviceAuthorizationGrant",
+                  "title" : "oidcRPMetaDataOptionsAllowDeviceAuthorizationGrant",
+                  "type" : "bool"
+               },
                {
                   "get" : tpl+"s/"+key+"/"+"oidcRPMetaDataOptionsRequestUris",
                   "id" : tpl+"s/"+key+"/"+"oidcRPMetaDataOptionsRequestUris",
diff --git a/lemonldap-ng-manager/site/htdocs/static/languages/ar.json b/lemonldap-ng-manager/site/htdocs/static/languages/ar.json
index 5c3a1fb5d..9cd88ae8e 100644
--- a/lemonldap-ng-manager/site/htdocs/static/languages/ar.json
+++ b/lemonldap-ng-manager/site/htdocs/static/languages/ar.json
@@ -778,6 +778,7 @@
 "oidcRPMetaDataOptionsAdditionalAudiences":"Additional audiences",
 "oidcRPMetaDataOptionsAdvanced":"المتقدمة",
 "oidcRPMetaDataOptionsAllowClientCredentialsGrant":"Allow OAuth2.0 Client Credentials Grant",
+"oidcRPMetaDataOptionsAllowDeviceAuthorizationGrant":"Allow Device Authorization Grant",
 "oidcRPMetaDataOptionsAllowNativeSso":"Allow Native SSO for Mobile App",
 "oidcRPMetaDataOptionsAllowOffline":"Allow offline access",
 "oidcRPMetaDataOptionsAllowPasswordGrant":"Allow OAuth2.0 Password Grant",
@@ -841,6 +842,9 @@
 "oidcServiceAllowOffline":"Allow offline access",
 "oidcServiceAllowOnlyDeclaredScopes":"Only allow declared scopes",
 "oidcServiceAuthorizationCodeExpiration":"Authorization Codes",
+"oidcServiceDeviceAuthorizationExpiration":"Device code expiration",
+"oidcServiceDeviceAuthorizationPollingInterval":"Polling interval",
+"oidcServiceDeviceAuthorizationUserCodeLength":"User code length",
 "oidcServiceDynamicRegistration":"Dynamic registration",
 "oidcServiceDynamicRegistrationExportedVars":"Exported vars",
 "oidcServiceDynamicRegistrationExtraClaims":"ادعاءات إضافي",
@@ -861,6 +865,7 @@
 "oidcServiceMetaDataAuthorizeURI":"ترخيص",
 "oidcServiceMetaDataBackChannelURI":"URI قناة الخلفية",
 "oidcServiceMetaDataCheckSessionURI":"تحقق من الجلسة",
+"oidcServiceMetaDataDeviceAuthorization":"Device Authorization (RFC 8628)",
 "oidcServiceMetaDataDisallowNoneAlg":"Disallow \"none\" algorithm for signature",
 "oidcServiceMetaDataEncKeys":"Encryption keys",
 "oidcServiceMetaDataEndPoints":"Endpoints",
@@ -931,6 +936,20 @@
 "openIdSreg_timezone":"المنطقة الزمنية",
 "openidParams":"معاييرأوبين أيدي",
 "overPrm":"المعلمات الزائد",
+"pamAccess":"PAM Access",
+"pamAccessActivation":"Activation",
+"pamAccessAuthzRules":"Authorization rules",
+"pamAccessExportedVars":"Exported variables",
+"pamAccessHeartbeatInterval":"Heartbeat interval",
+"pamAccessHeartbeatRequired":"Require heartbeat",
+"pamAccessInactiveThreshold":"Inactive threshold",
+"pamAccessMaxDuration":"Maximum token duration",
+"pamAccessRp":"OIDC Relying Party",
+"pamAccessRule":"Authorization rule",
+"pamAccessServerGroups":"Server groups",
+"pamAccessSshRules":"SSH rules",
+"pamAccessSudoRules":"Sudo rules",
+"pamAccessTokenDuration":"Default token duration",
 "pamAuthnLevel":"مستوى إثبات الهوية",
 "pamParams":"معايير بام",
 "pamService":"خدمة بام",
@@ -981,6 +1000,7 @@
 "portalDisplayOfflineTokens":"Display offline session tab",
 "portalDisplayOidcConsents":"موافقات OIDC",
 "portalDisplayOrder":"Display order",
+"portalDisplayPamAccess":"Display PAM Access",
 "portalDisplayPasswordPolicy":"Display policy in password form",
 "portalDisplayRefreshMyRights":"Display rights refresh link",
 "portalDisplayRegister":"تسجيل حساب جديد",
@@ -1179,8 +1199,8 @@
 "samlIDPMetaDataOptionsSortNumber":"Order",
 "samlIDPMetaDataOptionsStoreSAMLToken":"حفظ SAML توكن",
 "samlIDPMetaDataOptionsTooltip":"Tooltip",
-"samlIDPMetaDataOptionsUserAttribute":"Attribute containing user identifier",
 "samlIDPMetaDataOptionsURL":"Metadata URL",
+"samlIDPMetaDataOptionsUserAttribute":"Attribute containing user identifier",
 "samlIDPMetaDataXML":"البيانات الوصفية",
 "samlIDPName":"اسم SAML IDP",
 "samlIDPSSODescriptor":"موفر الهوية",
@@ -1329,6 +1349,15 @@
 "soapServices":"SOAP services",
 "soapSessionServer":"Session server",
 "specialRule":"قاعدة خاصة",
+"sshCa":"SSH CA",
+"sshCaActivation":"Activation",
+"sshCaCertDefaultValidity":"Default validity (minutes)",
+"sshCaCertMaxValidity":"Maximum validity (minutes)",
+"sshCaKeyRef":"CA key reference",
+"sshCaKeyType":"CA key type",
+"sshCaKrlPath":"KRL file path",
+"sshCaPrincipalSources":"Principal sources",
+"sshCaSerialPath":"Serial file path",
 "sslByAjax":"استخدام طلب أجاكس",
 "sslHost":"Ajax mTLS URL",
 "sslParams":"mTLS parameters",
diff --git a/lemonldap-ng-manager/site/htdocs/static/languages/en.json b/lemonldap-ng-manager/site/htdocs/static/languages/en.json
index 5e269ed52..422deb8c7 100644
--- a/lemonldap-ng-manager/site/htdocs/static/languages/en.json
+++ b/lemonldap-ng-manager/site/htdocs/static/languages/en.json
@@ -778,6 +778,7 @@
 "oidcRPMetaDataOptionsAdditionalAudiences":"Additional audiences",
 "oidcRPMetaDataOptionsAdvanced":"Advanced",
 "oidcRPMetaDataOptionsAllowClientCredentialsGrant":"Allow OAuth2.0 Client Credentials Grant",
+"oidcRPMetaDataOptionsAllowDeviceAuthorizationGrant":"Allow Device Authorization Grant",
 "oidcRPMetaDataOptionsAllowNativeSso":"Allow Native SSO for Mobile App",
 "oidcRPMetaDataOptionsAllowOffline":"Allow offline access",
 "oidcRPMetaDataOptionsAllowPasswordGrant":"Allow OAuth2.0 Password Grant",
@@ -841,6 +842,9 @@
 "oidcServiceAllowOffline":"Allow offline access",
 "oidcServiceAllowOnlyDeclaredScopes":"Only allow declared scopes",
 "oidcServiceAuthorizationCodeExpiration":"Authorization Codes",
+"oidcServiceDeviceAuthorizationExpiration":"Device code expiration",
+"oidcServiceDeviceAuthorizationPollingInterval":"Polling interval",
+"oidcServiceDeviceAuthorizationUserCodeLength":"User code length",
 "oidcServiceDynamicRegistration":"Dynamic registration",
 "oidcServiceDynamicRegistrationExportedVars":"Exported vars",
 "oidcServiceDynamicRegistrationExtraClaims":"Extra claims",
@@ -861,6 +865,7 @@
 "oidcServiceMetaDataAuthorizeURI":"Authorization",
 "oidcServiceMetaDataBackChannelURI":"Back-Channel URI",
 "oidcServiceMetaDataCheckSessionURI":"Check Session",
+"oidcServiceMetaDataDeviceAuthorization":"Device Authorization (RFC 8628)",
 "oidcServiceMetaDataDisallowNoneAlg":"Disallow \"none\" algorithm for signature",
 "oidcServiceMetaDataEncKeys":"Encryption keys",
 "oidcServiceMetaDataEndPoints":"Endpoints",
@@ -931,6 +936,20 @@
 "openIdSreg_timezone":"Timezone",
 "openidParams":"OpenID parameters",
 "overPrm":"Overloaded parameters",
+"pamAccess":"PAM Access",
+"pamAccessActivation":"Activation",
+"pamAccessAuthzRules":"Authorization rules",
+"pamAccessExportedVars":"Exported variables",
+"pamAccessHeartbeatInterval":"Heartbeat interval",
+"pamAccessHeartbeatRequired":"Require heartbeat",
+"pamAccessInactiveThreshold":"Inactive threshold",
+"pamAccessMaxDuration":"Maximum token duration",
+"pamAccessRp":"OIDC Relying Party",
+"pamAccessRule":"Authorization rule",
+"pamAccessServerGroups":"Server groups",
+"pamAccessSshRules":"SSH rules",
+"pamAccessSudoRules":"Sudo rules",
+"pamAccessTokenDuration":"Default token duration",
 "pamAuthnLevel":"Authentication level",
 "pamParams":"PAM parameters",
 "pamService":"PAM service",
@@ -981,6 +1000,7 @@
 "portalDisplayOfflineTokens":"Display offline session tab",
 "portalDisplayOidcConsents":"OIDC consents",
 "portalDisplayOrder":"Display order",
+"portalDisplayPamAccess":"Display PAM Access",
 "portalDisplayPasswordPolicy":"Display policy in password form",
 "portalDisplayRefreshMyRights":"Display rights refresh link",
 "portalDisplayRegister":"Register new account",
@@ -1179,8 +1199,8 @@
 "samlIDPMetaDataOptionsSortNumber":"Order",
 "samlIDPMetaDataOptionsStoreSAMLToken":"Store SAML Token",
 "samlIDPMetaDataOptionsTooltip":"Tooltip",
-"samlIDPMetaDataOptionsUserAttribute":"Attribute containing user identifier",
 "samlIDPMetaDataOptionsURL":"Metadata URL",
+"samlIDPMetaDataOptionsUserAttribute":"Attribute containing user identifier",
 "samlIDPMetaDataXML":"Metadata",
 "samlIDPName":"SAML IDP Name",
 "samlIDPSSODescriptor":"Identity Provider",
@@ -1329,6 +1349,15 @@
 "soapServices":"SOAP services",
 "soapSessionServer":"Session server",
 "specialRule":"Special rule",
+"sshCa":"SSH CA",
+"sshCaActivation":"Activation",
+"sshCaCertDefaultValidity":"Default validity (minutes)",
+"sshCaCertMaxValidity":"Maximum validity (minutes)",
+"sshCaKeyRef":"CA key reference",
+"sshCaKeyType":"CA key type",
+"sshCaKrlPath":"KRL file path",
+"sshCaPrincipalSources":"Principal sources",
+"sshCaSerialPath":"Serial file path",
 "sslByAjax":"Use Ajax request",
 "sslHost":"Ajax mTLS URL",
 "sslParams":"mTLS parameters",
diff --git a/lemonldap-ng-manager/site/htdocs/static/languages/es.json b/lemonldap-ng-manager/site/htdocs/static/languages/es.json
index e70233093..ff8b19f39 100644
--- a/lemonldap-ng-manager/site/htdocs/static/languages/es.json
+++ b/lemonldap-ng-manager/site/htdocs/static/languages/es.json
@@ -778,6 +778,7 @@
 "oidcRPMetaDataOptionsAdditionalAudiences":"Additional audiences",
 "oidcRPMetaDataOptionsAdvanced":"Advanced",
 "oidcRPMetaDataOptionsAllowClientCredentialsGrant":"Allow OAuth2.0 Client Credentials Grant",
+"oidcRPMetaDataOptionsAllowDeviceAuthorizationGrant":"Allow Device Authorization Grant",
 "oidcRPMetaDataOptionsAllowNativeSso":"Allow Native SSO for Mobile App",
 "oidcRPMetaDataOptionsAllowOffline":"Permitir acceso sin conexión",
 "oidcRPMetaDataOptionsAllowPasswordGrant":"Allow OAuth2.0 Password Grant",
@@ -841,6 +842,9 @@
 "oidcServiceAllowOffline":"Permitir acceso offline",
 "oidcServiceAllowOnlyDeclaredScopes":"Only allow declared scopes",
 "oidcServiceAuthorizationCodeExpiration":"Authorization Codes",
+"oidcServiceDeviceAuthorizationExpiration":"Device code expiration",
+"oidcServiceDeviceAuthorizationPollingInterval":"Polling interval",
+"oidcServiceDeviceAuthorizationUserCodeLength":"User code length",
 "oidcServiceDynamicRegistration":"Dynamic registration",
 "oidcServiceDynamicRegistrationExportedVars":"Exported vars",
 "oidcServiceDynamicRegistrationExtraClaims":"Extra claims",
@@ -861,6 +865,7 @@
 "oidcServiceMetaDataAuthorizeURI":"Autorización",
 "oidcServiceMetaDataBackChannelURI":"URI de Back-Channel",
 "oidcServiceMetaDataCheckSessionURI":"Check Session",
+"oidcServiceMetaDataDeviceAuthorization":"Device Authorization (RFC 8628)",
 "oidcServiceMetaDataDisallowNoneAlg":"Disallow \"none\" algorithm for signature",
 "oidcServiceMetaDataEncKeys":"Encryption keys",
 "oidcServiceMetaDataEndPoints":"Endpoints",
@@ -931,6 +936,20 @@
 "openIdSreg_timezone":"Zona horaria",
 "openidParams":"Parámetros OpenID",
 "overPrm":"Overloaded parameters",
+"pamAccess":"PAM Access",
+"pamAccessActivation":"Activation",
+"pamAccessAuthzRules":"Authorization rules",
+"pamAccessExportedVars":"Exported variables",
+"pamAccessHeartbeatInterval":"Heartbeat interval",
+"pamAccessHeartbeatRequired":"Require heartbeat",
+"pamAccessInactiveThreshold":"Inactive threshold",
+"pamAccessMaxDuration":"Maximum token duration",
+"pamAccessRp":"OIDC Relying Party",
+"pamAccessRule":"Authorization rule",
+"pamAccessServerGroups":"Server groups",
+"pamAccessSshRules":"SSH rules",
+"pamAccessSudoRules":"Sudo rules",
+"pamAccessTokenDuration":"Default token duration",
 "pamAuthnLevel":"Nivel de autentificación",
 "pamParams":"Parámetros PAM",
 "pamService":"Servicio PAM",
@@ -981,6 +1000,7 @@
 "portalDisplayOfflineTokens":"Display offline session tab",
 "portalDisplayOidcConsents":"Permisos OIDC",
 "portalDisplayOrder":"Display order",
+"portalDisplayPamAccess":"Display PAM Access",
 "portalDisplayPasswordPolicy":"Display policy in password form",
 "portalDisplayRefreshMyRights":"Display rights refresh link",
 "portalDisplayRegister":"Registrar nueva cuenta",
@@ -1179,8 +1199,8 @@
 "samlIDPMetaDataOptionsSortNumber":"Orden",
 "samlIDPMetaDataOptionsStoreSAMLToken":"Store SAML Token",
 "samlIDPMetaDataOptionsTooltip":"Tooltip",
-"samlIDPMetaDataOptionsUserAttribute":"Attribute containing user identifier",
 "samlIDPMetaDataOptionsURL":"Metadata URL",
+"samlIDPMetaDataOptionsUserAttribute":"Attribute containing user identifier",
 "samlIDPMetaDataXML":"Metadatos",
 "samlIDPName":"SAML IDP Name",
 "samlIDPSSODescriptor":"Identity Provider",
@@ -1329,6 +1349,15 @@
 "soapServices":"Servicio SOAP",
 "soapSessionServer":"Session server",
 "specialRule":"Regla especial",
+"sshCa":"SSH CA",
+"sshCaActivation":"Activation",
+"sshCaCertDefaultValidity":"Default validity (minutes)",
+"sshCaCertMaxValidity":"Maximum validity (minutes)",
+"sshCaKeyRef":"CA key reference",
+"sshCaKeyType":"CA key type",
+"sshCaKrlPath":"KRL file path",
+"sshCaPrincipalSources":"Principal sources",
+"sshCaSerialPath":"Serial file path",
 "sslByAjax":"Usar solicitud Ajax",
 "sslHost":"Ajax mTLS URL",
 "sslParams":"mTLS parameters",
diff --git a/lemonldap-ng-manager/site/htdocs/static/languages/fr.json b/lemonldap-ng-manager/site/htdocs/static/languages/fr.json
index 4617307dd..69fb704c0 100644
--- a/lemonldap-ng-manager/site/htdocs/static/languages/fr.json
+++ b/lemonldap-ng-manager/site/htdocs/static/languages/fr.json
@@ -778,6 +778,7 @@
 "oidcRPMetaDataOptionsAdditionalAudiences":"Audiences supplémentaires",
 "oidcRPMetaDataOptionsAdvanced":"Avancées",
 "oidcRPMetaDataOptionsAllowClientCredentialsGrant":"Autoriser le Client Credentials Grant OAuth2.0",
+"oidcRPMetaDataOptionsAllowDeviceAuthorizationGrant":"Autoriser le flux d'autorisation d'appareil",
 "oidcRPMetaDataOptionsAllowNativeSso":"Autorise le SSO natif pour application mobile",
 "oidcRPMetaDataOptionsAllowOffline":"Autoriser l'accès hors ligne",
 "oidcRPMetaDataOptionsAllowPasswordGrant":"Autoriser le Password Grant OAuth2.0",
@@ -841,6 +842,9 @@
 "oidcServiceAllowOffline":"Autoriser l'accès hors ligne",
 "oidcServiceAllowOnlyDeclaredScopes":"N'autoriser que les scopes déclarés",
 "oidcServiceAuthorizationCodeExpiration":"Codes d'autorisation",
+"oidcServiceDeviceAuthorizationExpiration":"Expiration du code appareil",
+"oidcServiceDeviceAuthorizationPollingInterval":"Intervalle de polling",
+"oidcServiceDeviceAuthorizationUserCodeLength":"Longueur du code utilisateur",
 "oidcServiceDynamicRegistration":"Enregistrement dynamique",
 "oidcServiceDynamicRegistrationExportedVars":"Variables exportées",
 "oidcServiceDynamicRegistrationExtraClaims":"Claims supplémentaires",
@@ -861,6 +865,7 @@
 "oidcServiceMetaDataAuthorizeURI":"Autorisation",
 "oidcServiceMetaDataBackChannelURI":"URI du canal caché",
 "oidcServiceMetaDataCheckSessionURI":"Vérification de session",
+"oidcServiceMetaDataDeviceAuthorization":"Autorisation d'appareil (RFC 8628)",
 "oidcServiceMetaDataDisallowNoneAlg":"Désactiver l'algorithme none pour les signatures",
 "oidcServiceMetaDataEncKeys":"Clefs de chiffrement",
 "oidcServiceMetaDataEndPoints":"Points d'accès",
@@ -931,6 +936,20 @@
 "openIdSreg_timezone":"Zone horaire",
 "openidParams":"Paramètres OpenID",
 "overPrm":"Paramètres surchargés",
+"pamAccess":"Accès PAM",
+"pamAccessActivation":"Activation",
+"pamAccessAuthzRules":"Règles d'autorisation",
+"pamAccessExportedVars":"Variables exportées",
+"pamAccessHeartbeatInterval":"Intervalle de heartbeat",
+"pamAccessHeartbeatRequired":"Exiger le heartbeat",
+"pamAccessInactiveThreshold":"Seuil d'inactivité",
+"pamAccessMaxDuration":"Durée maximale du token",
+"pamAccessRp":"Fournisseur de service OIDC",
+"pamAccessRule":"Règle d'autorisation",
+"pamAccessServerGroups":"Groupes de serveurs",
+"pamAccessSshRules":"Règles SSH",
+"pamAccessSudoRules":"Règles sudo",
+"pamAccessTokenDuration":"Durée par défaut du token",
 "pamAuthnLevel":"Niveau d'authentification",
 "pamParams":"Paramètres PAM",
 "pamService":"Service PAM",
@@ -981,6 +1000,7 @@
 "portalDisplayOfflineTokens":"Afficher onglet des sessions hors-ligne",
 "portalDisplayOidcConsents":"Consentements OIDC",
 "portalDisplayOrder":"Ordre d'affichage",
+"portalDisplayPamAccess":"Afficher Accès PAM",
 "portalDisplayPasswordPolicy":"Afficher la politique dans le formulaire de mot de passe",
 "portalDisplayRefreshMyRights":"Afficher le lien de rafraichissement des droits",
 "portalDisplayRegister":"Création d'un nouveau compte",
@@ -1179,8 +1199,8 @@
 "samlIDPMetaDataOptionsSortNumber":"Ordre",
 "samlIDPMetaDataOptionsStoreSAMLToken":"Conserver le jeton SAML",
 "samlIDPMetaDataOptionsTooltip":"Info-bulle",
-"samlIDPMetaDataOptionsUserAttribute":"Attribut contenant l'identité de l'utilisateur",
 "samlIDPMetaDataOptionsURL":"URL des Métadonnées",
+"samlIDPMetaDataOptionsUserAttribute":"Attribut contenant l'identité de l'utilisateur",
 "samlIDPMetaDataXML":"Metadonnées",
 "samlIDPName":"Nom du fournisseur d'identité SAML",
 "samlIDPSSODescriptor":"Fournisseur d'identité",
@@ -1329,6 +1349,15 @@
 "soapServices":"Services SOAP",
 "soapSessionServer":"Serveur de sessions",
 "specialRule":"Règle spécifique",
+"sshCa":"CA SSH",
+"sshCaActivation":"Activation",
+"sshCaCertDefaultValidity":"Validité par défaut (minutes)",
+"sshCaCertMaxValidity":"Validité maximale (minutes)",
+"sshCaKeyRef":"Référence de la clé CA",
+"sshCaKeyType":"Type de clé CA",
+"sshCaKrlPath":"Chemin du fichier KRL",
+"sshCaPrincipalSources":"Sources des principals",
+"sshCaSerialPath":"Chemin du fichier de série",
 "sslByAjax":"Utiliser une requête Ajax",
 "sslHost":"URL mTLS pour Ajax",
 "sslParams":"Paramètres mTLS",
@@ -1472,4 +1501,4 @@
 "yubikey2fUrl":"URL du service",
 "yubikey2fUserCanRemoveKey":"Autoriser les utilisateurs à effacer leur Yubikey",
 "zeroConfExplanations":"Le serveur ne dispose pas de configuration. Cette configuration de base vous permet d'en initialiser une."
-}
+}
\ No newline at end of file
diff --git a/lemonldap-ng-manager/site/htdocs/static/languages/he.json b/lemonldap-ng-manager/site/htdocs/static/languages/he.json
index 8c56267dd..57cf6729b 100644
--- a/lemonldap-ng-manager/site/htdocs/static/languages/he.json
+++ b/lemonldap-ng-manager/site/htdocs/static/languages/he.json
@@ -778,6 +778,7 @@
 "oidcRPMetaDataOptionsAdditionalAudiences":"Additional audiences",
 "oidcRPMetaDataOptionsAdvanced":"מתקדם",
 "oidcRPMetaDataOptionsAllowClientCredentialsGrant":"Allow OAuth2.0 Client Credentials Grant",
+"oidcRPMetaDataOptionsAllowDeviceAuthorizationGrant":"Allow Device Authorization Grant",
 "oidcRPMetaDataOptionsAllowNativeSso":"Allow Native SSO for Mobile App",
 "oidcRPMetaDataOptionsAllowOffline":"לאפשר גישה בלתי מקוונת",
 "oidcRPMetaDataOptionsAllowPasswordGrant":"Allow OAuth2.0 Password Grant",
@@ -841,6 +842,9 @@
 "oidcServiceAllowOffline":"לאפשר גישה בלתי מקוונת",
 "oidcServiceAllowOnlyDeclaredScopes":"Only allow declared scopes",
 "oidcServiceAuthorizationCodeExpiration":"Authorization Codes",
+"oidcServiceDeviceAuthorizationExpiration":"Device code expiration",
+"oidcServiceDeviceAuthorizationPollingInterval":"Polling interval",
+"oidcServiceDeviceAuthorizationUserCodeLength":"User code length",
 "oidcServiceDynamicRegistration":"Dynamic registration",
 "oidcServiceDynamicRegistrationExportedVars":"Exported vars",
 "oidcServiceDynamicRegistrationExtraClaims":"Extra claims",
@@ -861,6 +865,7 @@
 "oidcServiceMetaDataAuthorizeURI":"Authorization",
 "oidcServiceMetaDataBackChannelURI":"Back-Channel URI",
 "oidcServiceMetaDataCheckSessionURI":"Check Session",
+"oidcServiceMetaDataDeviceAuthorization":"Device Authorization (RFC 8628)",
 "oidcServiceMetaDataDisallowNoneAlg":"Disallow \"none\" algorithm for signature",
 "oidcServiceMetaDataEncKeys":"Encryption keys",
 "oidcServiceMetaDataEndPoints":"Endpoints",
@@ -931,6 +936,20 @@
 "openIdSreg_timezone":"אזור זמן",
 "openidParams":"OpenID parameters",
 "overPrm":"משתנים מועמסים",
+"pamAccess":"PAM Access",
+"pamAccessActivation":"Activation",
+"pamAccessAuthzRules":"Authorization rules",
+"pamAccessExportedVars":"Exported variables",
+"pamAccessHeartbeatInterval":"Heartbeat interval",
+"pamAccessHeartbeatRequired":"Require heartbeat",
+"pamAccessInactiveThreshold":"Inactive threshold",
+"pamAccessMaxDuration":"Maximum token duration",
+"pamAccessRp":"OIDC Relying Party",
+"pamAccessRule":"Authorization rule",
+"pamAccessServerGroups":"Server groups",
+"pamAccessSshRules":"SSH rules",
+"pamAccessSudoRules":"Sudo rules",
+"pamAccessTokenDuration":"Default token duration",
 "pamAuthnLevel":"דרגת אימות",
 "pamParams":"משתני PAM",
 "pamService":"שירות PAM",
@@ -981,6 +1000,7 @@
 "portalDisplayOfflineTokens":"Display offline session tab",
 "portalDisplayOidcConsents":"הסכמות OIDC",
 "portalDisplayOrder":"Display order",
+"portalDisplayPamAccess":"Display PAM Access",
 "portalDisplayPasswordPolicy":"הצגת המדיניות בטופס הסיסמה",
 "portalDisplayRefreshMyRights":"Display rights refresh link",
 "portalDisplayRegister":"רישום חשבון חדש",
@@ -1179,8 +1199,8 @@
 "samlIDPMetaDataOptionsSortNumber":"סדר",
 "samlIDPMetaDataOptionsStoreSAMLToken":"אחסון אסימון SAML",
 "samlIDPMetaDataOptionsTooltip":"חלונית עצה",
-"samlIDPMetaDataOptionsUserAttribute":"Attribute containing user identifier",
 "samlIDPMetaDataOptionsURL":"Metadata URL",
+"samlIDPMetaDataOptionsUserAttribute":"Attribute containing user identifier",
 "samlIDPMetaDataXML":"נתוני על",
 "samlIDPName":"SAML IDP Name",
 "samlIDPSSODescriptor":"Identity Provider",
@@ -1329,6 +1349,15 @@
 "soapServices":"SOAP services",
 "soapSessionServer":"שרת הפעלה",
 "specialRule":"כלל מיוחד",
+"sshCa":"SSH CA",
+"sshCaActivation":"Activation",
+"sshCaCertDefaultValidity":"Default validity (minutes)",
+"sshCaCertMaxValidity":"Maximum validity (minutes)",
+"sshCaKeyRef":"CA key reference",
+"sshCaKeyType":"CA key type",
+"sshCaKrlPath":"KRL file path",
+"sshCaPrincipalSources":"Principal sources",
+"sshCaSerialPath":"Serial file path",
 "sslByAjax":"להשתמש בבקשת Ajax",
 "sslHost":"Ajax mTLS URL",
 "sslParams":"mTLS parameters",
diff --git a/lemonldap-ng-manager/site/htdocs/static/languages/it.json b/lemonldap-ng-manager/site/htdocs/static/languages/it.json
index eda03125c..ca20f81bf 100644
--- a/lemonldap-ng-manager/site/htdocs/static/languages/it.json
+++ b/lemonldap-ng-manager/site/htdocs/static/languages/it.json
@@ -778,6 +778,7 @@
 "oidcRPMetaDataOptionsAdditionalAudiences":"Additional audiences",
 "oidcRPMetaDataOptionsAdvanced":"Avanzato",
 "oidcRPMetaDataOptionsAllowClientCredentialsGrant":"Allow OAuth2.0 Client Credentials Grant",
+"oidcRPMetaDataOptionsAllowDeviceAuthorizationGrant":"Allow Device Authorization Grant",
 "oidcRPMetaDataOptionsAllowNativeSso":"Allow Native SSO for Mobile App",
 "oidcRPMetaDataOptionsAllowOffline":"Allow offline access",
 "oidcRPMetaDataOptionsAllowPasswordGrant":"Allow OAuth2.0 Password Grant",
@@ -841,6 +842,9 @@
 "oidcServiceAllowOffline":"Allow offline access",
 "oidcServiceAllowOnlyDeclaredScopes":"Only allow declared scopes",
 "oidcServiceAuthorizationCodeExpiration":"Authorization Codes",
+"oidcServiceDeviceAuthorizationExpiration":"Device code expiration",
+"oidcServiceDeviceAuthorizationPollingInterval":"Polling interval",
+"oidcServiceDeviceAuthorizationUserCodeLength":"User code length",
 "oidcServiceDynamicRegistration":"Dynamic registration",
 "oidcServiceDynamicRegistrationExportedVars":"Exported vars",
 "oidcServiceDynamicRegistrationExtraClaims":"Richieste supplementari",
@@ -861,6 +865,7 @@
 "oidcServiceMetaDataAuthorizeURI":"Autorizzazione",
 "oidcServiceMetaDataBackChannelURI":"URI Back-Channel",
 "oidcServiceMetaDataCheckSessionURI":"Controlla sessione",
+"oidcServiceMetaDataDeviceAuthorization":"Device Authorization (RFC 8628)",
 "oidcServiceMetaDataDisallowNoneAlg":"Disallow \"none\" algorithm for signature",
 "oidcServiceMetaDataEncKeys":"Encryption keys",
 "oidcServiceMetaDataEndPoints":"Endpoints",
@@ -931,6 +936,20 @@
 "openIdSreg_timezone":"Fuso orario",
 "openidParams":"Parametri OpenID",
 "overPrm":"Parametri sovraccaricati",
+"pamAccess":"PAM Access",
+"pamAccessActivation":"Activation",
+"pamAccessAuthzRules":"Authorization rules",
+"pamAccessExportedVars":"Exported variables",
+"pamAccessHeartbeatInterval":"Heartbeat interval",
+"pamAccessHeartbeatRequired":"Require heartbeat",
+"pamAccessInactiveThreshold":"Inactive threshold",
+"pamAccessMaxDuration":"Maximum token duration",
+"pamAccessRp":"OIDC Relying Party",
+"pamAccessRule":"Authorization rule",
+"pamAccessServerGroups":"Server groups",
+"pamAccessSshRules":"SSH rules",
+"pamAccessSudoRules":"Sudo rules",
+"pamAccessTokenDuration":"Default token duration",
 "pamAuthnLevel":"Livello di autenticazione",
 "pamParams":"Parametri PAM",
 "pamService":"Servizio PAM",
@@ -981,6 +1000,7 @@
 "portalDisplayOfflineTokens":"Display offline session tab",
 "portalDisplayOidcConsents":"Consensi OIDC",
 "portalDisplayOrder":"Display order",
+"portalDisplayPamAccess":"Display PAM Access",
 "portalDisplayPasswordPolicy":"Display policy in password form",
 "portalDisplayRefreshMyRights":"Display rights refresh link",
 "portalDisplayRegister":"Registra nuovo account",
@@ -1179,8 +1199,8 @@
 "samlIDPMetaDataOptionsSortNumber":"Ordine",
 "samlIDPMetaDataOptionsStoreSAMLToken":"Store SAML Token",
 "samlIDPMetaDataOptionsTooltip":"Tooltip",
-"samlIDPMetaDataOptionsUserAttribute":"Attributo che contiene l'identificatore dell'utente",
 "samlIDPMetaDataOptionsURL":"Metadata URL",
+"samlIDPMetaDataOptionsUserAttribute":"Attributo che contiene l'identificatore dell'utente",
 "samlIDPMetaDataXML":"Metadati",
 "samlIDPName":"Nome di SAML IDP ",
 "samlIDPSSODescriptor":"Provider di identità",
@@ -1329,6 +1349,15 @@
 "soapServices":"SOAP services",
 "soapSessionServer":"Session server",
 "specialRule":"Regola speciale",
+"sshCa":"SSH CA",
+"sshCaActivation":"Activation",
+"sshCaCertDefaultValidity":"Default validity (minutes)",
+"sshCaCertMaxValidity":"Maximum validity (minutes)",
+"sshCaKeyRef":"CA key reference",
+"sshCaKeyType":"CA key type",
+"sshCaKrlPath":"KRL file path",
+"sshCaPrincipalSources":"Principal sources",
+"sshCaSerialPath":"Serial file path",
 "sslByAjax":"Utilizzare la richiesta Ajax",
 "sslHost":"Ajax mTLS URL",
 "sslParams":"mTLS parameters",
diff --git a/lemonldap-ng-manager/site/htdocs/static/languages/pl.json b/lemonldap-ng-manager/site/htdocs/static/languages/pl.json
index 5592cd6f2..44820b4f5 100644
--- a/lemonldap-ng-manager/site/htdocs/static/languages/pl.json
+++ b/lemonldap-ng-manager/site/htdocs/static/languages/pl.json
@@ -778,6 +778,7 @@
 "oidcRPMetaDataOptionsAdditionalAudiences":"Dodatkowi odbiorcy",
 "oidcRPMetaDataOptionsAdvanced":"Zaawansowane",
 "oidcRPMetaDataOptionsAllowClientCredentialsGrant":"Zezwalaj na przyznanie poświadczeń klienta OAuth2.0",
+"oidcRPMetaDataOptionsAllowDeviceAuthorizationGrant":"Allow Device Authorization Grant",
 "oidcRPMetaDataOptionsAllowNativeSso":"Allow Native SSO for Mobile App",
 "oidcRPMetaDataOptionsAllowOffline":"Zezwalaj na dostęp offline",
 "oidcRPMetaDataOptionsAllowPasswordGrant":"Zezwól na przyznanie hasła OAuth2.0",
@@ -841,6 +842,9 @@
 "oidcServiceAllowOffline":"Zezwalaj na dostęp offline",
 "oidcServiceAllowOnlyDeclaredScopes":"Zezwalaj tylko na zadeklarowane zakresy",
 "oidcServiceAuthorizationCodeExpiration":"Kody autoryzacyjne",
+"oidcServiceDeviceAuthorizationExpiration":"Device code expiration",
+"oidcServiceDeviceAuthorizationPollingInterval":"Polling interval",
+"oidcServiceDeviceAuthorizationUserCodeLength":"User code length",
 "oidcServiceDynamicRegistration":"Rejestracja dynamiczna",
 "oidcServiceDynamicRegistrationExportedVars":"Wyeksportowane zmienne",
 "oidcServiceDynamicRegistrationExtraClaims":"Dodatkowe roszczenia",
@@ -861,6 +865,7 @@
 "oidcServiceMetaDataAuthorizeURI":"Autoryzacja",
 "oidcServiceMetaDataBackChannelURI":"Identyfikator URI kanału zwrotnego",
 "oidcServiceMetaDataCheckSessionURI":"Sprawdź sesję",
+"oidcServiceMetaDataDeviceAuthorization":"Device Authorization (RFC 8628)",
 "oidcServiceMetaDataDisallowNoneAlg":"Disallow \"none\" algorithm for signature",
 "oidcServiceMetaDataEncKeys":"Klucze szyfrujące",
 "oidcServiceMetaDataEndPoints":"Punkty końcowe",
@@ -931,6 +936,20 @@
 "openIdSreg_timezone":"Strefa czasowa",
 "openidParams":"Parametry OpenID",
 "overPrm":"Przeciążone parametry",
+"pamAccess":"PAM Access",
+"pamAccessActivation":"Activation",
+"pamAccessAuthzRules":"Authorization rules",
+"pamAccessExportedVars":"Exported variables",
+"pamAccessHeartbeatInterval":"Heartbeat interval",
+"pamAccessHeartbeatRequired":"Require heartbeat",
+"pamAccessInactiveThreshold":"Inactive threshold",
+"pamAccessMaxDuration":"Maximum token duration",
+"pamAccessRp":"OIDC Relying Party",
+"pamAccessRule":"Authorization rule",
+"pamAccessServerGroups":"Server groups",
+"pamAccessSshRules":"SSH rules",
+"pamAccessSudoRules":"Sudo rules",
+"pamAccessTokenDuration":"Default token duration",
 "pamAuthnLevel":"Poziom uwierzytelnienia",
 "pamParams":"Parametry PAM",
 "pamService":"Usługa PAM",
@@ -981,6 +1000,7 @@
 "portalDisplayOfflineTokens":"Display offline session tab",
 "portalDisplayOidcConsents":"Zgody OIDC",
 "portalDisplayOrder":"Kolejność wyświetlania",
+"portalDisplayPamAccess":"Display PAM Access",
 "portalDisplayPasswordPolicy":"Wyświetl zasady w formie hasła",
 "portalDisplayRefreshMyRights":"Wyświetl link do odświeżania praw",
 "portalDisplayRegister":"Zarejestruj Nowe Konto",
@@ -1179,8 +1199,8 @@
 "samlIDPMetaDataOptionsSortNumber":"Kolejność",
 "samlIDPMetaDataOptionsStoreSAMLToken":"Przechowuj token SAML",
 "samlIDPMetaDataOptionsTooltip":"Etykietka",
-"samlIDPMetaDataOptionsUserAttribute":"Atrybut zawierający identyfikator użytkownika",
 "samlIDPMetaDataOptionsURL":"Metadata URL",
+"samlIDPMetaDataOptionsUserAttribute":"Atrybut zawierający identyfikator użytkownika",
 "samlIDPMetaDataXML":"Metadane",
 "samlIDPName":"Nazwa IDP SAML",
 "samlIDPSSODescriptor":"Dostawca tożsamości",
@@ -1329,6 +1349,15 @@
 "soapServices":"Usługa SOAP",
 "soapSessionServer":"Serwer sesji",
 "specialRule":"Reguła specjalna",
+"sshCa":"SSH CA",
+"sshCaActivation":"Activation",
+"sshCaCertDefaultValidity":"Default validity (minutes)",
+"sshCaCertMaxValidity":"Maximum validity (minutes)",
+"sshCaKeyRef":"CA key reference",
+"sshCaKeyType":"CA key type",
+"sshCaKrlPath":"KRL file path",
+"sshCaPrincipalSources":"Principal sources",
+"sshCaSerialPath":"Serial file path",
 "sslByAjax":"Użyj żądania Ajax",
 "sslHost":"Ajax mTLS URL",
 "sslParams":"mTLS parameters",
diff --git a/lemonldap-ng-manager/site/htdocs/static/languages/pt.json b/lemonldap-ng-manager/site/htdocs/static/languages/pt.json
index 635539687..2633e0a04 100644
--- a/lemonldap-ng-manager/site/htdocs/static/languages/pt.json
+++ b/lemonldap-ng-manager/site/htdocs/static/languages/pt.json
@@ -778,6 +778,7 @@
 "oidcRPMetaDataOptionsAdditionalAudiences":"Audiências adicionais",
 "oidcRPMetaDataOptionsAdvanced":"Avançado",
 "oidcRPMetaDataOptionsAllowClientCredentialsGrant":"Permitir concessão de credenciais OAuth2.0 de cliente",
+"oidcRPMetaDataOptionsAllowDeviceAuthorizationGrant":"Allow Device Authorization Grant",
 "oidcRPMetaDataOptionsAllowNativeSso":"Allow Native SSO for Mobile App",
 "oidcRPMetaDataOptionsAllowOffline":"Permitir acesso offline",
 "oidcRPMetaDataOptionsAllowPasswordGrant":"Permitir concessão de senha OAuth2.0",
@@ -841,6 +842,9 @@
 "oidcServiceAllowOffline":"Permitir acesso offline",
 "oidcServiceAllowOnlyDeclaredScopes":"Permitir apenas escopos declarados",
 "oidcServiceAuthorizationCodeExpiration":"Códigos de Autorização",
+"oidcServiceDeviceAuthorizationExpiration":"Device code expiration",
+"oidcServiceDeviceAuthorizationPollingInterval":"Polling interval",
+"oidcServiceDeviceAuthorizationUserCodeLength":"User code length",
 "oidcServiceDynamicRegistration":"Registro dinâmico",
 "oidcServiceDynamicRegistrationExportedVars":"Vars exportadas",
 "oidcServiceDynamicRegistrationExtraClaims":"Reinvidicações extras",
@@ -861,6 +865,7 @@
 "oidcServiceMetaDataAuthorizeURI":"Autorização",
 "oidcServiceMetaDataBackChannelURI":"URI do Back-Channel",
 "oidcServiceMetaDataCheckSessionURI":"Conferir sessão",
+"oidcServiceMetaDataDeviceAuthorization":"Device Authorization (RFC 8628)",
 "oidcServiceMetaDataDisallowNoneAlg":"Disallow \"none\" algorithm for signature",
 "oidcServiceMetaDataEncKeys":"Encryption keys",
 "oidcServiceMetaDataEndPoints":"Pontos finais",
@@ -931,6 +936,20 @@
 "openIdSreg_timezone":"Fuso horário",
 "openidParams":"Parâmetros OpenID",
 "overPrm":"Parâmetros sobrecarregarga",
+"pamAccess":"PAM Access",
+"pamAccessActivation":"Activation",
+"pamAccessAuthzRules":"Authorization rules",
+"pamAccessExportedVars":"Exported variables",
+"pamAccessHeartbeatInterval":"Heartbeat interval",
+"pamAccessHeartbeatRequired":"Require heartbeat",
+"pamAccessInactiveThreshold":"Inactive threshold",
+"pamAccessMaxDuration":"Maximum token duration",
+"pamAccessRp":"OIDC Relying Party",
+"pamAccessRule":"Authorization rule",
+"pamAccessServerGroups":"Server groups",
+"pamAccessSshRules":"SSH rules",
+"pamAccessSudoRules":"Sudo rules",
+"pamAccessTokenDuration":"Default token duration",
 "pamAuthnLevel":"Nível de autenticação",
 "pamParams":"Parâmetros PAM",
 "pamService":"Serviço PAM",
@@ -981,6 +1000,7 @@
 "portalDisplayOfflineTokens":"Display offline session tab",
 "portalDisplayOidcConsents":"Consentimentos OIDC",
 "portalDisplayOrder":"Ordem de apresentação",
+"portalDisplayPamAccess":"Display PAM Access",
 "portalDisplayPasswordPolicy":"Mostrar a política no formulário de senha",
 "portalDisplayRefreshMyRights":"Mostrar o link de renovar direitos",
 "portalDisplayRegister":"Registre uma nova conta",
@@ -1179,8 +1199,8 @@
 "samlIDPMetaDataOptionsSortNumber":"Ordem",
 "samlIDPMetaDataOptionsStoreSAMLToken":"Guardar token SAML",
 "samlIDPMetaDataOptionsTooltip":"Dica da ferramenta",
-"samlIDPMetaDataOptionsUserAttribute":"Atributo contendo o identificador do usuário",
 "samlIDPMetaDataOptionsURL":"Metadata URL",
+"samlIDPMetaDataOptionsUserAttribute":"Atributo contendo o identificador do usuário",
 "samlIDPMetaDataXML":"Metadados",
 "samlIDPName":"Nome do IDP SAML",
 "samlIDPSSODescriptor":"Provedor de Identidade",
@@ -1329,6 +1349,15 @@
 "soapServices":"Serviços SOAP",
 "soapSessionServer":"Servidor de sessão",
 "specialRule":"Regra especial",
+"sshCa":"SSH CA",
+"sshCaActivation":"Activation",
+"sshCaCertDefaultValidity":"Default validity (minutes)",
+"sshCaCertMaxValidity":"Maximum validity (minutes)",
+"sshCaKeyRef":"CA key reference",
+"sshCaKeyType":"CA key type",
+"sshCaKrlPath":"KRL file path",
+"sshCaPrincipalSources":"Principal sources",
+"sshCaSerialPath":"Serial file path",
 "sslByAjax":"Use requisição AJAX",
 "sslHost":"Ajax mTLS URL",
 "sslParams":"mTLS parameters",
diff --git a/lemonldap-ng-manager/site/htdocs/static/languages/pt_BR.json b/lemonldap-ng-manager/site/htdocs/static/languages/pt_BR.json
index 1ba264e56..6f3cf081f 100644
--- a/lemonldap-ng-manager/site/htdocs/static/languages/pt_BR.json
+++ b/lemonldap-ng-manager/site/htdocs/static/languages/pt_BR.json
@@ -778,6 +778,7 @@
 "oidcRPMetaDataOptionsAdditionalAudiences":"Audiências adicionais",
 "oidcRPMetaDataOptionsAdvanced":"Avançado",
 "oidcRPMetaDataOptionsAllowClientCredentialsGrant":"Permitir concessão de credenciais OAuth2.0 de cliente",
+"oidcRPMetaDataOptionsAllowDeviceAuthorizationGrant":"Allow Device Authorization Grant",
 "oidcRPMetaDataOptionsAllowNativeSso":"Allow Native SSO for Mobile App",
 "oidcRPMetaDataOptionsAllowOffline":"Permitir acesso offline",
 "oidcRPMetaDataOptionsAllowPasswordGrant":"Permitir concessão de senha OAuth2.0",
@@ -841,6 +842,9 @@
 "oidcServiceAllowOffline":"Permitir acesso offline",
 "oidcServiceAllowOnlyDeclaredScopes":"Permitir apenas escopos declarados",
 "oidcServiceAuthorizationCodeExpiration":"Códigos de Autorização",
+"oidcServiceDeviceAuthorizationExpiration":"Device code expiration",
+"oidcServiceDeviceAuthorizationPollingInterval":"Polling interval",
+"oidcServiceDeviceAuthorizationUserCodeLength":"User code length",
 "oidcServiceDynamicRegistration":"Registro dinâmico",
 "oidcServiceDynamicRegistrationExportedVars":"Vars exportadas",
 "oidcServiceDynamicRegistrationExtraClaims":"Reinvidicações extras",
@@ -861,6 +865,7 @@
 "oidcServiceMetaDataAuthorizeURI":"Autorização",
 "oidcServiceMetaDataBackChannelURI":"URI do Back-Channel",
 "oidcServiceMetaDataCheckSessionURI":"Conferir sessão",
+"oidcServiceMetaDataDeviceAuthorization":"Device Authorization (RFC 8628)",
 "oidcServiceMetaDataDisallowNoneAlg":"Disallow \"none\" algorithm for signature",
 "oidcServiceMetaDataEncKeys":"Encryption keys",
 "oidcServiceMetaDataEndPoints":"Pontos finais",
@@ -931,6 +936,20 @@
 "openIdSreg_timezone":"Fuso horário",
 "openidParams":"Parâmetros OpenID",
 "overPrm":"Parâmetros sobrecarregados",
+"pamAccess":"PAM Access",
+"pamAccessActivation":"Activation",
+"pamAccessAuthzRules":"Authorization rules",
+"pamAccessExportedVars":"Exported variables",
+"pamAccessHeartbeatInterval":"Heartbeat interval",
+"pamAccessHeartbeatRequired":"Require heartbeat",
+"pamAccessInactiveThreshold":"Inactive threshold",
+"pamAccessMaxDuration":"Maximum token duration",
+"pamAccessRp":"OIDC Relying Party",
+"pamAccessRule":"Authorization rule",
+"pamAccessServerGroups":"Server groups",
+"pamAccessSshRules":"SSH rules",
+"pamAccessSudoRules":"Sudo rules",
+"pamAccessTokenDuration":"Default token duration",
 "pamAuthnLevel":"Nível de autenticação",
 "pamParams":"Parâmetros PAM",
 "pamService":"Serviço PAM",
@@ -981,6 +1000,7 @@
 "portalDisplayOfflineTokens":"Display offline session tab",
 "portalDisplayOidcConsents":"Consentimentos OIDC",
 "portalDisplayOrder":"Ordem de apresentação",
+"portalDisplayPamAccess":"Display PAM Access",
 "portalDisplayPasswordPolicy":"Mostrar a política no formulário de senha",
 "portalDisplayRefreshMyRights":"Mostrar o link de renovar direitos",
 "portalDisplayRegister":"Registre uma nova conta",
@@ -1179,8 +1199,8 @@
 "samlIDPMetaDataOptionsSortNumber":"Ordem",
 "samlIDPMetaDataOptionsStoreSAMLToken":"Guardar token SAML",
 "samlIDPMetaDataOptionsTooltip":"Dica da ferramenta",
-"samlIDPMetaDataOptionsUserAttribute":"Atributo contendo o identificador do usuário",
 "samlIDPMetaDataOptionsURL":"Metadata URL",
+"samlIDPMetaDataOptionsUserAttribute":"Atributo contendo o identificador do usuário",
 "samlIDPMetaDataXML":"Metadados",
 "samlIDPName":"Nome do IDP SAML",
 "samlIDPSSODescriptor":"Provedor de Identidade",
@@ -1329,6 +1349,15 @@
 "soapServices":"Serviços SOAP",
 "soapSessionServer":"Servidor de sessão",
 "specialRule":"Regra especial",
+"sshCa":"SSH CA",
+"sshCaActivation":"Activation",
+"sshCaCertDefaultValidity":"Default validity (minutes)",
+"sshCaCertMaxValidity":"Maximum validity (minutes)",
+"sshCaKeyRef":"CA key reference",
+"sshCaKeyType":"CA key type",
+"sshCaKrlPath":"KRL file path",
+"sshCaPrincipalSources":"Principal sources",
+"sshCaSerialPath":"Serial file path",
 "sslByAjax":"Use requisição AJAX",
 "sslHost":"Ajax mTLS URL",
 "sslParams":"mTLS parameters",
diff --git a/lemonldap-ng-manager/site/htdocs/static/languages/ru.json b/lemonldap-ng-manager/site/htdocs/static/languages/ru.json
index 035797a5b..a31f11f63 100644
--- a/lemonldap-ng-manager/site/htdocs/static/languages/ru.json
+++ b/lemonldap-ng-manager/site/htdocs/static/languages/ru.json
@@ -778,6 +778,7 @@
 "oidcRPMetaDataOptionsAdditionalAudiences":"Дополнительные аудитории",
 "oidcRPMetaDataOptionsAdvanced":"Расширенные",
 "oidcRPMetaDataOptionsAllowClientCredentialsGrant":"Разрешить предоставление учетных данных клиента OAuth2.0",
+"oidcRPMetaDataOptionsAllowDeviceAuthorizationGrant":"Allow Device Authorization Grant",
 "oidcRPMetaDataOptionsAllowNativeSso":"Allow Native SSO for Mobile App",
 "oidcRPMetaDataOptionsAllowOffline":"Разрешить автономный доступ",
 "oidcRPMetaDataOptionsAllowPasswordGrant":"Разрешить предоставление пароля OAuth2.0",
@@ -841,6 +842,9 @@
 "oidcServiceAllowOffline":"Разрешить автономный доступ",
 "oidcServiceAllowOnlyDeclaredScopes":"Разрешить только объявленные области",
 "oidcServiceAuthorizationCodeExpiration":"Коды авторизации",
+"oidcServiceDeviceAuthorizationExpiration":"Device code expiration",
+"oidcServiceDeviceAuthorizationPollingInterval":"Polling interval",
+"oidcServiceDeviceAuthorizationUserCodeLength":"User code length",
 "oidcServiceDynamicRegistration":"Динамическая регистрация",
 "oidcServiceDynamicRegistrationExportedVars":"Экспортированные переменные",
 "oidcServiceDynamicRegistrationExtraClaims":"Дополнительные требования",
@@ -861,6 +865,7 @@
 "oidcServiceMetaDataAuthorizeURI":"Авторизация",
 "oidcServiceMetaDataBackChannelURI":"URI обратного канала",
 "oidcServiceMetaDataCheckSessionURI":"Проверить сеанс",
+"oidcServiceMetaDataDeviceAuthorization":"Device Authorization (RFC 8628)",
 "oidcServiceMetaDataDisallowNoneAlg":"Disallow \"none\" algorithm for signature",
 "oidcServiceMetaDataEncKeys":"Encryption keys",
 "oidcServiceMetaDataEndPoints":"Конечные точки",
@@ -931,6 +936,20 @@
 "openIdSreg_timezone":"Часовой пояс",
 "openidParams":"Параметры OpenID",
 "overPrm":"Перегруженные параметры",
+"pamAccess":"PAM Access",
+"pamAccessActivation":"Activation",
+"pamAccessAuthzRules":"Authorization rules",
+"pamAccessExportedVars":"Exported variables",
+"pamAccessHeartbeatInterval":"Heartbeat interval",
+"pamAccessHeartbeatRequired":"Require heartbeat",
+"pamAccessInactiveThreshold":"Inactive threshold",
+"pamAccessMaxDuration":"Maximum token duration",
+"pamAccessRp":"OIDC Relying Party",
+"pamAccessRule":"Authorization rule",
+"pamAccessServerGroups":"Server groups",
+"pamAccessSshRules":"SSH rules",
+"pamAccessSudoRules":"Sudo rules",
+"pamAccessTokenDuration":"Default token duration",
 "pamAuthnLevel":"Уровень аутентификации",
 "pamParams":"Параметры PAM",
 "pamService":"Сервис PAM",
@@ -981,6 +1000,7 @@
 "portalDisplayOfflineTokens":"Display offline session tab",
 "portalDisplayOidcConsents":"Соглашения OIDC",
 "portalDisplayOrder":"Отобразить порядок",
+"portalDisplayPamAccess":"Display PAM Access",
 "portalDisplayPasswordPolicy":"Отобразить политику в виде пароля",
 "portalDisplayRefreshMyRights":"Отобразить ссылку на обновление прав",
 "portalDisplayRegister":"Зарегистрировать новый аккаунт",
@@ -1179,8 +1199,8 @@
 "samlIDPMetaDataOptionsSortNumber":"Порядок",
 "samlIDPMetaDataOptionsStoreSAMLToken":"Хранить токен SAML",
 "samlIDPMetaDataOptionsTooltip":"Подсказка",
-"samlIDPMetaDataOptionsUserAttribute":"Атрибут, содержащий идентификатор пользователя",
 "samlIDPMetaDataOptionsURL":"Metadata URL",
+"samlIDPMetaDataOptionsUserAttribute":"Атрибут, содержащий идентификатор пользователя",
 "samlIDPMetaDataXML":"Метаданные",
 "samlIDPName":"Имя SAML IDP",
 "samlIDPSSODescriptor":"Поставщик удостоверений",
@@ -1329,6 +1349,15 @@
 "soapServices":"Службы SOAP",
 "soapSessionServer":"Сервер сеансов",
 "specialRule":"Особое правило",
+"sshCa":"SSH CA",
+"sshCaActivation":"Activation",
+"sshCaCertDefaultValidity":"Default validity (minutes)",
+"sshCaCertMaxValidity":"Maximum validity (minutes)",
+"sshCaKeyRef":"CA key reference",
+"sshCaKeyType":"CA key type",
+"sshCaKrlPath":"KRL file path",
+"sshCaPrincipalSources":"Principal sources",
+"sshCaSerialPath":"Serial file path",
 "sslByAjax":"Использовать запрос Ajax",
 "sslHost":"Ajax mTLS URL",
 "sslParams":"mTLS parameters",
diff --git a/lemonldap-ng-manager/site/htdocs/static/languages/tr.json b/lemonldap-ng-manager/site/htdocs/static/languages/tr.json
index 523cad0b4..0f9294a3e 100644
--- a/lemonldap-ng-manager/site/htdocs/static/languages/tr.json
+++ b/lemonldap-ng-manager/site/htdocs/static/languages/tr.json
@@ -778,6 +778,7 @@
 "oidcRPMetaDataOptionsAdditionalAudiences":"Ek hedef kitleler",
 "oidcRPMetaDataOptionsAdvanced":"Gelişmiş",
 "oidcRPMetaDataOptionsAllowClientCredentialsGrant":"OAuth2.0 Client Credentials Grant İzin Ver",
+"oidcRPMetaDataOptionsAllowDeviceAuthorizationGrant":"Allow Device Authorization Grant",
 "oidcRPMetaDataOptionsAllowNativeSso":"Allow Native SSO for Mobile App",
 "oidcRPMetaDataOptionsAllowOffline":"Çevrimdışı erişime izin ver",
 "oidcRPMetaDataOptionsAllowPasswordGrant":"OAuth2.0 Password Grant İzin Ver",
@@ -841,6 +842,9 @@
 "oidcServiceAllowOffline":"Çevrimdışı erişime izin ver",
 "oidcServiceAllowOnlyDeclaredScopes":"Sadece belirli kapsamlara izin ver",
 "oidcServiceAuthorizationCodeExpiration":"Yetkilendirme Kodları",
+"oidcServiceDeviceAuthorizationExpiration":"Device code expiration",
+"oidcServiceDeviceAuthorizationPollingInterval":"Polling interval",
+"oidcServiceDeviceAuthorizationUserCodeLength":"User code length",
 "oidcServiceDynamicRegistration":"Dinamik kayıtlanma",
 "oidcServiceDynamicRegistrationExportedVars":"Dışa aktarılan değişkenler",
 "oidcServiceDynamicRegistrationExtraClaims":"Ekstra haklar",
@@ -861,6 +865,7 @@
 "oidcServiceMetaDataAuthorizeURI":"Yetkilendirme",
 "oidcServiceMetaDataBackChannelURI":"Arka-Kanal URI",
 "oidcServiceMetaDataCheckSessionURI":"Oturumu Kontrol Et",
+"oidcServiceMetaDataDeviceAuthorization":"Device Authorization (RFC 8628)",
 "oidcServiceMetaDataDisallowNoneAlg":"Disallow \"none\" algorithm for signature",
 "oidcServiceMetaDataEncKeys":"Encryption keys",
 "oidcServiceMetaDataEndPoints":"Uç noktalar",
@@ -931,6 +936,20 @@
 "openIdSreg_timezone":"Zaman dilimi",
 "openidParams":"OpenID parametreleri",
 "overPrm":"Aşırı yüklenmiş parametreler",
+"pamAccess":"PAM Access",
+"pamAccessActivation":"Activation",
+"pamAccessAuthzRules":"Authorization rules",
+"pamAccessExportedVars":"Exported variables",
+"pamAccessHeartbeatInterval":"Heartbeat interval",
+"pamAccessHeartbeatRequired":"Require heartbeat",
+"pamAccessInactiveThreshold":"Inactive threshold",
+"pamAccessMaxDuration":"Maximum token duration",
+"pamAccessRp":"OIDC Relying Party",
+"pamAccessRule":"Authorization rule",
+"pamAccessServerGroups":"Server groups",
+"pamAccessSshRules":"SSH rules",
+"pamAccessSudoRules":"Sudo rules",
+"pamAccessTokenDuration":"Default token duration",
 "pamAuthnLevel":"Doğrulama seviyesi",
 "pamParams":"PAM parametreleri",
 "pamService":"PAM Servisi",
@@ -981,6 +1000,7 @@
 "portalDisplayOfflineTokens":"Display offline session tab",
 "portalDisplayOidcConsents":"OIDC izinleri",
 "portalDisplayOrder":"Görüntüleme sırası",
+"portalDisplayPamAccess":"Display PAM Access",
 "portalDisplayPasswordPolicy":"Politikayı parola form alanında görüntüle",
 "portalDisplayRefreshMyRights":"Görüntüleme hakları yenileme bağlantısı",
 "portalDisplayRegister":"Yeni hesap kaydet",
@@ -1179,8 +1199,8 @@
 "samlIDPMetaDataOptionsSortNumber":"Sıra",
 "samlIDPMetaDataOptionsStoreSAMLToken":"SAML Token'ı sakla",
 "samlIDPMetaDataOptionsTooltip":"Araç ipucu",
-"samlIDPMetaDataOptionsUserAttribute":"Nitelik kullanıcı kimliği içeriyor",
 "samlIDPMetaDataOptionsURL":"Metadata URL",
+"samlIDPMetaDataOptionsUserAttribute":"Nitelik kullanıcı kimliği içeriyor",
 "samlIDPMetaDataXML":"Üst veri",
 "samlIDPName":"SAML IDP Adı",
 "samlIDPSSODescriptor":"Kimlik Sağlayıcısı",
@@ -1329,6 +1349,15 @@
 "soapServices":"SOAP servisleri",
 "soapSessionServer":"Oturum sunucusu",
 "specialRule":"Özel kural",
+"sshCa":"SSH CA",
+"sshCaActivation":"Activation",
+"sshCaCertDefaultValidity":"Default validity (minutes)",
+"sshCaCertMaxValidity":"Maximum validity (minutes)",
+"sshCaKeyRef":"CA key reference",
+"sshCaKeyType":"CA key type",
+"sshCaKrlPath":"KRL file path",
+"sshCaPrincipalSources":"Principal sources",
+"sshCaSerialPath":"Serial file path",
 "sslByAjax":"Ajax isteği kullan",
 "sslHost":"Ajax mTLS URL",
 "sslParams":"mTLS parameters",
diff --git a/lemonldap-ng-manager/site/htdocs/static/languages/vi.json b/lemonldap-ng-manager/site/htdocs/static/languages/vi.json
index 2487ca11f..fdf419229 100644
--- a/lemonldap-ng-manager/site/htdocs/static/languages/vi.json
+++ b/lemonldap-ng-manager/site/htdocs/static/languages/vi.json
@@ -778,6 +778,7 @@
 "oidcRPMetaDataOptionsAdditionalAudiences":"Đối tượng bổ sung",
 "oidcRPMetaDataOptionsAdvanced":"Nâng cao",
 "oidcRPMetaDataOptionsAllowClientCredentialsGrant":"Cho phép cấp thông tin xác thực ứng dụng khách OAuth2.0",
+"oidcRPMetaDataOptionsAllowDeviceAuthorizationGrant":"Allow Device Authorization Grant",
 "oidcRPMetaDataOptionsAllowNativeSso":"Allow Native SSO for Mobile App",
 "oidcRPMetaDataOptionsAllowOffline":"Cho phép truy cập ngoại tuyến",
 "oidcRPMetaDataOptionsAllowPasswordGrant":"Cho phép cấp mật khẩu OAuth2.0",
@@ -841,6 +842,9 @@
 "oidcServiceAllowOffline":"Cho phép truy cập ngoại tuyến",
 "oidcServiceAllowOnlyDeclaredScopes":"Chỉ cho phép phạm vi khai báo",
 "oidcServiceAuthorizationCodeExpiration":"Mã ủy quyền",
+"oidcServiceDeviceAuthorizationExpiration":"Device code expiration",
+"oidcServiceDeviceAuthorizationPollingInterval":"Polling interval",
+"oidcServiceDeviceAuthorizationUserCodeLength":"User code length",
 "oidcServiceDynamicRegistration":"đăng ký động",
 "oidcServiceDynamicRegistrationExportedVars":"Exported vars",
 "oidcServiceDynamicRegistrationExtraClaims":"Xác nhận bổ sung",
@@ -861,6 +865,7 @@
 "oidcServiceMetaDataAuthorizeURI":"Uỷ quyền",
 "oidcServiceMetaDataBackChannelURI":"URI kênh sau",
 "oidcServiceMetaDataCheckSessionURI":"Kiểm tra phiên",
+"oidcServiceMetaDataDeviceAuthorization":"Device Authorization (RFC 8628)",
 "oidcServiceMetaDataDisallowNoneAlg":"Disallow \"none\" algorithm for signature",
 "oidcServiceMetaDataEncKeys":"Encryption keys",
 "oidcServiceMetaDataEndPoints":"Endpoints",
@@ -931,6 +936,20 @@
 "openIdSreg_timezone":"Múi giờ",
 "openidParams":"Tham số OpenID",
 "overPrm":"Thông số quá tải",
+"pamAccess":"PAM Access",
+"pamAccessActivation":"Activation",
+"pamAccessAuthzRules":"Authorization rules",
+"pamAccessExportedVars":"Exported variables",
+"pamAccessHeartbeatInterval":"Heartbeat interval",
+"pamAccessHeartbeatRequired":"Require heartbeat",
+"pamAccessInactiveThreshold":"Inactive threshold",
+"pamAccessMaxDuration":"Maximum token duration",
+"pamAccessRp":"OIDC Relying Party",
+"pamAccessRule":"Authorization rule",
+"pamAccessServerGroups":"Server groups",
+"pamAccessSshRules":"SSH rules",
+"pamAccessSudoRules":"Sudo rules",
+"pamAccessTokenDuration":"Default token duration",
 "pamAuthnLevel":"Mức xác thực",
 "pamParams":"Tham số PAM",
 "pamService":"Dịch vụ PAM",
@@ -981,6 +1000,7 @@
 "portalDisplayOfflineTokens":"Display offline session tab",
 "portalDisplayOidcConsents":"Những sự chấp thuận OIDC",
 "portalDisplayOrder":"Thứ tự hiển thị",
+"portalDisplayPamAccess":"Display PAM Access",
 "portalDisplayPasswordPolicy":"Hiển thị chính sách trong biểu mẫu mật khẩu",
 "portalDisplayRefreshMyRights":"hiển thị liên kết làm mới quyền",
 "portalDisplayRegister":"Đăng ký tài khoản mới",
@@ -1179,8 +1199,8 @@
 "samlIDPMetaDataOptionsSortNumber":"Order",
 "samlIDPMetaDataOptionsStoreSAMLToken":"Lưu trữ token SAML",
 "samlIDPMetaDataOptionsTooltip":"Chú giải ",
-"samlIDPMetaDataOptionsUserAttribute":"Thuộc tính chứa định danh người dùng",
 "samlIDPMetaDataOptionsURL":"Metadata URL",
+"samlIDPMetaDataOptionsUserAttribute":"Thuộc tính chứa định danh người dùng",
 "samlIDPMetaDataXML":"Mô-tả dữ liệu",
 "samlIDPName":"Tên SAML IDP ",
 "samlIDPSSODescriptor":"Bộ cung cấp Nhận dạng",
@@ -1329,6 +1349,15 @@
 "soapServices":"dịch vụ SOAP",
 "soapSessionServer":"máy chủ phiên",
 "specialRule":"Quy tắc đặc biệt",
+"sshCa":"SSH CA",
+"sshCaActivation":"Activation",
+"sshCaCertDefaultValidity":"Default validity (minutes)",
+"sshCaCertMaxValidity":"Maximum validity (minutes)",
+"sshCaKeyRef":"CA key reference",
+"sshCaKeyType":"CA key type",
+"sshCaKrlPath":"KRL file path",
+"sshCaPrincipalSources":"Principal sources",
+"sshCaSerialPath":"Serial file path",
 "sslByAjax":"Sử dụng yêu cầu Ajax",
 "sslHost":"Ajax mTLS URL",
 "sslParams":"mTLS parameters",
diff --git a/lemonldap-ng-manager/site/htdocs/static/languages/zh.json b/lemonldap-ng-manager/site/htdocs/static/languages/zh.json
index c5543eee0..bb00c2bd6 100644
--- a/lemonldap-ng-manager/site/htdocs/static/languages/zh.json
+++ b/lemonldap-ng-manager/site/htdocs/static/languages/zh.json
@@ -778,6 +778,7 @@
 "oidcRPMetaDataOptionsAdditionalAudiences":"額外聽眾",
 "oidcRPMetaDataOptionsAdvanced":"進階",
 "oidcRPMetaDataOptionsAllowClientCredentialsGrant":"Allow OAuth2.0 Client Credentials Grant",
+"oidcRPMetaDataOptionsAllowDeviceAuthorizationGrant":"Allow Device Authorization Grant",
 "oidcRPMetaDataOptionsAllowNativeSso":"Allow Native SSO for Mobile App",
 "oidcRPMetaDataOptionsAllowOffline":"允許離線存取",
 "oidcRPMetaDataOptionsAllowPasswordGrant":"允許 OAuth2.0 密碼授權",
@@ -841,6 +842,9 @@
 "oidcServiceAllowOffline":"允許離線存取",
 "oidcServiceAllowOnlyDeclaredScopes":"Only allow declared scopes",
 "oidcServiceAuthorizationCodeExpiration":"Authorization Codes",
+"oidcServiceDeviceAuthorizationExpiration":"Device code expiration",
+"oidcServiceDeviceAuthorizationPollingInterval":"Polling interval",
+"oidcServiceDeviceAuthorizationUserCodeLength":"User code length",
 "oidcServiceDynamicRegistration":"Dynamic registration",
 "oidcServiceDynamicRegistrationExportedVars":"Exported vars",
 "oidcServiceDynamicRegistrationExtraClaims":"額外的聲明",
@@ -861,6 +865,7 @@
 "oidcServiceMetaDataAuthorizeURI":"授權",
 "oidcServiceMetaDataBackChannelURI":"反向頻道 URI",
 "oidcServiceMetaDataCheckSessionURI":"檢查工作階段",
+"oidcServiceMetaDataDeviceAuthorization":"Device Authorization (RFC 8628)",
 "oidcServiceMetaDataDisallowNoneAlg":"Disallow \"none\" algorithm for signature",
 "oidcServiceMetaDataEncKeys":"Encryption keys",
 "oidcServiceMetaDataEndPoints":"Endpoints",
@@ -931,6 +936,20 @@
 "openIdSreg_timezone":"時區",
 "openidParams":"OpenID 參數",
 "overPrm":"超載參數",
+"pamAccess":"PAM Access",
+"pamAccessActivation":"Activation",
+"pamAccessAuthzRules":"Authorization rules",
+"pamAccessExportedVars":"Exported variables",
+"pamAccessHeartbeatInterval":"Heartbeat interval",
+"pamAccessHeartbeatRequired":"Require heartbeat",
+"pamAccessInactiveThreshold":"Inactive threshold",
+"pamAccessMaxDuration":"Maximum token duration",
+"pamAccessRp":"OIDC Relying Party",
+"pamAccessRule":"Authorization rule",
+"pamAccessServerGroups":"Server groups",
+"pamAccessSshRules":"SSH rules",
+"pamAccessSudoRules":"Sudo rules",
+"pamAccessTokenDuration":"Default token duration",
 "pamAuthnLevel":"驗證等級",
 "pamParams":"PAM 參數",
 "pamService":"PAM 服務",
@@ -981,6 +1000,7 @@
 "portalDisplayOfflineTokens":"Display offline session tab",
 "portalDisplayOidcConsents":"OIDC 同意",
 "portalDisplayOrder":"Display order",
+"portalDisplayPamAccess":"Display PAM Access",
 "portalDisplayPasswordPolicy":"在密碼表單中顯示策略",
 "portalDisplayRefreshMyRights":"顯示權限重新整理連結",
 "portalDisplayRegister":"註冊新帳號",
@@ -1179,8 +1199,8 @@
 "samlIDPMetaDataOptionsSortNumber":"順序",
 "samlIDPMetaDataOptionsStoreSAMLToken":"儲存 SAML 權杖",
 "samlIDPMetaDataOptionsTooltip":"工具提示",
-"samlIDPMetaDataOptionsUserAttribute":"包含使用者識別符號的屬性",
 "samlIDPMetaDataOptionsURL":"Metadata URL",
+"samlIDPMetaDataOptionsUserAttribute":"包含使用者識別符號的屬性",
 "samlIDPMetaDataXML":"詮釋資料",
 "samlIDPName":"SAML IDP 名稱",
 "samlIDPSSODescriptor":"身份提供者",
@@ -1329,6 +1349,15 @@
 "soapServices":"SOAP 服務",
 "soapSessionServer":"Session server",
 "specialRule":"特殊規則",
+"sshCa":"SSH CA",
+"sshCaActivation":"Activation",
+"sshCaCertDefaultValidity":"Default validity (minutes)",
+"sshCaCertMaxValidity":"Maximum validity (minutes)",
+"sshCaKeyRef":"CA key reference",
+"sshCaKeyType":"CA key type",
+"sshCaKrlPath":"KRL file path",
+"sshCaPrincipalSources":"Principal sources",
+"sshCaSerialPath":"Serial file path",
 "sslByAjax":"使用 Ajax 請求",
 "sslHost":"Ajax mTLS URL",
 "sslParams":"mTLS parameters",
diff --git a/lemonldap-ng-manager/site/htdocs/static/languages/zh_TW.json b/lemonldap-ng-manager/site/htdocs/static/languages/zh_TW.json
index 50a35c356..57658e324 100644
--- a/lemonldap-ng-manager/site/htdocs/static/languages/zh_TW.json
+++ b/lemonldap-ng-manager/site/htdocs/static/languages/zh_TW.json
@@ -778,6 +778,7 @@
 "oidcRPMetaDataOptionsAdditionalAudiences":"額外聽眾",
 "oidcRPMetaDataOptionsAdvanced":"進階",
 "oidcRPMetaDataOptionsAllowClientCredentialsGrant":"Allow OAuth2.0 Client Credentials Grant",
+"oidcRPMetaDataOptionsAllowDeviceAuthorizationGrant":"Allow Device Authorization Grant",
 "oidcRPMetaDataOptionsAllowNativeSso":"Allow Native SSO for Mobile App",
 "oidcRPMetaDataOptionsAllowOffline":"允許離線存取",
 "oidcRPMetaDataOptionsAllowPasswordGrant":"允許 OAuth2.0 密碼授權",
@@ -841,6 +842,9 @@
 "oidcServiceAllowOffline":"允許離線存取",
 "oidcServiceAllowOnlyDeclaredScopes":"Only allow declared scopes",
 "oidcServiceAuthorizationCodeExpiration":"Authorization Codes",
+"oidcServiceDeviceAuthorizationExpiration":"Device code expiration",
+"oidcServiceDeviceAuthorizationPollingInterval":"Polling interval",
+"oidcServiceDeviceAuthorizationUserCodeLength":"User code length",
 "oidcServiceDynamicRegistration":"Dynamic registration",
 "oidcServiceDynamicRegistrationExportedVars":"Exported vars",
 "oidcServiceDynamicRegistrationExtraClaims":"額外的聲明",
@@ -861,6 +865,7 @@
 "oidcServiceMetaDataAuthorizeURI":"授權",
 "oidcServiceMetaDataBackChannelURI":"反向頻道 URI",
 "oidcServiceMetaDataCheckSessionURI":"檢查工作階段",
+"oidcServiceMetaDataDeviceAuthorization":"Device Authorization (RFC 8628)",
 "oidcServiceMetaDataDisallowNoneAlg":"Disallow \"none\" algorithm for signature",
 "oidcServiceMetaDataEncKeys":"Encryption keys",
 "oidcServiceMetaDataEndPoints":"Endpoints",
@@ -931,6 +936,20 @@
 "openIdSreg_timezone":"時區",
 "openidParams":"OpenID 參數",
 "overPrm":"超載參數",
+"pamAccess":"PAM Access",
+"pamAccessActivation":"Activation",
+"pamAccessAuthzRules":"Authorization rules",
+"pamAccessExportedVars":"Exported variables",
+"pamAccessHeartbeatInterval":"Heartbeat interval",
+"pamAccessHeartbeatRequired":"Require heartbeat",
+"pamAccessInactiveThreshold":"Inactive threshold",
+"pamAccessMaxDuration":"Maximum token duration",
+"pamAccessRp":"OIDC Relying Party",
+"pamAccessRule":"Authorization rule",
+"pamAccessServerGroups":"Server groups",
+"pamAccessSshRules":"SSH rules",
+"pamAccessSudoRules":"Sudo rules",
+"pamAccessTokenDuration":"Default token duration",
 "pamAuthnLevel":"驗證等級",
 "pamParams":"PAM 參數",
 "pamService":"PAM 服務",
@@ -981,6 +1000,7 @@
 "portalDisplayOfflineTokens":"Display offline session tab",
 "portalDisplayOidcConsents":"OIDC 同意",
 "portalDisplayOrder":"Display order",
+"portalDisplayPamAccess":"Display PAM Access",
 "portalDisplayPasswordPolicy":"在密碼表單中顯示策略",
 "portalDisplayRefreshMyRights":"顯示權限重新整理連結",
 "portalDisplayRegister":"註冊新帳號",
@@ -1179,8 +1199,8 @@
 "samlIDPMetaDataOptionsSortNumber":"順序",
 "samlIDPMetaDataOptionsStoreSAMLToken":"儲存 SAML 權杖",
 "samlIDPMetaDataOptionsTooltip":"工具提示",
-"samlIDPMetaDataOptionsUserAttribute":"包含使用者識別符號的屬性",
 "samlIDPMetaDataOptionsURL":"Metadata URL",
+"samlIDPMetaDataOptionsUserAttribute":"包含使用者識別符號的屬性",
 "samlIDPMetaDataXML":"詮釋資料",
 "samlIDPName":"SAML IDP 名稱",
 "samlIDPSSODescriptor":"身份提供者",
@@ -1329,6 +1349,15 @@
 "soapServices":"SOAP 服務",
 "soapSessionServer":"Session server",
 "specialRule":"特殊規則",
+"sshCa":"SSH CA",
+"sshCaActivation":"Activation",
+"sshCaCertDefaultValidity":"Default validity (minutes)",
+"sshCaCertMaxValidity":"Maximum validity (minutes)",
+"sshCaKeyRef":"CA key reference",
+"sshCaKeyType":"CA key type",
+"sshCaKrlPath":"KRL file path",
+"sshCaPrincipalSources":"Principal sources",
+"sshCaSerialPath":"Serial file path",
 "sslByAjax":"使用 Ajax 請求",
 "sslHost":"Ajax mTLS URL",
 "sslParams":"mTLS parameters",
diff --git a/lemonldap-ng-portal/lib/Lemonldap/NG/Portal/Issuer/OpenIDConnect.pm b/lemonldap-ng-portal/lib/Lemonldap/NG/Portal/Issuer/OpenIDConnect.pm
index ed6dc0351..9a3e70e4f 100644
--- a/lemonldap-ng-portal/lib/Lemonldap/NG/Portal/Issuer/OpenIDConnect.pm
+++ b/lemonldap-ng-portal/lib/Lemonldap/NG/Portal/Issuer/OpenIDConnect.pm
@@ -1546,6 +1546,13 @@ sub token {
         return $self->_handleTokenExchange( $req, $rp );
     }
 
+    # Device Authorization Grant (RFC 8628)
+    elsif ( $grant_type eq 'urn:ietf:params:oauth:grant-type:device_code' ) {
+        my $h = $self->p->processHook( $req, 'oidcGotDeviceCodeGrant', $rp );
+        return $req->response if ( $h == PE_SENDRESPONSE );
+        return $self->sendOIDCError( $req, 'unsupported_grant_type', 400 );
+    }
+
     # Unknown or unspecified grant type
     else {
         $self->userLogger->error(
diff --git a/lemonldap-ng-portal/lib/Lemonldap/NG/Portal/Main/Plugins.pm b/lemonldap-ng-portal/lib/Lemonldap/NG/Portal/Main/Plugins.pm
index 60ce30294..b95c47e1d 100644
--- a/lemonldap-ng-portal/lib/Lemonldap/NG/Portal/Main/Plugins.pm
+++ b/lemonldap-ng-portal/lib/Lemonldap/NG/Portal/Main/Plugins.pm
@@ -41,6 +41,7 @@ our @pList = (
     checkEntropy                        => '::Plugins::CheckEntropy',
     initializePasswordReset             => '::Plugins::InitializePasswordReset',
     oidcOfflineTokens                   => '::Plugins::OidcOfflineTokens',
+    pamAccessActivation                 => '::Plugins::PamAccess',
     adaptativeAuthenticationLevelRules  =>
       '::Plugins::AdaptativeAuthenticationLevel',
     refreshSessions         => '::Plugins::Refresh',
@@ -56,6 +57,8 @@ our @pList = (
       '::Plugins::AuthOidcPkce',
     'or::oidcRPMetaDataOptions/*/oidcRPMetaDataOptionsTokenXAuthorizedRP' =>
       '::Plugins::OIDCInternalTokenExchange',
+    'or::oidcRPMetaDataOptions/*/oidcRPMetaDataOptionsAllowDeviceAuthorizationGrant' =>
+      '::Plugins::OIDCDeviceAuthorization',
 );
 
 ##@method list enabledPlugins
diff --git a/lemonldap-ng-portal/lib/Lemonldap/NG/Portal/Plugins/OIDCDeviceAuthorization.pm b/lemonldap-ng-portal/lib/Lemonldap/NG/Portal/Plugins/OIDCDeviceAuthorization.pm
new file mode 100644
index 000000000..7c4e998e1
--- /dev/null
+++ b/lemonldap-ng-portal/lib/Lemonldap/NG/Portal/Plugins/OIDCDeviceAuthorization.pm
@@ -0,0 +1,648 @@
+package Lemonldap::NG::Portal::Plugins::OIDCDeviceAuthorization;
+
+# OAuth 2.0 Device Authorization Grant - RFC 8628
+# https://datatracker.ietf.org/doc/html/rfc8628
+
+use strict;
+use Mouse;
+use Lemonldap::NG::Portal::Main::Constants qw(
+  PE_ERROR
+  PE_SENDRESPONSE
+);
+use Crypt::URandom;
+use Digest::SHA qw(sha256_hex);
+
+our $VERSION = '2.23.0';
+
+extends qw(
+  Lemonldap::NG::Portal::Main::Plugin
+);
+
+# Hooks declaration - following OIDCNativeSso pattern
+use constant hook => {
+
+    # Hook called by OpenIDConnect.pm token method for device_code grant
+    oidcGotDeviceCodeGrant => 'deviceCodeGrantHook',
+};
+
+# Character set for user_code (RFC 8628 section 6.1)
+# Excludes vowels to avoid offensive words, excludes 0/O, 1/I/L for readability
+use constant USER_CODE_CHARS => 'BCDFGHJKLMNPQRSTVWXZ23456789';
+
+# Session kind for device authorization storage
+use constant sessionKind => 'DEVA';
+
+# Lazy access to OIDC issuer - following OIDCNativeSso pattern
+has oidc => (
+    is      => 'ro',
+    lazy    => 1,
+    default => sub {
+        $_[0]
+          ->p->loadedModules->{'Lemonldap::NG::Portal::Issuer::OpenIDConnect'};
+    }
+);
+
+has rule => (
+    is      => 'rw',
+    default => sub {
+        sub { 1 }
+    }
+);
+
+# INITIALIZATION
+
+sub init {
+    my ($self) = @_;
+
+    # Check if OIDC issuer is enabled
+    unless ( $self->conf->{issuerDBOpenIDConnectActivation} ) {
+        $self->logger->error(
+            "OIDC issuer not enabled, Device Authorization plugin disabled");
+        return 0;
+    }
+
+    # Parse activation rule
+    if ( my $rule = $self->conf->{deviceAuthorizationRule} ) {
+        $self->rule( $self->p->buildRule( $rule, 'deviceAuthorizationRule' ) );
+        return 0 unless $self->rule;
+    }
+
+    # Device Authorization endpoint (RFC 8628 section 3.1)
+    # POST /oauth2/device - for devices to request authorization
+    my $oidc_path = $self->conf->{issuerDBOpenIDConnectPath} || '^/oauth2/';
+    $oidc_path =~ s/^.*?(\w+).*?$/$1/;    # Extract path name (e.g., "oauth2")
+    $self->addUnauthRoute(
+        $oidc_path => { 'device' => 'deviceAuthorizationEndpoint' },
+        ['POST']
+    );
+
+    # Device verification endpoint (for users) - /device
+    $self->addAuthRouteWithRedirect(
+        device => 'displayVerification',
+        ['GET']
+    );
+    $self->addAuthRoute(
+        device => 'submitVerification',
+        ['POST']
+    );
+
+    $self->logger->debug("Device Authorization Grant (RFC 8628) enabled");
+    return 1;
+}
+
+# Device Authorization endpoint (RFC 8628 section 3.1)
+# Called directly via route POST /oauth2/device
+sub deviceAuthorizationEndpoint {
+    my ( $self, $req ) = @_;
+
+    $self->logger->debug("Device Authorization endpoint called");
+
+    my $client_id = $req->param('client_id');
+
+    unless ($client_id) {
+        $self->logger->error(
+            "Missing client_id in device authorization request");
+        return $self->_sendDeviceError( $req, 'invalid_request',
+            'client_id is required' );
+    }
+
+    # Get RP from client_id
+    my $rp = $self->oidc->getRP($client_id);
+
+    unless ($rp) {
+        $self->logger->warn("Unknown client_id: $client_id");
+        return $self->_sendDeviceError( $req, 'invalid_client' );
+    }
+
+    # Check if this RP allows device authorization grant
+    unless ( $self->oidc->rpOptions->{$rp}
+        ->{oidcRPMetaDataOptionsAllowDeviceAuthorizationGrant} )
+    {
+        $self->logger->warn(
+            "Device authorization grant not allowed for RP $rp");
+        return $self->_sendDeviceError( $req, 'unauthorized_client' );
+    }
+
+    # Get requested scope
+    my $scope = $req->param('scope') || 'openid';
+
+    # Generate device_code (secret, used for polling)
+    my $device_code = $self->_generateDeviceCode();
+
+    # Generate user_code (shown to user)
+    my $user_code = $self->_generateUserCode();
+
+    # Store device authorization request
+    my $expiration =
+      $self->conf->{oidcServiceDeviceAuthorizationExpiration} || 600;
+    my $interval =
+      $self->conf->{oidcServiceDeviceAuthorizationPollingInterval} || 5;
+
+    # Create session with device_code hash as ID (for polling lookup)
+    my $device_code_hash = sha256_hex($device_code);
+
+    my $session_data = {
+        _type       => 'deviceauth',
+        _utime      => time() - $self->conf->{timeout} + $expiration,
+        device_code => $device_code,
+        user_code   => $user_code,
+        client_id   => $client_id,
+        rp          => $rp,
+        scope       => $scope,
+        status      => 'pending',              # pending, approved, denied
+        created_at  => time(),
+        expires_at  => time() + $expiration,
+    };
+
+    # Store the device authorization using getApacheSession with fixed ID
+    my $session = $self->p->getApacheSession(
+        $device_code_hash,
+        kind      => sessionKind,
+        info      => $session_data,
+        force     => 1,
+        hashStore => 0,
+    );
+
+    unless ( $session && $session->id ) {
+        $self->logger->error("Failed to create device authorization session");
+        return $self->_sendDeviceError( $req, 'server_error' );
+    }
+
+    # Also create a session indexed by user_code for verification lookup
+    my $user_code_hash    = sha256_hex($user_code);
+    my $user_code_session = $self->p->getApacheSession(
+        $user_code_hash,
+        kind => sessionKind,
+        info => {
+            _type            => 'deviceauth_usercode',
+            _utime           => time() - $self->conf->{timeout} + $expiration,
+            device_code_hash => $device_code_hash,
+            user_code        => $user_code,
+            expires_at       => time() + $expiration,
+        },
+        force     => 1,
+        hashStore => 0,
+    );
+
+    unless ( $user_code_session && $user_code_session->id ) {
+        $self->logger->error("Failed to create user_code lookup session");
+
+        # Clean up the device_code session
+        $session->remove;
+        return $self->_sendDeviceError( $req, 'server_error' );
+    }
+
+    # Build verification URI
+    my $portal           = $self->p->HANDLER->tsv->{portal}->();
+    my $verification_uri = "$portal/device";
+    my $formatted_code   = $self->_formatUserCode($user_code);
+    my $verification_uri_complete =
+      "$portal/device?user_code=" . ( $user_code =~ s/-//gr );
+
+    # RFC 8628 section 3.2 - Device Authorization Response
+    my $response = {
+        device_code               => $device_code,
+        user_code                 => $formatted_code,
+        verification_uri          => $verification_uri,
+        verification_uri_complete => $verification_uri_complete,
+        expires_in                => $expiration + 0,
+        interval                  => $interval + 0,
+    };
+
+    $self->logger->debug(
+        "Device authorization created: user_code=$user_code, client=$client_id"
+    );
+    $self->userLogger->info(
+        "Device authorization initiated for client $client_id");
+
+    return $self->p->sendJSONresponse( $req, $response );
+}
+
+# HOOK: Token endpoint handler for device_code grant
+# Called by OpenIDConnect.pm via processHook('oidcGotDeviceCodeGrant')
+sub deviceCodeGrantHook {
+    my ( $self, $req, $rp ) = @_;
+
+    $self->logger->debug("Device code grant hook called for RP $rp");
+
+    my $device_code = $req->param('device_code');
+    my $client_id   = $req->param('client_id')
+      || $self->oidc->rpOptions->{$rp}->{oidcRPMetaDataOptionsClientID};
+
+    unless ($device_code) {
+        return $self->_sendTokenError( $req, 'invalid_request',
+            'device_code is required' );
+    }
+
+    # Check if this RP allows device authorization grant
+    unless ( $self->oidc->rpOptions->{$rp}
+        ->{oidcRPMetaDataOptionsAllowDeviceAuthorizationGrant} )
+    {
+        $self->logger->warn(
+            "Device authorization grant not allowed for RP $rp");
+        return $self->_sendTokenError( $req, 'unauthorized_client' );
+    }
+
+    # Find the device authorization
+    my $device_auth = $self->_findByDeviceCode($device_code);
+
+    unless ($device_auth) {
+
+        # Token expired or invalid
+        return $self->_sendTokenError( $req, 'expired_token' );
+    }
+
+    # Verify RP matches
+    if ( $device_auth->{rp} ne $rp ) {
+        $self->logger->warn( "RP mismatch in device_code grant: expected "
+              . $device_auth->{rp}
+              . ", got $rp" );
+        return $self->_sendTokenError( $req, 'invalid_grant' );
+    }
+
+    # Check authorization status
+    my $status = $device_auth->{status} || 'pending';
+
+    if ( $status eq 'pending' ) {
+
+        # RFC 8628 section 3.5 - authorization_pending
+        return $self->_sendTokenError( $req, 'authorization_pending' );
+    }
+    elsif ( $status eq 'denied' ) {
+
+        # RFC 8628 section 3.5 - access_denied
+        $self->_deleteDeviceAuth($device_auth);
+        return $self->_sendTokenError( $req, 'access_denied' );
+    }
+    elsif ( $status eq 'approved' ) {
+
+        # Generate tokens!
+        return $self->_generateTokens( $req, $device_auth, $rp );
+    }
+    else {
+        $self->logger->error("Unknown device auth status: $status");
+        return $self->_sendTokenError( $req, 'server_error' );
+    }
+}
+
+# DEVICE VERIFICATION PAGE (for authenticated users)
+sub displayVerification {
+    my ( $self, $req ) = @_;
+
+    $self->logger->debug("Display device verification page");
+
+    # Check rule
+    unless ( $self->rule->( $req, $req->userData ) ) {
+        $self->userLogger->warn(
+            "User not allowed to verify device authorizations");
+        return $self->p->do( $req, [ sub { PE_ERROR } ] );
+    }
+
+    # Pre-fill user_code if provided in URL
+    my $user_code = $req->param('user_code') || '';
+    $user_code =~ s/[^A-Z0-9]//gi;    # Clean up
+
+    # Set template parameters
+    $req->data->{activeTimer} = 0;
+    $req->{user_code} = $user_code;
+
+    return $self->p->sendHtml(
+        $req, 'device',
+        params => {
+            USER_CODE => $user_code,
+            MSG       => '',
+        }
+    );
+}
+
+# DEVICE VERIFICATION SUBMIT
+sub submitVerification {
+    my ( $self, $req ) = @_;
+
+    $self->logger->debug("Device verification submitted");
+
+    # Check rule
+    unless ( $self->rule->( $req, $req->userData ) ) {
+        return $self->p->do( $req, [ sub { PE_ERROR } ] );
+    }
+
+    my $user_code = $req->param('user_code') || '';
+    $user_code =~ s/[^A-Z0-9]//gi;    # Remove formatting (dashes, spaces)
+    $user_code = uc($user_code);
+
+    unless ( $user_code && length($user_code) >= 6 ) {
+        return $self->_showVerificationError( $req, 'invalidUserCode' );
+    }
+
+    # Find the device authorization by user_code
+    my $device_auth = $self->_findByUserCode($user_code);
+    unless ($device_auth) {
+        $self->logger->info("Invalid or expired user_code: $user_code");
+        return $self->_showVerificationError( $req, 'invalidUserCode' );
+    }
+
+    # Check if already processed
+    if ( $device_auth->{status} ne 'pending' ) {
+        $self->logger->info("User code already processed: $user_code");
+        return $self->_showVerificationError( $req, 'codeAlreadyUsed' );
+    }
+
+    # Check action (approve or deny)
+    my $action = $req->param('action') || 'approve';
+
+    if ( $action eq 'deny' ) {
+
+        # User denied the authorization
+        $self->_updateDeviceAuthStatus( $device_auth, 'denied' );
+        $self->userLogger->notice( "Device authorization denied by user "
+              . $req->userData->{ $self->conf->{whatToTrace} }
+              . " for client "
+              . $device_auth->{client_id} );
+
+        return $self->p->sendHtml(
+            $req, 'device',
+            params => {
+                DEVICE_DENIED => 1,
+                MSG           => 'deviceDenied',
+            }
+        );
+    }
+
+    # Approve the authorization
+    # Store user info for token generation
+    my $user_session_id = $req->id || $req->userData->{_session_id};
+    $self->_updateDeviceAuthStatus(
+        $device_auth,
+        'approved',
+        {
+            user_session_id => $user_session_id,
+            user            => $req->userData->{ $self->conf->{whatToTrace} },
+            approved_at     => time(),
+        }
+    );
+
+    $self->userLogger->notice( "Device authorization approved by user "
+          . $req->userData->{ $self->conf->{whatToTrace} }
+          . " for client "
+          . $device_auth->{client_id} );
+
+    return $self->p->sendHtml(
+        $req, 'device',
+        params => {
+            DEVICE_APPROVED => 1,
+            CLIENT_ID       => $device_auth->{client_id},
+            SCOPE           => $device_auth->{scope},
+            MSG             => 'deviceApproved',
+        }
+    );
+}
+
+# PRIVATE METHODS
+
+sub _generateDeviceCode {
+    my ($self) = @_;
+
+    # 32 bytes of random data, hex encoded
+    return unpack( 'H*', Crypt::URandom::urandom(32) );
+}
+
+sub _generateUserCode {
+    my ($self) = @_;
+    my $length =
+      $self->conf->{oidcServiceDeviceAuthorizationUserCodeLength} || 8;
+    my $chars = USER_CODE_CHARS;
+    my $code  = '';
+    for ( 1 .. $length ) {
+        $code .= substr( $chars, int( rand( length($chars) ) ), 1 );
+    }
+    return $code;
+}
+
+sub _formatUserCode {
+    my ( $self, $code ) = @_;
+
+    # Format as XXXX-XXXX for readability
+    if ( length($code) == 8 ) {
+        return substr( $code, 0, 4 ) . '-' . substr( $code, 4, 4 );
+    }
+    return $code;
+}
+
+sub _findByUserCode {
+    my ( $self, $user_code ) = @_;
+
+    # Look up the user_code session to get the device_code_hash
+    my $user_code_hash = sha256_hex($user_code);
+
+    my $user_code_session =
+      $self->p->getApacheSession( $user_code_hash, kind => sessionKind, );
+
+    unless ( $user_code_session && $user_code_session->data ) {
+        $self->logger->debug("User code session not found: $user_code");
+        return undef;
+    }
+
+    # Check expiration
+    if ( time() > ( $user_code_session->data->{expires_at} || 0 ) ) {
+        $self->logger->debug("User code expired: $user_code");
+        $user_code_session->remove;
+        return undef;
+    }
+
+    my $device_code_hash = $user_code_session->data->{device_code_hash};
+    return $self->_getDeviceAuthByHash($device_code_hash);
+}
+
+sub _findByDeviceCode {
+    my ( $self, $device_code ) = @_;
+
+    my $device_code_hash = sha256_hex($device_code);
+    return $self->_getDeviceAuthByHash($device_code_hash);
+}
+
+sub _getDeviceAuthByHash {
+    my ( $self, $device_code_hash ) = @_;
+
+    my $session =
+      $self->p->getApacheSession( $device_code_hash, kind => sessionKind, );
+
+    unless ( $session && $session->data ) {
+        $self->logger->debug("Device auth session not found");
+        return undef;
+    }
+
+    # Check expiration
+    if ( time() > ( $session->data->{expires_at} || 0 ) ) {
+        $self->logger->debug("Device auth session expired");
+        $session->remove;
+        return undef;
+    }
+
+    # Return session data with session reference for updates
+    my $data = { %{ $session->data } };
+    $data->{_session}          = $session;
+    $data->{_device_code_hash} = $device_code_hash;
+
+    return $data;
+}
+
+sub _updateDeviceAuthStatus {
+    my ( $self, $device_auth, $status, $extra ) = @_;
+
+    my $session = $device_auth->{_session};
+    return unless $session;
+
+    # Update status
+    my $info = { status => $status };
+
+    # Add extra fields
+    if ($extra) {
+        for my $key ( keys %$extra ) {
+            $info->{$key} = $extra->{$key};
+        }
+    }
+
+    # Update session
+    $self->p->getApacheSession(
+        $session->id,
+        kind => sessionKind,
+        info => $info,
+    );
+}
+
+sub _deleteDeviceAuth {
+    my ( $self, $device_auth ) = @_;
+
+    # Delete the device_code session
+    if ( my $session = $device_auth->{_session} ) {
+        $session->remove;
+    }
+
+    # Also delete the user_code lookup session
+    if ( my $user_code = $device_auth->{user_code} ) {
+        my $user_code_hash = sha256_hex($user_code);
+        my $user_code_session =
+          $self->p->getApacheSession( $user_code_hash, kind => sessionKind, );
+        $user_code_session->remove if $user_code_session;
+    }
+}
+
+sub _generateTokens {
+    my ( $self, $req, $device_auth, $rp ) = @_;
+
+    my $scope = $device_auth->{scope};
+
+    # Get the user's session
+    my $user_session_id = $device_auth->{user_session_id};
+    my $session         = $self->p->getApacheSession($user_session_id);
+
+    unless ($session) {
+        $self->logger->error("User session not found for device authorization");
+        return $self->_sendTokenError( $req, 'server_error' );
+    }
+
+    # Generate access token
+    my $access_token = $self->oidc->newAccessToken(
+        $req, $rp, $scope,
+        $session->data,
+        {
+            scope           => $scope,
+            rp              => $rp,
+            user_session_id => $user_session_id,
+            grant_type      => "device_code",
+        }
+    );
+
+    unless ($access_token) {
+        $self->logger->error("Failed to create access token");
+        return $self->_sendTokenError( $req, 'server_error' );
+    }
+
+    my $expires_in =
+      $self->oidc->rpOptions->{$rp}
+      ->{oidcRPMetaDataOptionsAccessTokenExpiration}
+      || $self->conf->{oidcServiceAccessTokenExpiration}
+      || 3600;
+
+    my $response = {
+        access_token => "$access_token",
+        token_type   => 'Bearer',
+        expires_in   => $expires_in + 0,
+        scope        => $scope,
+    };
+
+    # Generate ID token if openid scope is requested
+    if ( $scope =~ /\bopenid\b/ ) {
+        my $id_token =
+          $self->oidc->_generateIDToken( $req, $rp, $scope, $session->data, 0 );
+        if ($id_token) {
+            $response->{id_token} = $id_token;
+        }
+    }
+
+    # Generate refresh token if allowed
+    if ( $self->oidc->rpOptions->{$rp}->{oidcRPMetaDataOptionsRefreshToken} ) {
+        my $refresh_token = $self->oidc->newRefreshToken(
+            $rp,
+            {
+                scope           => $scope,
+                client_id       => $device_auth->{client_id},
+                _session_uid    => $session->data->{_user},
+                auth_time       => $session->data->{_lastAuthnUTime},
+                grant_type      => "device_code",
+                user_session_id => $user_session_id,
+                %{ $session->data },
+            }
+        );
+
+        if ($refresh_token) {
+            $response->{refresh_token} = $refresh_token->id;
+        }
+    }
+
+    # Clean up the device authorization
+    $self->_deleteDeviceAuth($device_auth);
+
+    $self->logger->debug("Device code grant completed for RP $rp");
+
+    $req->response( $self->p->sendJSONresponse( $req, $response ) );
+    return PE_SENDRESPONSE;
+}
+
+sub _sendDeviceError {
+    my ( $self, $req, $error, $description ) = @_;
+
+    my $response = { error => $error };
+    $response->{error_description} = $description if $description;
+
+    # Return PSGI response directly (used by deviceAuthorizationEndpoint route)
+    return $self->p->sendJSONresponse( $req, $response, code => 400 );
+}
+
+sub _sendTokenError {
+    my ( $self, $req, $error, $description ) = @_;
+
+    my $response = { error => $error };
+    $response->{error_description} = $description if $description;
+
+    # authorization_pending and slow_down should return 400
+    # expired_token and access_denied should return 400
+    $req->response(
+        $self->p->sendJSONresponse( $req, $response, code => 400 ) );
+    return PE_SENDRESPONSE;
+}
+
+sub _showVerificationError {
+    my ( $self, $req, $msg ) = @_;
+
+    return $self->p->sendHtml(
+        $req, 'device',
+        params => {
+            USER_CODE => $req->param('user_code') || '',
+            MSG       => $msg,
+            ERROR     => 1,
+        }
+    );
+}
+
+1;
diff --git a/lemonldap-ng-portal/lib/Lemonldap/NG/Portal/Plugins/PamAccess.pm b/lemonldap-ng-portal/lib/Lemonldap/NG/Portal/Plugins/PamAccess.pm
new file mode 100644
index 000000000..f062fa186
--- /dev/null
+++ b/lemonldap-ng-portal/lib/Lemonldap/NG/Portal/Plugins/PamAccess.pm
@@ -0,0 +1,1519 @@
+# PAM Access plugin for LemonLDAP::NG
+#
+# This plugin provides:
+# - /pam : Web interface for users to generate temporary PAM access tokens
+# - /pam/verify : Server-to-server endpoint to validate one-time user tokens
+# - /pam/authorize : Server-to-server endpoint for authorization checks
+#
+# User tokens are one-time use tokens stored as sessions (kind=PAMTOKEN).
+# They are destroyed after first use for security.
+# Server authentication uses Bearer tokens obtained via Device Authorization Grant.
+
+package Lemonldap::NG::Portal::Plugins::PamAccess;
+
+use strict;
+use Mouse;
+use JSON qw(from_json to_json);
+use Lemonldap::NG::Portal::Main::Constants qw(
+    PE_OK
+    PE_ERROR
+    PE_SENDRESPONSE
+);
+
+our $VERSION = '2.22.0';
+
+extends 'Lemonldap::NG::Portal::Main::Plugin';
+
+use constant name => 'PamAccess';
+
+# MenuTab configuration - rule for displaying the tab
+has rule => (
+    is      => 'ro',
+    lazy    => 1,
+    builder => sub { $_[0]->conf->{portalDisplayPamAccess} // 0 },
+);
+with 'Lemonldap::NG::Portal::MenuTab';
+
+# Access to OIDC module for token generation/validation
+has oidc => (
+    is      => 'ro',
+    lazy    => 1,
+    default => sub {
+        $_[0]
+          ->p->loadedModules->{'Lemonldap::NG::Portal::Issuer::OpenIDConnect'};
+    }
+);
+
+# RP name for PAM tokens
+has rpName => (
+    is      => 'ro',
+    lazy    => 1,
+    default => sub { $_[0]->conf->{pamAccessRp} || 'pam-access' },
+);
+
+# INITIALIZATION
+
+sub init {
+    my ($self) = @_;
+
+    # Check that OIDC issuer is enabled
+    unless ( $self->conf->{issuerDBOpenIDConnectActivation} ) {
+        $self->logger->error(
+            'PamAccess plugin requires OIDC issuer to be enabled');
+        return 0;
+    }
+
+    # Routes for authenticated users (token generation interface)
+    $self->addAuthRoute( pam => 'pamInterface', ['GET'] )
+         ->addAuthRoute( pam => 'generateToken', ['POST'] );
+
+    # Route for server-to-server authorization (Bearer token auth)
+    $self->addUnauthRoute(
+        pam => { authorize => 'authorize' },
+        ['POST']
+    );
+
+    # Route for server heartbeat (refresh token based)
+    $self->addUnauthRoute(
+        pam => { heartbeat => 'heartbeat' },
+        ['POST']
+    );
+
+    # Route for one-time token verification (server-to-server)
+    $self->addUnauthRoute(
+        pam => { verify => 'verifyToken' },
+        ['POST']
+    );
+
+    # Route for NSS user info lookup (server-to-server)
+    $self->addUnauthRoute(
+        pam => { userinfo => 'userinfo' },
+        ['POST']
+    );
+
+    # SSH CA routes (only if SSH CA is enabled)
+    if ( $self->conf->{sshCaActivation} ) {
+        $self->logger->debug('SSH CA is enabled, adding routes');
+
+        # GET /ssh/ca - Public CA key (no auth required)
+        $self->addUnauthRoute(
+            ssh => { ca => 'sshCaPublicKey' },
+            ['GET']
+        );
+
+        # GET /ssh/revoked - Key Revocation List (no auth required)
+        $self->addUnauthRoute(
+            ssh => { revoked => 'sshCaKrl' },
+            ['GET']
+        );
+
+        # POST /ssh/sign - Sign user's SSH key (auth required)
+        $self->addAuthRoute(
+            ssh => { sign => 'sshCaSign' },
+            ['POST']
+        );
+    }
+
+    return 1;
+}
+
+# MENUTAB - Display method for the portal menu tab
+
+sub display {
+    my ( $self, $req ) = @_;
+
+    return {
+        logo => 'key',
+        name => 'PamAccess',
+        id   => 'pamaccess',
+        html => $self->loadTemplate(
+            $req,
+            'pamaccess',
+            params => {
+                TOKEN          => '',
+                LOGIN          => $req->userData->{ $self->conf->{whatToTrace} } || '',
+                EXPIRES_IN     => '',
+                SHOW_TOKEN     => 0,
+                DEFAULT_DURATION => $self->conf->{pamAccessTokenDuration} || 600,
+                MAX_DURATION   => $self->conf->{pamAccessMaxDuration} || 3600,
+                js             => "$self->{p}->{staticPrefix}/common/js/pamaccess.js",
+            }
+        ),
+    };
+}
+
+# ROUTE HANDLERS
+
+# GET /pam - Display the token generation interface
+sub pamInterface {
+    my ( $self, $req ) = @_;
+
+    return $self->p->do( $req, [ sub { PE_OK } ] );
+}
+
+# POST /pam - Generate a new PAM access token (one-time use)
+sub generateToken {
+    my ( $self, $req ) = @_;
+
+    # Get requested duration
+    my $duration = $req->param('duration') || $self->conf->{pamAccessTokenDuration} || 600;
+
+    # Enforce maximum duration
+    my $maxDuration = $self->conf->{pamAccessMaxDuration} || 3600;
+    $duration = $maxDuration if $duration > $maxDuration;
+
+    my $login = $req->userData->{ $self->conf->{whatToTrace} };
+    my $groups = $req->userData->{groups} || '';
+
+    # Calculate _utime for automatic cleanup by purgeCentralCache
+    # _utime + timeout = expiration time
+    # So: _utime = now + duration - timeout
+    my $now = time();
+    my $timeout = $self->conf->{timeout} || 7200;
+    my $utime = $now + $duration - $timeout;
+
+    # Create one-time token as a session with kind=PAMTOKEN
+    my $tokenInfo = {
+        _type         => 'pamtoken',
+        _utime        => $utime,
+        _pamUser      => $login,
+        _pamGroups    => $groups,
+        _pamUid       => $req->userData->{uid} || $login,
+        _pamCreatedAt => $now,
+        _pamExpiresAt => $now + $duration,
+    };
+
+    # Add exported variables for user provisioning
+    my $exportedVars = $self->conf->{pamAccessExportedVars} || {};
+    for my $key ( keys %$exportedVars ) {
+        my $attr = $exportedVars->{$key};
+        my $value = $req->userData->{$attr};
+        $tokenInfo->{"_pamAttr_$key"} = $value if defined $value && $value ne '';
+    }
+
+    my $tokenSession = $self->p->getApacheSession(
+        undef,
+        info => $tokenInfo,
+        kind => 'PAMTOKEN'
+    );
+
+    unless ( $tokenSession && $tokenSession->id ) {
+        $self->logger->error('Failed to create PAM token session');
+        return $self->p->sendJSONresponse(
+            $req,
+            { error => 'Token generation failed' },
+            code => 500
+        );
+    }
+
+    my $token = $tokenSession->id;
+    $self->logger->info("PAM one-time token generated for user $login (TTL: ${duration}s)");
+
+    # Audit log for token generation
+    $self->p->auditLog(
+        $req,
+        code    => 'PAM_TOKEN_GENERATED',
+        user    => $login,
+        message => "PAM one-time token generated for user $login (TTL: ${duration}s)",
+        ttl     => $duration,
+    );
+
+    return $self->p->sendJSONresponse(
+        $req,
+        {
+            token      => $token,
+            login      => $login,
+            expires_in => $duration,
+        }
+    );
+}
+
+# POST /pam/authorize - Server-to-server authorization check
+sub authorize {
+    my ( $self, $req ) = @_;
+
+    # 1. Validate Bearer token from Authorization header
+    my $access_token = $self->oidc->getEndPointAccessToken($req);
+    unless ($access_token) {
+        $self->logger->warn('PAM authorize: No Bearer token provided');
+        return $self->_unauthorizedResponse($req, 'Bearer token required');
+    }
+
+    my $tokenSession = $self->oidc->getAccessToken($access_token);
+    unless ($tokenSession) {
+        $self->logger->warn('PAM authorize: Invalid or expired Bearer token');
+        return $self->_unauthorizedResponse($req, 'Invalid or expired token');
+    }
+
+    # 2. Verify token was obtained via Device Authorization Grant
+    my $grant_type = $tokenSession->data->{grant_type} || '';
+    unless ( $grant_type eq 'device_code' ) {
+        $self->logger->warn(
+            "PAM authorize: Token not from Device Authorization Grant "
+            . "(grant_type: '$grant_type'). Server must enroll via /oauth2/device"
+        );
+        return $self->_forbiddenResponse(
+            $req,
+            'Server not enrolled. Use Device Authorization Grant to register this server.'
+        );
+    }
+
+    # 3. Verify token has correct scope (pam:server or pam)
+    my $scope = $tokenSession->data->{scope} || '';
+    unless ( $scope =~ /\bpam(?::server)?\b/ ) {
+        $self->logger->warn("PAM authorize: Invalid token scope '$scope'");
+        return $self->_forbiddenResponse($req, 'Invalid token scope');
+    }
+
+    # Log server identity from token
+    my $server_id = $tokenSession->data->{client_id} || 'unknown';
+    $self->logger->info("PAM authorize request from enrolled server: $server_id");
+
+    # 4. Parse JSON request body
+    my $body = eval { from_json( $req->content ) };
+    if ($@) {
+        $self->logger->error("PAM authorize: Invalid JSON body: $@");
+        return $self->_badRequest($req, 'Invalid JSON');
+    }
+
+    my $user         = $body->{user};
+    my $host         = $body->{host}         || '';
+    my $service      = $body->{service}      || 'ssh';
+    my $server_group = $body->{server_group} || 'default';
+
+    unless ($user) {
+        return $self->_badRequest($req, 'Missing user parameter');
+    }
+
+    $self->logger->debug("PAM authorize: checking user '$user' for host '$host', service '$service', server_group '$server_group'");
+
+    # 4. Lookup user (without active session)
+    $req->user($user);
+    $req->data->{_pamAuthorize} = 1;
+    $req->steps( [
+        'getUser',
+        'setSessionInfo',
+        $self->p->groupsAndMacros,
+        'setLocalGroups'
+    ] );
+
+    my $error = $self->p->process($req);
+
+    if ( $error != PE_OK ) {
+        $self->logger->info("PAM authorize: User '$user' not found (error: $error)");
+
+        # Audit log for authorization failure (user not found)
+        $self->p->auditLog(
+            $req,
+            code         => 'PAM_AUTHZ_USER_NOT_FOUND',
+            user         => $user,
+            message      => "PAM authorization failed: user '$user' not found",
+            host         => $host,
+            service      => $service,
+            server_group => $server_group,
+            server_id    => $server_id,
+        );
+
+        return $self->p->sendJSONresponse(
+            $req,
+            {
+                authorized => JSON::false,
+                user       => $user,
+                reason     => 'User not found',
+            },
+            code => 200
+        );
+    }
+
+    # 5. Evaluate authorization rule based on server_group
+    my $result = $self->_checkPamRule( $req, $host, $service, $server_group );
+    my $authorized   = $result->{authorized};
+    my $sudo_allowed = $result->{sudo_allowed};
+
+    # Get groups for response
+    my $groups = $req->sessionInfo->{groups} || '';
+    my @groupList = split /[,;\s]+/, $groups;
+
+    $self->logger->info(
+        "PAM authorize: user '$user' " .
+        ($authorized ? 'granted' : 'denied') .
+        " access to host '$host'" .
+        ($authorized && $sudo_allowed ? ' (sudo allowed)' : '')
+    );
+
+    # Audit log for authorization result
+    if ($authorized) {
+        $self->p->auditLog(
+            $req,
+            code         => 'PAM_AUTHZ_SUCCESS',
+            user         => $user,
+            message      => "PAM authorization granted for user '$user' on host '$host'",
+            host         => $host,
+            service      => $service,
+            server_group => $server_group,
+            server_id    => $server_id,
+            groups       => \@groupList,
+            sudo_allowed => $sudo_allowed,
+        );
+    }
+    else {
+        $self->p->auditLog(
+            $req,
+            code         => 'PAM_AUTHZ_DENIED',
+            user         => $user,
+            message      => "PAM authorization denied for user '$user' on host '$host'",
+            host         => $host,
+            service      => $service,
+            server_group => $server_group,
+            server_id    => $server_id,
+            groups       => \@groupList,
+            reason       => 'Access denied by rule',
+        );
+    }
+
+    # Build response with permissions
+    my $response = {
+        authorized => $authorized ? JSON::true : JSON::false,
+        user       => $user,
+        groups     => \@groupList,
+    };
+
+    # Add permissions for authorized users
+    if ($authorized) {
+        $response->{permissions} = {
+            sudo_allowed => $sudo_allowed ? JSON::true : JSON::false,
+        };
+    }
+    else {
+        $response->{reason} = 'Access denied by rule';
+    }
+
+    return $self->p->sendJSONresponse(
+        $req,
+        $response,
+        code => 200
+    );
+}
+
+# HELPER METHODS
+
+# Check PAM authorization rule for a specific service type
+# Returns: { authorized => 0|1, sudo_allowed => 0|1 }
+sub _checkPamRule {
+    my ( $self, $req, $host, $service, $server_group ) = @_;
+
+    # Set variables available for rule evaluation
+    $req->sessionInfo->{_pamHost}        = $host;
+    $req->sessionInfo->{_pamService}     = $service;
+    $req->sessionInfo->{_pamServerGroup} = $server_group || 'default';
+
+    my $result = {
+        authorized   => 0,
+        sudo_allowed => 0,
+    };
+
+    # Determine which rule set to use based on service type
+    my $ssh_authorized = $self->_evaluateRule(
+        $req, $server_group, 'ssh'
+    );
+
+    # For SSH service, check SSH rules
+    if ( $service eq 'sshd' || $service eq 'ssh' ) {
+        $result->{authorized} = $ssh_authorized;
+    }
+    # For sudo service, check both SSH (must be connected) and sudo rules
+    elsif ( $service eq 'sudo' ) {
+        # User must first be authorized for SSH
+        if ($ssh_authorized) {
+            $result->{authorized} = 1;
+            $result->{sudo_allowed} = $self->_evaluateRule(
+                $req, $server_group, 'sudo'
+            );
+        }
+    }
+    # For other services, fall back to legacy rules
+    else {
+        $result->{authorized} = $self->_evaluateRule(
+            $req, $server_group, 'legacy'
+        );
+    }
+
+    # Also compute sudo_allowed for SSH requests (for response)
+    if ( $service eq 'sshd' || $service eq 'ssh' ) {
+        $result->{sudo_allowed} = $self->_evaluateRule(
+            $req, $server_group, 'sudo'
+        );
+    }
+
+    return $result;
+}
+
+# Evaluate a specific rule type for a server group
+sub _evaluateRule {
+    my ( $self, $req, $server_group, $rule_type ) = @_;
+
+    $server_group ||= 'default';
+
+    # Select the appropriate rule set
+    my $rules;
+    if ( $rule_type eq 'ssh' ) {
+        $rules = $self->conf->{pamAccessSshRules} || {};
+        # Fallback to legacy rules if SSH rules not defined
+        if ( !%$rules ) {
+            $rules = $self->conf->{pamAccessServerGroups} || {};
+        }
+    }
+    elsif ( $rule_type eq 'sudo' ) {
+        $rules = $self->conf->{pamAccessSudoRules} || {};
+        # No fallback for sudo - if not defined, sudo is denied
+    }
+    else {
+        # Legacy mode
+        $rules = $self->conf->{pamAccessServerGroups} || {};
+    }
+
+    my $rule;
+
+    # 1. Look for rule matching the requested server_group
+    if ( exists $rules->{$server_group} ) {
+        $rule = $rules->{$server_group};
+        $self->logger->debug(
+            "PAM authorize: using $rule_type rule for group '$server_group'"
+        );
+    }
+    # 2. Fallback to 'default' group
+    elsif ( exists $rules->{default} ) {
+        $rule = $rules->{default};
+        $self->logger->debug(
+            "PAM authorize: $rule_type rule for '$server_group' not found, using 'default'"
+        );
+    }
+    # 3. No rule found -> deny
+    else {
+        $self->logger->debug(
+            "PAM authorize: no $rule_type rule for '$server_group' or 'default'"
+        );
+        return 0;
+    }
+
+    # Simple boolean
+    return $rule if defined $rule && $rule =~ /^[01]$/;
+
+    # Empty or undefined rule -> deny
+    return 0 unless defined $rule && $rule ne '';
+
+    # Evaluate rule as expression
+    my $result = $self->p->HANDLER->buildSub(
+        $self->p->HANDLER->substitute($rule)
+    )->( $req, $req->sessionInfo );
+
+    return $result ? 1 : 0;
+}
+
+sub _unauthorizedResponse {
+    my ( $self, $req, $message ) = @_;
+    $message ||= 'Unauthorized';
+
+    return $self->p->sendJSONresponse(
+        $req,
+        { error => $message },
+        code => 401,
+        headers => [ 'WWW-Authenticate' => 'Bearer realm="pam"' ],
+    );
+}
+
+sub _forbiddenResponse {
+    my ( $self, $req, $message ) = @_;
+    $message ||= 'Forbidden';
+
+    return $self->p->sendJSONresponse(
+        $req,
+        { error => $message },
+        code => 403
+    );
+}
+
+sub _badRequest {
+    my ( $self, $req, $message ) = @_;
+    $message ||= 'Bad Request';
+
+    return $self->p->sendJSONresponse(
+        $req,
+        { error => $message },
+        code => 400
+    );
+}
+
+# POST /pam/verify - Verify and consume a one-time PAM token
+sub verifyToken {
+    my ( $self, $req ) = @_;
+
+    # 1. Validate server Bearer token from Authorization header
+    my $server_token = $self->oidc->getEndPointAccessToken($req);
+    unless ($server_token) {
+        $self->logger->warn('PAM verify: No server Bearer token provided');
+        return $self->_unauthorizedResponse( $req, 'Server Bearer token required' );
+    }
+
+    my $serverSession = $self->oidc->getAccessToken($server_token);
+    unless ($serverSession) {
+        $self->logger->warn('PAM verify: Invalid or expired server token');
+        return $self->_unauthorizedResponse( $req, 'Invalid or expired server token' );
+    }
+
+    # Verify server token was obtained via Device Authorization Grant
+    my $grant_type = $serverSession->data->{grant_type} || '';
+    unless ( $grant_type eq 'device_code' ) {
+        $self->logger->warn(
+            "PAM verify: Server token not from Device Authorization Grant "
+              . "(grant_type: '$grant_type')"
+        );
+        return $self->_forbiddenResponse( $req,
+            'Server not enrolled. Use Device Authorization Grant.' );
+    }
+
+    # 2. Parse JSON request body
+    my $body = eval { from_json( $req->content ) };
+    if ($@) {
+        $self->logger->error("PAM verify: Invalid JSON body: $@");
+        return $self->_badRequest( $req, 'Invalid JSON' );
+    }
+
+    my $user_token = $body->{token};
+    unless ($user_token) {
+        return $self->_badRequest( $req, 'token parameter required' );
+    }
+
+    # Get server info for audit
+    my $server_id = $serverSession->data->{client_id} || 'unknown';
+
+    # 3. Retrieve the PAMTOKEN session
+    my $tokenSession = $self->p->getApacheSession( $user_token, kind => 'PAMTOKEN' );
+    unless ($tokenSession) {
+        $self->logger->info("PAM verify: Invalid or expired token");
+
+        # Audit log for authentication failure
+        $self->p->auditLog(
+            $req,
+            code      => 'PAM_AUTH_INVALID_TOKEN',
+            message   => 'PAM authentication failed: invalid or expired token',
+            server_id => $server_id,
+            reason    => 'Invalid or expired token',
+        );
+
+        return $self->p->sendJSONresponse(
+            $req,
+            {
+                valid => JSON::false,
+                error => 'Invalid or expired token',
+            },
+            code => 200
+        );
+    }
+
+    # 4. Verify token type
+    my $type = $tokenSession->data->{_type} || '';
+    unless ( $type eq 'pamtoken' ) {
+        $self->logger->warn("PAM verify: Wrong token type '$type'");
+
+        # Audit log for security error
+        $self->p->auditLog(
+            $req,
+            code      => 'PAM_AUTH_WRONG_TOKEN_TYPE',
+            message   => "PAM authentication failed: wrong token type '$type'",
+            server_id => $server_id,
+            reason    => 'Invalid token type',
+        );
+
+        $tokenSession->remove;
+        return $self->p->sendJSONresponse(
+            $req,
+            {
+                valid => JSON::false,
+                error => 'Invalid token type',
+            },
+            code => 200
+        );
+    }
+
+    # 5. Check expiration
+    my $expiresAt = $tokenSession->data->{_pamExpiresAt} || 0;
+    if ( time() > $expiresAt ) {
+        my $user = $tokenSession->data->{_pamUser} || 'unknown';
+        $self->logger->info("PAM verify: Token expired");
+
+        # Audit log for expired token
+        $self->p->auditLog(
+            $req,
+            code      => 'PAM_AUTH_TOKEN_EXPIRED',
+            user      => $user,
+            message   => "PAM authentication failed: token expired for user '$user'",
+            server_id => $server_id,
+            reason    => 'Token expired',
+        );
+
+        $tokenSession->remove;
+        return $self->p->sendJSONresponse(
+            $req,
+            {
+                valid => JSON::false,
+                error => 'Token expired',
+            },
+            code => 200
+        );
+    }
+
+    # 6. Extract user info
+    my $user   = $tokenSession->data->{_pamUser}   || '';
+    my $groups = $tokenSession->data->{_pamGroups} || '';
+    my @groupList = $groups ? split( /[,;\s]+/, $groups ) : ();
+
+    # Extract exported attributes (prefixed with _pamAttr_)
+    my %attrs;
+    for my $key ( keys %{ $tokenSession->data } ) {
+        if ( $key =~ /^_pamAttr_(.+)$/ ) {
+            $attrs{$1} = $tokenSession->data->{$key};
+        }
+    }
+
+    # 7. CRITICAL: Remove the session (one-time use!)
+    $tokenSession->remove;
+
+    $self->logger->info("PAM verify: Token consumed for user '$user'");
+
+    # Audit log for successful authentication
+    $self->p->auditLog(
+        $req,
+        code      => 'PAM_AUTH_SUCCESS',
+        user      => $user,
+        message   => "PAM authentication successful for user '$user'",
+        server_id => $server_id,
+        groups    => \@groupList,
+    );
+
+    # 8. Return success with user info and exported attributes
+    return $self->p->sendJSONresponse(
+        $req,
+        {
+            valid  => JSON::true,
+            user   => $user,
+            groups => \@groupList,
+            ( %attrs ? ( attrs => \%attrs ) : () ),
+        },
+        code => 200
+    );
+}
+
+# POST /pam/heartbeat - Server heartbeat for monitoring
+sub heartbeat {
+    my ( $self, $req ) = @_;
+
+    # 1. Parse JSON request body
+    my $body = eval { from_json( $req->content ) };
+    if ($@) {
+        $self->logger->error("PAM heartbeat: Invalid JSON body: $@");
+        return $self->_badRequest( $req, 'Invalid JSON' );
+    }
+
+    # 2. Extract refresh_token from body
+    my $refresh_token_id = $body->{refresh_token};
+    unless ($refresh_token_id) {
+        return $self->_badRequest( $req, 'refresh_token required' );
+    }
+
+    # 3. Validate refresh token exists
+    my $rtSession = $self->oidc->getRefreshToken($refresh_token_id);
+    unless ($rtSession) {
+        $self->logger->warn('PAM heartbeat: invalid or expired refresh_token');
+        return $self->_unauthorizedResponse( $req, 'Invalid refresh_token' );
+    }
+
+    # 4. Verify token was obtained via Device Authorization Grant
+    my $grant_type = $rtSession->data->{grant_type} || '';
+    unless ( $grant_type eq 'device_code' ) {
+        $self->logger->warn(
+            "PAM heartbeat: Token not from Device Authorization Grant "
+              . "(grant_type: '$grant_type')"
+        );
+        return $self->_forbiddenResponse( $req,
+            'Token not from Device Authorization Grant' );
+    }
+
+    # 5. Update metadata in refresh_token session
+    my $now      = time();
+    my $hostname = $body->{hostname} || 'unknown';
+    my $updates  = {
+        _pamServer      => 1,
+        _pamHostname    => $hostname,
+        _pamServerGroup => $body->{server_group} || 'default',
+        _pamVersion     => $body->{version}      || '',
+        _pamLastSeen    => $now,
+        _pamStatus      => 'active',
+    };
+
+    # Store stats as JSON string if provided
+    if ( $body->{stats} ) {
+        $updates->{_pamStats} = to_json( $body->{stats} );
+    }
+
+    # First heartbeat = enrollment timestamp
+    unless ( $rtSession->data->{_pamEnrolledAt} ) {
+        $updates->{_pamEnrolledAt} = $now;
+    }
+
+    # Update the refresh_token session
+    $self->oidc->updateRefreshToken( $rtSession->id, $updates );
+
+    $self->logger->debug("PAM heartbeat from $hostname");
+
+    # 6. Respond with next heartbeat interval
+    my $interval = $self->conf->{pamAccessHeartbeatInterval} || 300;
+    return $self->p->sendJSONresponse(
+        $req,
+        {
+            status         => 'ok',
+            next_heartbeat => $interval,
+            server_time    => $now,
+        }
+    );
+}
+
+# POST /pam/userinfo - Get user info for NSS module
+sub userinfo {
+    my ( $self, $req ) = @_;
+
+    # 1. Validate server Bearer token from Authorization header
+    my $server_token = $self->oidc->getEndPointAccessToken($req);
+    unless ($server_token) {
+        $self->logger->warn('PAM userinfo: No server Bearer token provided');
+        return $self->_unauthorizedResponse( $req, 'Server Bearer token required' );
+    }
+
+    my $serverSession = $self->oidc->getAccessToken($server_token);
+    unless ($serverSession) {
+        $self->logger->warn('PAM userinfo: Invalid or expired server token');
+        return $self->_unauthorizedResponse( $req, 'Invalid or expired server token' );
+    }
+
+    # Verify server token was obtained via Device Authorization Grant
+    my $grant_type = $serverSession->data->{grant_type} || '';
+    unless ( $grant_type eq 'device_code' ) {
+        $self->logger->warn(
+            "PAM userinfo: Server token not from Device Authorization Grant "
+              . "(grant_type: '$grant_type')"
+        );
+        return $self->_forbiddenResponse( $req,
+            'Server not enrolled. Use Device Authorization Grant.' );
+    }
+
+    # 2. Parse JSON request body
+    my $body = eval { from_json( $req->content ) };
+    if ($@) {
+        $self->logger->error("PAM userinfo: Invalid JSON body: $@");
+        return $self->_badRequest( $req, 'Invalid JSON' );
+    }
+
+    my $user = $body->{user};
+    unless ($user) {
+        return $self->_badRequest( $req, 'user parameter required' );
+    }
+
+    # 3. Lookup user in backend
+    $req->user($user);
+    $req->data->{_pamUserinfo} = 1;
+    $req->steps( [
+        'getUser',
+        'setSessionInfo',
+        $self->p->groupsAndMacros,
+        'setLocalGroups'
+    ] );
+
+    my $error = $self->p->process($req);
+
+    if ( $error != PE_OK ) {
+        $self->logger->debug("PAM userinfo: User '$user' not found (error: $error)");
+        return $self->p->sendJSONresponse(
+            $req,
+            {
+                found => JSON::false,
+                user  => $user,
+            },
+            code => 200
+        );
+    }
+
+    # 4. Build response with user attributes
+    my $exportedVars = $self->conf->{pamAccessExportedVars} || {};
+    my %attrs;
+
+    for my $key ( keys %$exportedVars ) {
+        my $attr = $exportedVars->{$key};
+        my $value = $req->sessionInfo->{$attr};
+        $attrs{$key} = $value if defined $value && $value ne '';
+    }
+
+    # Always include basic info
+    my $groups = $req->sessionInfo->{groups} || '';
+    my @groupList = split /[,;\s]+/, $groups;
+
+    $self->logger->debug("PAM userinfo: Found user '$user'");
+
+    return $self->p->sendJSONresponse(
+        $req,
+        {
+            found  => JSON::true,
+            user   => $user,
+            groups => \@groupList,
+            %attrs,
+        },
+        code => 200
+    );
+}
+
+# =============================================================================
+# SSH CA METHODS
+# =============================================================================
+
+# GET /ssh/ca.pub - Return SSH CA public key
+sub sshCaPublicKey {
+    my ( $self, $req ) = @_;
+
+    # Get the key reference from config
+    my $keyRef = $self->conf->{sshCaKeyRef};
+    unless ($keyRef) {
+        $self->logger->error('SSH CA: No key reference configured (sshCaKeyRef)');
+        return $self->p->sendError( $req, 'SSH CA not configured', 500 );
+    }
+
+    # Get the key from LLNG keys store
+    my $keys = $self->conf->{keys} || {};
+    my $keyData = $keys->{$keyRef};
+    unless ($keyData) {
+        $self->logger->error("SSH CA: Key '$keyRef' not found in keys store");
+        return $self->p->sendError( $req, 'SSH CA key not found', 500 );
+    }
+
+    # Get the public key
+    my $publicKey = $keyData->{keyPublic};
+    unless ($publicKey) {
+        $self->logger->error("SSH CA: No public key for '$keyRef'");
+        return $self->p->sendError( $req, 'SSH CA public key not found', 500 );
+    }
+
+    # Convert PEM public key to SSH format
+    my $sshPubKey = $self->_pemToSshPublicKey($publicKey, $keyRef);
+    unless ($sshPubKey) {
+        $self->logger->error('SSH CA: Failed to convert public key to SSH format');
+        return $self->p->sendError( $req, 'Failed to convert key', 500 );
+    }
+
+    $self->logger->debug('SSH CA: Serving public key');
+
+    return [
+        200,
+        [
+            'Content-Type'  => 'text/plain; charset=utf-8',
+            'Cache-Control' => 'public, max-age=3600',
+        ],
+        [$sshPubKey]
+    ];
+}
+
+# GET /ssh/revoked - Return SSH Key Revocation List (KRL)
+sub sshCaKrl {
+    my ( $self, $req ) = @_;
+
+    my $krlPath = $self->conf->{sshCaKrlPath};
+    unless ($krlPath) {
+        $self->logger->error('SSH CA: No KRL path configured');
+        return $self->p->sendError( $req, 'KRL not configured', 500 );
+    }
+
+    # Read KRL file if it exists
+    if ( -f $krlPath ) {
+        open my $fh, '<:raw', $krlPath or do {
+            $self->logger->error("SSH CA: Cannot read KRL file: $!");
+            return $self->p->sendError( $req, 'Cannot read KRL', 500 );
+        };
+        local $/;
+        my $krlData = <$fh>;
+        close $fh;
+
+        $self->logger->debug('SSH CA: Serving KRL');
+
+        return [
+            200,
+            [
+                'Content-Type'  => 'application/octet-stream',
+                'Cache-Control' => 'public, max-age=300',
+            ],
+            [$krlData]
+        ];
+    }
+    else {
+        # Return empty KRL if file doesn't exist
+        $self->logger->debug('SSH CA: KRL file not found, returning empty response');
+        return [
+            200,
+            [
+                'Content-Type'  => 'application/octet-stream',
+                'Cache-Control' => 'public, max-age=300',
+            ],
+            ['']
+        ];
+    }
+}
+
+# POST /ssh/sign - Sign user's SSH public key
+sub sshCaSign {
+    my ( $self, $req ) = @_;
+
+    # Parse JSON request body
+    my $body = eval { from_json( $req->content ) };
+    if ($@) {
+        $self->logger->error("SSH CA sign: Invalid JSON body: $@");
+        return $self->_badRequest( $req, 'Invalid JSON' );
+    }
+
+    my $userPubKey = $body->{public_key};
+    unless ($userPubKey) {
+        return $self->_badRequest( $req, 'public_key parameter required' );
+    }
+
+    # Validate SSH public key format
+    unless ( $userPubKey =~ /^(ssh-\w+|ecdsa-sha2-\w+)\s+[A-Za-z0-9+\/=]+/ ) {
+        return $self->_badRequest( $req, 'Invalid SSH public key format' );
+    }
+
+    # Get validity from request or use default
+    my $validityMinutes = $body->{validity_minutes}
+                        || $self->conf->{sshCaCertDefaultValidity}
+                        || 30;
+
+    # Enforce maximum validity
+    my $maxValidity = $self->conf->{sshCaCertMaxValidity} || 60;
+    $validityMinutes = $maxValidity if $validityMinutes > $maxValidity;
+
+    # Get principals from request or derive from session
+    my @principals;
+    if ( $body->{principals} && ref $body->{principals} eq 'ARRAY' ) {
+        @principals = @{ $body->{principals} };
+    }
+    else {
+        # Evaluate principal sources from config (e.g., '$uid' or '$uid $mail')
+        my $principalSources = $self->conf->{sshCaPrincipalSources} || '$uid';
+
+        # Simple variable substitution from session (try userData first, then sessionInfo)
+        my $principal = $principalSources;
+        $principal =~ s/\$(\w+)/
+            $req->userData->{$1} || $req->sessionInfo->{$1} || ''
+        /ge;
+        $principal =~ s/^\s+|\s+$//g;  # trim
+
+        # Split on whitespace if multiple principals
+        @principals = grep { $_ ne '' } split /\s+/, $principal;
+    }
+
+    unless (@principals) {
+        $self->logger->error('SSH CA sign: No principals available');
+        return $self->_badRequest( $req, 'No principals available' );
+    }
+
+    # Get user info for key_id
+    my $whatToTrace = $self->conf->{whatToTrace} || 'uid';
+    my $user = $req->userData->{$whatToTrace}
+            || $req->sessionInfo->{$whatToTrace}
+            || $req->userData->{uid}
+            || $req->sessionInfo->{uid}
+            || $req->user
+            || 'unknown';
+
+    # Generate serial number
+    my $serial = $self->_getNextSerial();
+
+    # Generate key_id
+    my $timestamp = time();
+    my $keyId = sprintf( "%s\@llng-%d-%06d", $user, $timestamp, $serial );
+
+    # Sign the certificate
+    my $result = $self->_signSshKey(
+        $userPubKey,
+        \@principals,
+        $validityMinutes,
+        $serial,
+        $keyId
+    );
+
+    unless ( $result && $result->{certificate} ) {
+        $self->logger->error('SSH CA sign: Failed to sign key');
+        return $self->p->sendJSONresponse(
+            $req,
+            { error => 'Failed to sign SSH key' },
+            code => 500
+        );
+    }
+
+    # Calculate expiration time
+    my $validUntil = time() + ( $validityMinutes * 60 );
+    my @t = gmtime($validUntil);
+    my $validUntilISO = sprintf(
+        "%04d-%02d-%02dT%02d:%02d:%02dZ",
+        $t[5] + 1900, $t[4] + 1, $t[3], $t[2], $t[1], $t[0]
+    );
+
+    $self->logger->info(
+        "SSH CA: Certificate issued for user '$user', "
+        . "principals: " . join(',', @principals) . ", "
+        . "validity: ${validityMinutes}min, serial: $serial"
+    );
+
+    # Audit log
+    $self->p->auditLog(
+        $req,
+        code       => 'SSH_CERT_ISSUED',
+        user       => $user,
+        message    => "SSH certificate issued for user '$user'",
+        principals => \@principals,
+        serial     => $serial,
+        key_id     => $keyId,
+        validity   => $validityMinutes,
+    );
+
+    return $self->p->sendJSONresponse(
+        $req,
+        {
+            certificate => $result->{certificate},
+            serial      => $serial,
+            valid_until => $validUntilISO,
+            principals  => \@principals,
+            key_id      => $keyId,
+        }
+    );
+}
+
+# HELPER: Get next serial number (atomic increment)
+sub _getNextSerial {
+    my ($self) = @_;
+
+    my $serialPath = $self->conf->{sshCaSerialPath}
+                   || '/var/lib/lemonldap-ng/ssh/serial';
+
+    # Ensure directory exists
+    my $dir = $serialPath;
+    $dir =~ s|/[^/]+$||;
+    unless ( -d $dir ) {
+        require File::Path;
+        File::Path::make_path($dir);
+    }
+
+    # Read current serial, increment, and write back
+    my $serial = 1;
+    if ( -f $serialPath ) {
+        if ( open my $fh, '<', $serialPath ) {
+            $serial = <$fh>;
+            chomp $serial;
+            $serial = int($serial) + 1;
+            close $fh;
+        }
+    }
+
+    # Write new serial
+    if ( open my $fh, '>', $serialPath ) {
+        print $fh "$serial\n";
+        close $fh;
+    }
+    else {
+        $self->logger->warn("SSH CA: Cannot write serial file: $!");
+    }
+
+    return $serial;
+}
+
+# HELPER: Sign SSH key using ssh-keygen
+sub _signSshKey {
+    my ( $self, $userPubKey, $principals, $validityMinutes, $serial, $keyId ) = @_;
+
+    require File::Temp;
+
+    # Get CA private key
+    my $keyRef = $self->conf->{sshCaKeyRef};
+    unless ($keyRef) {
+        $self->logger->error('SSH CA: No key reference configured');
+        return undef;
+    }
+
+    my $keys = $self->conf->{keys} || {};
+    my $keyData = $keys->{$keyRef};
+    unless ( $keyData && $keyData->{keyPrivate} ) {
+        $self->logger->error("SSH CA: Key '$keyRef' not found or has no private key");
+        return undef;
+    }
+
+    # Create temp directory for key files
+    my $tmpdir = File::Temp::tempdir( CLEANUP => 1 );
+
+    # Write CA private key to temp file (convert PEM to OpenSSH format)
+    my $caKeyFile = "$tmpdir/ca_key";
+    my $caKeyOpenSSH = $self->_pemToOpenSSHPrivateKey( $keyData->{keyPrivate} );
+    unless ($caKeyOpenSSH) {
+        $self->logger->error('SSH CA: Failed to convert CA key');
+        return undef;
+    }
+
+    open my $fh, '>', $caKeyFile or do {
+        $self->logger->error("SSH CA: Cannot write CA key: $!");
+        return undef;
+    };
+    print $fh $caKeyOpenSSH;
+    close $fh;
+    chmod 0600, $caKeyFile;
+
+    # Write user's public key to temp file
+    my $userKeyFile = "$tmpdir/user_key.pub";
+    open $fh, '>', $userKeyFile or do {
+        $self->logger->error("SSH CA: Cannot write user key: $!");
+        return undef;
+    };
+    print $fh $userPubKey;
+    print $fh "\n" unless $userPubKey =~ /\n$/;
+    close $fh;
+
+    # Build ssh-keygen command
+    my @cmd = (
+        'ssh-keygen',
+        '-s', $caKeyFile,           # CA key
+        '-I', $keyId,               # Key identity
+        '-n', join(',', @$principals),  # Principals
+        '-V', "+${validityMinutes}m",   # Validity
+        '-z', $serial,              # Serial number
+        $userKeyFile                # User's public key to sign
+    );
+
+    $self->logger->debug("SSH CA: Running: " . join(' ', @cmd));
+
+    # Execute ssh-keygen
+    my $output = '';
+    my $pid = open my $pipe, '-|';
+    if ( !defined $pid ) {
+        $self->logger->error("SSH CA: Cannot fork: $!");
+        return undef;
+    }
+    elsif ( $pid == 0 ) {
+        # Child process
+        open STDERR, '>&', \*STDOUT;
+        exec @cmd;
+        exit 1;
+    }
+    else {
+        # Parent process
+        local $/;
+        $output = <$pipe>;
+        close $pipe;
+    }
+
+    my $exitCode = $? >> 8;
+    if ( $exitCode != 0 ) {
+        $self->logger->error("SSH CA: ssh-keygen failed (exit $exitCode): $output");
+        return undef;
+    }
+
+    # Read the generated certificate
+    my $certFile = "$tmpdir/user_key-cert.pub";
+    unless ( -f $certFile ) {
+        $self->logger->error("SSH CA: Certificate file not created");
+        return undef;
+    }
+
+    open $fh, '<', $certFile or do {
+        $self->logger->error("SSH CA: Cannot read certificate: $!");
+        return undef;
+    };
+    my $certificate = <$fh>;
+    close $fh;
+    chomp $certificate;
+
+    return { certificate => $certificate };
+}
+
+# HELPER: Convert PEM private key to OpenSSH format
+sub _pemToOpenSSHPrivateKey {
+    my ( $self, $pemKey ) = @_;
+
+    # For Ed25519 keys, we need to convert PEM to OpenSSH format
+    # ssh-keygen can read PEM format directly for some key types,
+    # but for Ed25519 we may need conversion
+
+    # First, try to detect if it's already in OpenSSH format
+    if ( $pemKey =~ /^-----BEGIN OPENSSH PRIVATE KEY-----/ ) {
+        return $pemKey;
+    }
+
+    # For Ed25519 PEM keys, use ssh-keygen to convert
+    if ( $pemKey =~ /BEGIN PRIVATE KEY/ || $pemKey =~ /BEGIN EC PRIVATE KEY/ ) {
+        require File::Temp;
+        my $tmpdir = File::Temp::tempdir( CLEANUP => 1 );
+        my $pemFile = "$tmpdir/key.pem";
+        my $sshFile = "$tmpdir/key";
+
+        # Write PEM key
+        open my $fh, '>', $pemFile or return undef;
+        print $fh $pemKey;
+        close $fh;
+        chmod 0600, $pemFile;
+
+        # Try to use the PEM directly with ssh-keygen
+        # ssh-keygen -s accepts PEM format for RSA/ECDSA
+        # For Ed25519, we need to check if it works
+
+        # Actually, let's just return the PEM and see if ssh-keygen accepts it
+        return $pemKey;
+    }
+
+    # RSA keys in traditional format
+    if ( $pemKey =~ /BEGIN RSA PRIVATE KEY/ ) {
+        return $pemKey;
+    }
+
+    return $pemKey;
+}
+
+# HELPER: Convert PEM public key to SSH format
+sub _pemToSshPublicKey {
+    my ( $self, $pemKey, $comment ) = @_;
+
+    require MIME::Base64;
+
+    my $sshKey;
+
+    # Try Ed25519 first
+    eval {
+        require Crypt::PK::Ed25519;
+        my $pk = Crypt::PK::Ed25519->new(\$pemKey);
+        my $rawKey = $pk->export_key_raw('public');
+
+        # Build SSH format: string "ssh-ed25519" + string <32 bytes key>
+        my $keyType = 'ssh-ed25519';
+        my $blob = pack('N', length($keyType)) . $keyType
+                 . pack('N', length($rawKey)) . $rawKey;
+
+        $sshKey = "$keyType " . MIME::Base64::encode_base64($blob, '');
+    };
+
+    # Try RSA if Ed25519 failed
+    if ($@ || !$sshKey) {
+        eval {
+            require Crypt::PK::RSA;
+            my $pk = Crypt::PK::RSA->new(\$pemKey);
+            # RSA keys can use export_key_openssh
+            $sshKey = $pk->export_key_openssh;
+        };
+    }
+
+    unless ($sshKey) {
+        $self->logger->error("SSH CA: Failed to convert key to SSH format: $@");
+        return undef;
+    }
+
+    # Add comment (SSH key has format: type base64 [comment])
+    chomp($sshKey);
+    my @parts = split /\s+/, $sshKey;
+    if (@parts == 2) {
+        # No comment yet, add one
+        $sshKey .= " LLNG-SSH-CA-$comment";
+    }
+
+    return "$sshKey\n";
+}
+
+1;
+
+__END__
+
+=pod
+
+=encoding utf8
+
+=head1 NAME
+
+Lemonldap::NG::Portal::Plugins::PamAccess - PAM authentication/authorization plugin
+
+=head1 SYNOPSIS
+
+Enable this plugin in LemonLDAP::NG Manager:
+General Parameters > Plugins > PAM Access > Activation
+
+=head1 DESCRIPTION
+
+This plugin provides three main features:
+
+=head2 User Token Generation (/pam)
+
+Authenticated users can generate temporary ONE-TIME access tokens that can
+be used as passwords for PAM authentication (e.g., SSH login).
+
+Tokens are stored as sessions with kind='PAMTOKEN' and are automatically
+destroyed after first use, preventing replay attacks.
+
+=head2 Token Verification (/pam/verify)
+
+Servers validate and consume one-time user tokens. The token is destroyed
+immediately upon successful verification, ensuring single-use semantics.
+
+=head2 Server Authorization (/pam/authorize)
+
+Servers can check if a user is authorized to access a service, even when
+the user authenticates via SSH key (no token involved).
+
+=head1 ENDPOINTS
+
+=head2 GET /pam
+
+Display the token generation interface (requires authentication).
+
+=head2 POST /pam
+
+Generate a new one-time PAM access token.
+
+Parameters:
+- duration: Token validity in seconds (optional, default: 600)
+
+Response:
+{
+  "token": "session_id",
+  "login": "username",
+  "expires_in": 600
+}
+
+=head2 POST /pam/verify
+
+Verify and consume a one-time user token (server-to-server).
+
+Requires: Server Bearer token in Authorization header (from Device Auth Grant)
+
+Request body:
+{
+  "token": "user_token_to_verify"
+}
+
+Response:
+{
+  "valid": true/false,
+  "user": "username",
+  "groups": ["group1", "group2"],
+  "error": "..." (only if invalid)
+}
+
+IMPORTANT: The token is destroyed after successful verification (one-time use).
+
+=head2 POST /pam/authorize
+
+Check if a user is authorized (server-to-server).
+
+Requires: Bearer token in Authorization header
+
+Request body:
+{
+  "user": "username",
+  "host": "server.example.com",
+  "service": "ssh"
+}
+
+Response:
+{
+  "authorized": true/false,
+  "user": "username",
+  "groups": ["group1", "group2"],
+  "reason": "..." (only if denied)
+}
+
+=head2 POST /pam/heartbeat
+
+Server heartbeat for monitoring enrolled PAM servers.
+
+Request body:
+{
+  "refresh_token": "session_id_of_refresh_token",
+  "hostname": "server.example.com",
+  "server_group": "production",
+  "version": "1.0.0",
+  "stats": { "auth_success": 42, "auth_failure": 3 }
+}
+
+Response:
+{
+  "status": "ok",
+  "next_heartbeat": 300,
+  "server_time": 1702742400
+}
+
+=head1 CONFIGURATION
+
+=over
+
+=item pamAccessActivation
+
+Enable/disable the plugin (default: 0)
+
+=item portalDisplayPamAccess
+
+Rule for displaying the menu tab (default: 0)
+
+=item pamAccessTokenDuration
+
+Default token validity in seconds (default: 600)
+
+=item pamAccessMaxDuration
+
+Maximum token validity in seconds (default: 3600)
+
+=item pamAccessServerGroups
+
+Hash of server group names to authorization rules. Each PAM server can
+specify its group via the C<server_group> parameter in the authorize request.
+If a server's group is not found, the 'default' group rule is used.
+
+Example:
+  {
+    "production" => '$hGroup->{ops}',
+    "staging"    => '$hGroup->{ops} or $hGroup->{dev}',
+    "dev"        => '$hGroup->{dev} or $uid eq "admin"',
+    "default"    => '1'
+  }
+
+=item pamAccessRp
+
+OIDC Relying Party name for tokens (default: 'pam-access')
+
+=item pamAccessHeartbeatInterval
+
+Expected interval between server heartbeats in seconds (default: 300)
+
+=item pamAccessInactiveThreshold
+
+Time in seconds after which a server is considered inactive if no heartbeat
+received (default: 900)
+
+=item pamAccessHeartbeatRequired
+
+If enabled, servers must have a recent heartbeat to use /pam/authorize.
+This ensures that the PAM module is still active on the server. (default: 0)
+
+=back
+
+=head1 SEE ALSO
+
+L<Lemonldap::NG::Portal::Plugins::DeviceAuthorization> for server enrollment
+
+=head1 AUTHORS
+
+=over
+
+=item LemonLDAP::NG team L<https://lemonldap-ng.org/team>
+
+=back
+
+=head1 LICENSE AND COPYRIGHT
+
+See COPYING file for details.
+
+=cut
diff --git a/lemonldap-ng-portal/site/htdocs/static/common/js/pamaccess.js b/lemonldap-ng-portal/site/htdocs/static/common/js/pamaccess.js
new file mode 100644
index 000000000..880193d19
--- /dev/null
+++ b/lemonldap-ng-portal/site/htdocs/static/common/js/pamaccess.js
@@ -0,0 +1,63 @@
+(function () {
+  'use strict';
+
+  (function () {
+    $(window).on("load", function () {
+      var form = document.getElementById('pamTokenForm');
+      if (!form) return;
+      var resultDiv = document.getElementById('pamTokenResult');
+      var errorDiv = document.getElementById('pamTokenError');
+      var tokenInput = document.getElementById('pamToken');
+      var loginSpan = document.getElementById('pamLogin');
+      var expiresSpan = document.getElementById('pamExpiresIn');
+      var copyBtn = document.getElementById('copyPamToken');
+      var errorMsg = document.getElementById('pamErrorMessage');
+      form.addEventListener('submit', function (e) {
+        e.preventDefault();
+        resultDiv.classList.add('d-none');
+        errorDiv.classList.add('d-none');
+        var duration = document.getElementById('pamDuration').value;
+        $.ajax({
+          type: "POST",
+          url: scriptname + 'pam',
+          data: {
+            duration: duration
+          },
+          dataType: "json",
+          success: function success(data) {
+            if (data.error) {
+              errorMsg.textContent = data.error;
+              errorDiv.classList.remove('d-none');
+            } else {
+              tokenInput.value = data.token;
+              loginSpan.textContent = data.login;
+              var minutes = Math.floor(data.expires_in / 60);
+              var seconds = data.expires_in % 60;
+              expiresSpan.textContent = minutes + ' min ' + (seconds > 0 ? seconds + ' sec' : '');
+              resultDiv.classList.remove('d-none');
+            }
+          },
+          error: function error(xhr, status, _error) {
+            errorMsg.textContent = _error || status;
+            errorDiv.classList.remove('d-none');
+          }
+        });
+      });
+
+      // Copy button
+      if (copyBtn) {
+        copyBtn.addEventListener('click', function () {
+          tokenInput.select();
+          tokenInput.setSelectionRange(0, 99999);
+          navigator.clipboard.writeText(tokenInput.value).then(function () {
+            copyBtn.innerHTML = '<span class="fa fa-check"></span>';
+            setTimeout(function () {
+              copyBtn.innerHTML = '<span class="fa fa-copy"></span>';
+            }, 2000);
+          });
+        });
+      }
+    });
+  })();
+
+})();
diff --git a/lemonldap-ng-portal/site/htdocs/static/common/js/pamaccess.min.js b/lemonldap-ng-portal/site/htdocs/static/common/js/pamaccess.min.js
new file mode 100644
index 000000000..fdec1742d
--- /dev/null
+++ b/lemonldap-ng-portal/site/htdocs/static/common/js/pamaccess.min.js
@@ -0,0 +1 @@
+!function(){"use strict";$(window).on("load",function(){var t,o,a,s,c,e,r,n=document.getElementById("pamTokenForm");n&&(t=document.getElementById("pamTokenResult"),o=document.getElementById("pamTokenError"),a=document.getElementById("pamToken"),s=document.getElementById("pamLogin"),c=document.getElementById("pamExpiresIn"),e=document.getElementById("copyPamToken"),r=document.getElementById("pamErrorMessage"),n.addEventListener("submit",function(e){e.preventDefault(),t.classList.add("d-none"),o.classList.add("d-none");e=document.getElementById("pamDuration").value;$.ajax({type:"POST",url:scriptname+"pam",data:{duration:e},dataType:"json",success:function(e){var n;(e.error?(r.textContent=e.error,o):(a.value=e.token,s.textContent=e.login,n=Math.floor(e.expires_in/60),e=e.expires_in%60,c.textContent=n+" min "+(0<e?e+" sec":""),t)).classList.remove("d-none")},error:function(e,n,t){r.textContent=t||n,o.classList.remove("d-none")}})}),e)&&e.addEventListener("click",function(){a.select(),a.setSelectionRange(0,99999),navigator.clipboard.writeText(a.value).then(function(){e.innerHTML='<span class="fa fa-check"></span>',setTimeout(function(){e.innerHTML='<span class="fa fa-copy"></span>'},2e3)})})})}();
\ No newline at end of file
diff --git a/lemonldap-ng-portal/site/htdocs/static/common/js/pamaccess.min.js.map b/lemonldap-ng-portal/site/htdocs/static/common/js/pamaccess.min.js.map
new file mode 100644
index 000000000..3d7a6691a
--- /dev/null
+++ b/lemonldap-ng-portal/site/htdocs/static/common/js/pamaccess.min.js.map
@@ -0,0 +1 @@
+{"version":3,"sources":["pamaccess.js"],"names":["$","window","on","resultDiv","errorDiv","tokenInput","loginSpan","expiresSpan","copyBtn","errorMsg","form","document","getElementById","addEventListener","e","preventDefault","classList","add","duration","value","ajax","type","url","scriptname","data","dataType","success","minutes","error","textContent","token","login","Math","floor","expires_in","seconds","remove","xhr","status","_error","select","setSelectionRange","navigator","clipboard","writeText","then","innerHTML","setTimeout"],"mappings":"AAAA,CAAA,WACE,aAGEA,EAAEC,MAAM,EAAEC,GAAG,OAAQ,WACnB,IAEIC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EARAC,EAAOC,SAASC,eAAe,cAAc,EAC5CF,IACDP,EAAYQ,SAASC,eAAe,gBAAgB,EACpDR,EAAWO,SAASC,eAAe,eAAe,EAClDP,EAAaM,SAASC,eAAe,UAAU,EAC/CN,EAAYK,SAASC,eAAe,UAAU,EAC9CL,EAAcI,SAASC,eAAe,cAAc,EACpDJ,EAAUG,SAASC,eAAe,cAAc,EAChDH,EAAWE,SAASC,eAAe,iBAAiB,EACxDF,EAAKG,iBAAiB,SAAU,SAAUC,GACxCA,EAAEC,eAAe,EACjBZ,EAAUa,UAAUC,IAAI,QAAQ,EAChCb,EAASY,UAAUC,IAAI,QAAQ,EAC3BC,EAAWP,SAASC,eAAe,aAAa,EAAEO,MACtDnB,EAAEoB,KAAK,CACLC,KAAM,OACNC,IAAKC,WAAa,MAClBC,KAAM,CACJN,SAAUA,CACZ,EACAO,SAAU,OACVC,QAAS,SAAiBF,GACxB,IAMMG,GANFH,EAAKI,OACPnB,EAASoB,YAAcL,EAAKI,MAC5BxB,IAEAC,EAAWc,MAAQK,EAAKM,MACxBxB,EAAUuB,YAAcL,EAAKO,MACzBJ,EAAUK,KAAKC,MAAMT,EAAKU,WAAa,EAAE,EACzCC,EAAUX,EAAKU,WAAa,GAChC3B,EAAYsB,YAAcF,EAAU,SAAqB,EAAVQ,EAAcA,EAAU,OAAS,IAChFhC,IAPSa,UAAUoB,OAAO,QAAQ,CAStC,EACAR,MAAO,SAAeS,EAAKC,EAAQC,GACjC9B,EAASoB,YAAcU,GAAUD,EACjClC,EAASY,UAAUoB,OAAO,QAAQ,CACpC,CACF,CAAC,CACH,CAAC,EAGG5B,IACFA,EAAQK,iBAAiB,QAAS,WAChCR,EAAWmC,OAAO,EAClBnC,EAAWoC,kBAAkB,EAAG,KAAK,EACrCC,UAAUC,UAAUC,UAAUvC,EAAWc,KAAK,EAAE0B,KAAK,WACnDrC,EAAQsC,UAAY,oCACpBC,WAAW,WACTvC,EAAQsC,UAAY,kCACtB,EAAG,GAAI,CACT,CAAC,CACH,CAAC,CAEL,CAAC,CAGJ,EAAE"}
\ No newline at end of file
diff --git a/lemonldap-ng-portal/site/htdocs/static/languages/ar.json b/lemonldap-ng-portal/site/htdocs/static/languages/ar.json
index 176c3aace..b40c34b7c 100644
--- a/lemonldap-ng-portal/site/htdocs/static/languages/ar.json
+++ b/lemonldap-ng-portal/site/htdocs/static/languages/ar.json
@@ -124,6 +124,7 @@
 "authLevel":"مستوى إثبات الهوية",
 "authPortal":"بوابة إثبات الهوية",
 "authRemaining":"٪ s المصادقة المتبقية، غيير كلمة المرور الخاصة بك!",
+"authorize":"Authorize",
 "autoAccept":"تقبل تلقائيا في 30 ثانية",
 "autoGlobalLogout":"تقبل تلقائيا في 30 ثانية",
 "back2CasUrl":"التطبيق الذي قمت بتسجيل الخروج منه للتو قد وفرت وصلة قد ترغب في أن تتبعها",
@@ -149,6 +150,7 @@
 "click2Reset":"انقر هنا لإعادة تعيين كلمة المرور الخاصة بك",
 "clickHere":"الرجاء الضغط هنا",
 "clickOnYubikey":"انقر على Yubikey الخاص بك",
+"clientId":"Client ID",
 "close":"إغلاق",
 "closeSSO":"أغلق جلسة الدخول الموحد (سسو)",
 "code":"الشفرة",
@@ -166,6 +168,13 @@
 "currentPwd":"كلمة المرور الحالية",
 "date":"تاريخ",
 "decryptCipheredValue":"فك تشفير قيمة مشفرة",
+"deny":"Deny",
+"deviceApproved":"Device Approved",
+"deviceApprovedMsg":"The device has been authorized. You can close this window.",
+"deviceAuthorization":"Device Authorization",
+"deviceAuthorizationMsg":"Enter the code displayed on your device to authorize it.",
+"deviceDenied":"Device Denied",
+"deviceDeniedMsg":"The device authorization has been denied. You can close this window.",
 "enterCred":"الرجاء إدخال بيانات الاعتماد الخاصة بك",
 "enterExt2fCode":"تم إرسال رمز إليك. الرجاء إدخاله",
 "enterMail2fCode":"تم ارسال رمز لبريدك الالكتروني. الرجاء ادخاله",
@@ -182,6 +191,7 @@
 "firstName":"الاسم الاول",
 "forbidden":"ممنوع الولوج",
 "forgotPwd":"نسيت كلمة المرور؟",
+"generatePamToken":"Generate Token",
 "generatePwd":"إنشاء كلمة المرور تلقائيا",
 "generic":"معلومات الاتصال",
 "generic2fFormatError":"معلومات اتصالك غير مطابقة للشكل المطلوب",
@@ -266,6 +276,15 @@
 "openidPA":" سياسة استخدام البيانات متوفرة في",
 "openidRpns":"المعايير %s  طلب الاتحاد غير متوف",
 "otherSessions":"جلسات نشطة أخرى",
+"pamAccessInfo":"Generate a temporary token to use as your password for SSH or other PAM-enabled services.",
+"pamAccessTitle":"PAM Access Token",
+"pamExpiresIn":"Expires in",
+"pamInstructions":"Instructions",
+"pamInstructionsText":"Use this token as your password when connecting via SSH or other PAM-enabled services.",
+"pamLogin":"Login",
+"pamTokenDuration":"Token validity",
+"pamTokenError":"Failed to generate token",
+"pamTokenGenerated":"Your temporary token",
 "password":"كلمة المرور",
 "password2f":"كلمة المرور",
 "passwordCompromised":"لم يتم العثور على كلمة المرور في قاعدة بيانات كلمات المرور المخترقة",
@@ -304,6 +323,7 @@
 "removeOtherSessions":"إزالة الجلسات الأخرى",
 "rename":"Rename",
 "renewSession":"تجديد الجلسة",
+"requestedScope":"Requested scope",
 "resendCode":"إعادة إرسال الرمز",
 "resendConfirmMail":"هل تريد إعادة إرسال رسالة التأكيد؟",
 "resendTooSoon":"يرجى الانتظار قليلاً قبل محاولة إعادة إرسال الرمز",
@@ -354,6 +374,8 @@
 "upgradeSession":"ترقية الجلسة",
 "useYubikey":"استخدم اليوبي كي الخاص بك",
 "user":"المستخدم",
+"userCode":"Device Code",
+"userCodeHelp":"Enter the 8-character code shown on your device",
 "validationDate":"تاريخ التحقق",
 "value":"القيمة",
 "verify":"التحقق",
diff --git a/lemonldap-ng-portal/site/htdocs/static/languages/de.json b/lemonldap-ng-portal/site/htdocs/static/languages/de.json
index 71d343c1e..9f6ee5403 100644
--- a/lemonldap-ng-portal/site/htdocs/static/languages/de.json
+++ b/lemonldap-ng-portal/site/htdocs/static/languages/de.json
@@ -124,6 +124,7 @@
 "authLevel":"Authentication level",
 "authPortal":"Authentifizierungsportal",
 "authRemaining":"%sverbleibende Authentifizierungen, bitte Passwort ändern!",
+"authorize":"Authorize",
 "autoAccept":"Automatisch in 30 Sekunden annehmen",
 "autoGlobalLogout":"Automatically global logout in 30 seconds",
 "back2CasUrl":"Die Anwendung, von der Sie sich gerade abgemeldet haben, hat einen Link bereitgestellt, dem Sie folgen sollten",
@@ -149,6 +150,7 @@
 "click2Reset":"Hier klicken, um Ihr Passwort zurückzusetzen.",
 "clickHere":"Bitte hier klicken",
 "clickOnYubikey":"Klicke auf deinen Yubikey",
+"clientId":"Client ID",
 "close":"Close",
 "closeSSO":"Schließe deine SSO-Sitzung",
 "code":"Code",
@@ -166,6 +168,13 @@
 "currentPwd":"Aktuelles Passwort",
 "date":"Datum",
 "decryptCipheredValue":"Decrypt a ciphered value",
+"deny":"Deny",
+"deviceApproved":"Device Approved",
+"deviceApprovedMsg":"The device has been authorized. You can close this window.",
+"deviceAuthorization":"Device Authorization",
+"deviceAuthorizationMsg":"Enter the code displayed on your device to authorize it.",
+"deviceDenied":"Device Denied",
+"deviceDeniedMsg":"The device authorization has been denied. You can close this window.",
 "enterCred":"Bitte geben deine Zugangsdaten ein",
 "enterExt2fCode":"Ein Code wurde an dich gesendet. Bitte gebe diesen ein",
 "enterMail2fCode":"A code has been sent to your email address. Please enter it",
@@ -182,6 +191,7 @@
 "firstName":"Vorname",
 "forbidden":"Access FORBIDDEN",
 "forgotPwd":"Passwort vergessen ?",
+"generatePamToken":"Generate Token",
 "generatePwd":"Passwort automatisch generieren",
 "generic":"Contact information",
 "generic2fFormatError":"Your contact information does not match the required format",
@@ -266,6 +276,15 @@
 "openidPA":"Die Datennutzungsrichtlinie ist verfügbar unter",
 "openidRpns":"Der für den Verbund angeforderte Parameter %s ist nicht verfügbar",
 "otherSessions":"Andere aktive Sitzungen",
+"pamAccessInfo":"Generate a temporary token to use as your password for SSH or other PAM-enabled services.",
+"pamAccessTitle":"PAM Access Token",
+"pamExpiresIn":"Expires in",
+"pamInstructions":"Instructions",
+"pamInstructionsText":"Use this token as your password when connecting via SSH or other PAM-enabled services.",
+"pamLogin":"Login",
+"pamTokenDuration":"Token validity",
+"pamTokenError":"Failed to generate token",
+"pamTokenGenerated":"Your temporary token",
 "password":"Passwort",
 "password2f":"Passwort",
 "passwordCompromised":"Not found in a compromised password database",
@@ -304,6 +323,7 @@
 "removeOtherSessions":"Andere Sitzungen löschen",
 "rename":"Rename",
 "renewSession":"Renew session",
+"requestedScope":"Requested scope",
 "resendCode":"Re-send code",
 "resendConfirmMail":"Bestätigungsmail erneuert senden ?",
 "resendTooSoon":"Please wait a little longer before trying to re-send the code",
@@ -354,6 +374,8 @@
 "upgradeSession":"Upgrade session",
 "useYubikey":"Benutze deinen Yubikey",
 "user":"Benutzer",
+"userCode":"Device Code",
+"userCodeHelp":"Enter the 8-character code shown on your device",
 "validationDate":"Validation date",
 "value":"Value",
 "verify":"Verify",
diff --git a/lemonldap-ng-portal/site/htdocs/static/languages/en.json b/lemonldap-ng-portal/site/htdocs/static/languages/en.json
index 033abb15e..feb4ebdd0 100644
--- a/lemonldap-ng-portal/site/htdocs/static/languages/en.json
+++ b/lemonldap-ng-portal/site/htdocs/static/languages/en.json
@@ -124,6 +124,7 @@
 "authLevel":"Authentication level",
 "authPortal":"Authentication portal",
 "authRemaining":"%s authentications remaining, change your password!",
+"authorize":"Authorize",
 "autoAccept":"Automatically accept in 30 seconds",
 "autoGlobalLogout":"Automatically global logout in 30 seconds",
 "back2CasUrl":"The application you just logged out of has provided a link it would like you to follow",
@@ -149,6 +150,7 @@
 "click2Reset":"Click here to reset your password",
 "clickHere":"Please click here",
 "clickOnYubikey":"Click on your Yubikey",
+"clientId":"Client ID",
 "close":"Close",
 "closeSSO":"Close your SSO session",
 "code":"Code",
@@ -166,6 +168,13 @@
 "currentPwd":"Current password",
 "date":"Date",
 "decryptCipheredValue":"Decrypt a ciphered value",
+"deny":"Deny",
+"deviceApproved":"Device Approved",
+"deviceApprovedMsg":"The device has been authorized. You can close this window.",
+"deviceAuthorization":"Device Authorization",
+"deviceAuthorizationMsg":"Enter the code displayed on your device to authorize it.",
+"deviceDenied":"Device Denied",
+"deviceDeniedMsg":"The device authorization has been denied. You can close this window.",
 "enterCred":"Please enter your credentials",
 "enterExt2fCode":"A code has been sent to you. Please enter it",
 "enterMail2fCode":"A code has been sent to your email address. Please enter it",
@@ -182,6 +191,7 @@
 "firstName":"First name",
 "forbidden":"Access FORBIDDEN",
 "forgotPwd":"Forgot your password?",
+"generatePamToken":"Generate Token",
 "generatePwd":"Generate the password automatically",
 "generic":"Contact information",
 "generic2fFormatError":"Your contact information does not match the required format",
@@ -266,6 +276,15 @@
 "openidPA":"Data usage policy is available at",
 "openidRpns":"Parameter %s requested for federation isn't available",
 "otherSessions":"Other active sessions",
+"pamAccessInfo":"Generate a temporary token to use as your password for SSH or other PAM-enabled services.",
+"pamAccessTitle":"PAM Access Token",
+"pamExpiresIn":"Expires in",
+"pamInstructions":"Instructions",
+"pamInstructionsText":"Use this token as your password when connecting via SSH or other PAM-enabled services.",
+"pamLogin":"Login",
+"pamTokenDuration":"Token validity",
+"pamTokenError":"Failed to generate token",
+"pamTokenGenerated":"Your temporary token",
 "password":"Password",
 "password2f":"Password",
 "passwordCompromised":"Not found in a compromised password database",
@@ -304,6 +323,7 @@
 "removeOtherSessions":"Remove other sessions",
 "rename":"Rename",
 "renewSession":"Renew session",
+"requestedScope":"Requested scope",
 "resendCode":"Re-send code",
 "resendConfirmMail":"Resend confirmation mail?",
 "resendTooSoon":"Please wait a little longer before trying to re-send the code",
@@ -354,6 +374,8 @@
 "upgradeSession":"Upgrade session",
 "useYubikey":"use your Yubikey",
 "user":"User",
+"userCode":"Device Code",
+"userCodeHelp":"Enter the 8-character code shown on your device",
 "validationDate":"Validation date",
 "value":"Value",
 "verify":"Verify",
diff --git a/lemonldap-ng-portal/site/htdocs/static/languages/es.json b/lemonldap-ng-portal/site/htdocs/static/languages/es.json
index 05f30d5ec..98ec0da1d 100644
--- a/lemonldap-ng-portal/site/htdocs/static/languages/es.json
+++ b/lemonldap-ng-portal/site/htdocs/static/languages/es.json
@@ -124,6 +124,7 @@
 "authLevel":"Nivel de autentificación",
 "authPortal":"Portal de autenticación",
 "authRemaining":"%s autenticaciones restantes, ¡cambie su contraseña!",
+"authorize":"Authorize",
 "autoAccept":"Aceptar automáticamente en 30 segundos ",
 "autoGlobalLogout":"Desconexión global automática en 30 segundos",
 "back2CasUrl":"La aplicación de la cual se acaba de desconectar le ha enviado un enlace y le gustaría que lo siguiese",
@@ -149,6 +150,7 @@
 "click2Reset":"Pulse aquí para restaurar el password",
 "clickHere":"Por favor haga clic aquí",
 "clickOnYubikey":"Haga clic en su Yubikey",
+"clientId":"Client ID",
 "close":"Close",
 "closeSSO":"Cierre su sesión SSO",
 "code":"Código",
@@ -166,6 +168,13 @@
 "currentPwd":"Contraseña actual",
 "date":"Fecha",
 "decryptCipheredValue":"Desencriptar un valor cifrado",
+"deny":"Deny",
+"deviceApproved":"Device Approved",
+"deviceApprovedMsg":"The device has been authorized. You can close this window.",
+"deviceAuthorization":"Device Authorization",
+"deviceAuthorizationMsg":"Enter the code displayed on your device to authorize it.",
+"deviceDenied":"Device Denied",
+"deviceDeniedMsg":"The device authorization has been denied. You can close this window.",
 "enterCred":"Por favor ingrese sus credenciales",
 "enterExt2fCode":"Un código le ha sido enviado. Por favor ingréselo ",
 "enterMail2fCode":"Un código le ha sido enviado a dirección de e-mail. Por favor ingréselo",
@@ -182,6 +191,7 @@
 "firstName":"Nombre",
 "forbidden":"Acceso DENEGADO",
 "forgotPwd":"Contraseña olvidada?",
+"generatePamToken":"Generate Token",
 "generatePwd":"Generar la contraseña automáticamente",
 "generic":"Contact information",
 "generic2fFormatError":"Your contact information does not match the required format",
@@ -266,6 +276,15 @@
 "openidPA":"La política de uso de datos está disponible en",
 "openidRpns":"El parámetro %s solicitado por la agrupación no está disponible",
 "otherSessions":"Otras sesiones activas",
+"pamAccessInfo":"Generate a temporary token to use as your password for SSH or other PAM-enabled services.",
+"pamAccessTitle":"PAM Access Token",
+"pamExpiresIn":"Expires in",
+"pamInstructions":"Instructions",
+"pamInstructionsText":"Use this token as your password when connecting via SSH or other PAM-enabled services.",
+"pamLogin":"Login",
+"pamTokenDuration":"Token validity",
+"pamTokenError":"Failed to generate token",
+"pamTokenGenerated":"Your temporary token",
 "password":"Contraseña",
 "password2f":"Contraseña",
 "passwordCompromised":"Not found in a compromised password database",
@@ -304,6 +323,7 @@
 "removeOtherSessions":"Suprimir las otras sesiones",
 "rename":"Rename",
 "renewSession":"Renew session",
+"requestedScope":"Requested scope",
 "resendCode":"Re-send code",
 "resendConfirmMail":"¿Reenviar e-mail de confirmación?",
 "resendTooSoon":"Please wait a little longer before trying to re-send the code",
@@ -354,6 +374,8 @@
 "upgradeSession":"Actualizar la sesión",
 "useYubikey":"utilice su Yubikey",
 "user":"Usuario",
+"userCode":"Device Code",
+"userCodeHelp":"Enter the 8-character code shown on your device",
 "validationDate":"Validation date",
 "value":"Valor",
 "verify":"Verificar",
diff --git a/lemonldap-ng-portal/site/htdocs/static/languages/fi.json b/lemonldap-ng-portal/site/htdocs/static/languages/fi.json
index dbdfc5b1e..30ef30cc0 100644
--- a/lemonldap-ng-portal/site/htdocs/static/languages/fi.json
+++ b/lemonldap-ng-portal/site/htdocs/static/languages/fi.json
@@ -124,6 +124,7 @@
 "authLevel":"Tunnistautumistaso",
 "authPortal":"Todentautumisportaali",
 "authRemaining":"%s todentautumista jäljellä, vaihda salasanasi!",
+"authorize":"Authorize",
 "autoAccept":"Hyväksytään automaattisesti 30 sekunnissa",
 "autoGlobalLogout":"Kirjaudutaan automaattisesti ulos kaikista istunnoista 30 sekunnissa",
 "back2CasUrl":"Sovellus, josta juuri kirjauduit ulos, tarjosi linkin, jota se haluaisi sinun seuraavan",
@@ -149,6 +150,7 @@
 "click2Reset":"Napsauta tästä nollataksesi salasanasi",
 "clickHere":"Napsauta tästä",
 "clickOnYubikey":"Kosketa Yubikeytäsi",
+"clientId":"Client ID",
 "close":"Sulje",
 "closeSSO":"Sulje kertakirjautumisistuntosi",
 "code":"Koodi",
@@ -166,6 +168,13 @@
 "currentPwd":"Nykyinen salasana",
 "date":"Päivämäärä",
 "decryptCipheredValue":"Pura koodattu arvo",
+"deny":"Deny",
+"deviceApproved":"Device Approved",
+"deviceApprovedMsg":"The device has been authorized. You can close this window.",
+"deviceAuthorization":"Device Authorization",
+"deviceAuthorizationMsg":"Enter the code displayed on your device to authorize it.",
+"deviceDenied":"Device Denied",
+"deviceDeniedMsg":"The device authorization has been denied. You can close this window.",
 "enterCred":"Anna tunnistautumistietosi",
 "enterExt2fCode":"Koodi on lähetetty sinulle. Ole hyvä ja anna se",
 "enterMail2fCode":"Koodi on lähetetty sähköpostiisi. Ole hyvä ja anna se",
@@ -182,6 +191,7 @@
 "firstName":"Etunimi",
 "forbidden":"Pääsy KIELLETTY",
 "forgotPwd":"Unohditko salasanasi?",
+"generatePamToken":"Generate Token",
 "generatePwd":"Luo salasana automaattisesti",
 "generic":"Yhteystieto",
 "generic2fFormatError":"Yhteystietosi eivät vastaa vaadittua muotoa",
@@ -266,6 +276,15 @@
 "openidPA":"Tietosuojakäytänne on saatavissa osoitteesta",
 "openidRpns":"Luottamusverkostoa varten pyydetty parametri %s ei ole saatavilla",
 "otherSessions":"Muut aktiiviset istunnot",
+"pamAccessInfo":"Generate a temporary token to use as your password for SSH or other PAM-enabled services.",
+"pamAccessTitle":"PAM Access Token",
+"pamExpiresIn":"Expires in",
+"pamInstructions":"Instructions",
+"pamInstructionsText":"Use this token as your password when connecting via SSH or other PAM-enabled services.",
+"pamLogin":"Login",
+"pamTokenDuration":"Token validity",
+"pamTokenError":"Failed to generate token",
+"pamTokenGenerated":"Your temporary token",
 "password":"Salasana",
 "password2f":"Salasana",
 "passwordCompromised":"Ei löydy vaarantuneiden salasanojen tietokannasta",
@@ -304,6 +323,7 @@
 "removeOtherSessions":"Poista muut istunnot",
 "rename":"Rename",
 "renewSession":"Uudista istunto",
+"requestedScope":"Requested scope",
 "resendCode":"Lähetä koodi uudestaan",
 "resendConfirmMail":"Lähetä vahvistussähköposti uudestaan?",
 "resendTooSoon":"Ole hyvä ja odota vähän pidempään ennen kuin yrität lähettää koodia uudestaan",
@@ -354,6 +374,8 @@
 "upgradeSession":"Ylennä istunto",
 "useYubikey":"Käytä Yubikeytä",
 "user":"Käyttäjä",
+"userCode":"Device Code",
+"userCodeHelp":"Enter the 8-character code shown on your device",
 "validationDate":"Vahvistuspäivämäärä",
 "value":"Arvo",
 "verify":"Vahvista",
diff --git a/lemonldap-ng-portal/site/htdocs/static/languages/fr.json b/lemonldap-ng-portal/site/htdocs/static/languages/fr.json
index e8baa641d..9321d1abf 100644
--- a/lemonldap-ng-portal/site/htdocs/static/languages/fr.json
+++ b/lemonldap-ng-portal/site/htdocs/static/languages/fr.json
@@ -124,6 +124,7 @@
 "authLevel":"Niveau d'authentification",
 "authPortal":"Portail d'authentification",
 "authRemaining":"%s authentifications restantes, changez votre mot de passe !",
+"authorize":"Autoriser",
 "autoAccept":"Acceptation automatique dans 30 secondes",
 "autoGlobalLogout":"Déconnexion globale automatique dans 30 secondes",
 "back2CasUrl":"Le service duquel vous arrivez a fourni un lien que vous êtes invité à suivre",
@@ -149,6 +150,7 @@
 "click2Reset":"Cliquez ici pour réinitialiser votre mot de passe",
 "clickHere":"Cliquez ici",
 "clickOnYubikey":"Cliquez sur votre Yubikey",
+"clientId":"ID Client",
 "close":"Fermer",
 "closeSSO":"Fermer votre Session SSO",
 "code":"Code",
@@ -166,6 +168,13 @@
 "currentPwd":"Mot de passe actuel",
 "date":"Date",
 "decryptCipheredValue":"Décoder une valeur chiffrée",
+"deny":"Refuser",
+"deviceApproved":"Appareil approuvé",
+"deviceApprovedMsg":"L'appareil a été autorisé. Vous pouvez fermer cette fenêtre.",
+"deviceAuthorization":"Autorisation d'appareil",
+"deviceAuthorizationMsg":"Entrez le code affiché sur votre appareil pour l'autoriser.",
+"deviceDenied":"Appareil refusé",
+"deviceDeniedMsg":"L'autorisation de l'appareil a été refusée. Vous pouvez fermer cette fenêtre.",
 "enterCred":"Merci de vous authentifier",
 "enterExt2fCode":"Un code vous a été envoyé, entrez-le ici",
 "enterMail2fCode":"Un code vous a été envoyé par mail, entrez-le ici",
@@ -182,6 +191,7 @@
 "firstName":"Prénom",
 "forbidden":"Accès INTERDIT",
 "forgotPwd":"Mot de passe oublié ?",
+"generatePamToken":"Générer un token",
 "generatePwd":"Générer le mot de passe automatiquement",
 "generic":"Information de contact",
 "generic2fFormatError":"Vos informations de contact ne correspondent pas au format attendu",
@@ -266,6 +276,15 @@
 "openidPA":"La politique d'utilisation des données est disponible ici",
 "openidRpns":"Le paramètre %s exigé pour la fédération n'est pas disponible",
 "otherSessions":"Autres sessions ouvertes",
+"pamAccessInfo":"Générez un token temporaire à utiliser comme mot de passe pour SSH ou d'autres services PAM.",
+"pamAccessTitle":"Token d'accès PAM",
+"pamExpiresIn":"Expire dans",
+"pamInstructions":"Instructions",
+"pamInstructionsText":"Utilisez ce token comme mot de passe lors de la connexion via SSH ou d'autres services PAM.",
+"pamLogin":"Identifiant",
+"pamTokenDuration":"Durée de validité",
+"pamTokenError":"Échec de la génération du token",
+"pamTokenGenerated":"Votre token temporaire",
 "password":"Mot de passe",
 "password2f":"Mot de passe",
 "passwordCompromised":"Absent d'une base de mots de passe compromis",
@@ -304,6 +323,7 @@
 "removeOtherSessions":"Fermer les autres sessions",
 "rename":"Renommer",
 "renewSession":"Renouveler la session",
+"requestedScope":"Scope demandé",
 "resendCode":"Renvoyer le code",
 "resendConfirmMail":"Renvoyer le mail de confirmation ?",
 "resendTooSoon":"Veuillez patienter encore un peu avant de demander la retransmission du code",
@@ -354,6 +374,8 @@
 "upgradeSession":"Se réauthentifier",
 "useYubikey":"Utilisez votre Yubikey",
 "user":"Utilisateur",
+"userCode":"Code de l'appareil",
+"userCodeHelp":"Entrez le code à 8 caractères affiché sur votre appareil",
 "validationDate":"Date de validation",
 "value":"Valeur",
 "verify":"Vérifier",
diff --git a/lemonldap-ng-portal/site/htdocs/static/languages/he.json b/lemonldap-ng-portal/site/htdocs/static/languages/he.json
index fd44500d4..ef6777f18 100644
--- a/lemonldap-ng-portal/site/htdocs/static/languages/he.json
+++ b/lemonldap-ng-portal/site/htdocs/static/languages/he.json
@@ -124,6 +124,7 @@
 "authLevel":"רמת אימות",
 "authPortal":"שער אימות",
 "authRemaining":"%s ניסיונות אימות נותרו, נא להחליף את הסיסמה שלך!",
+"authorize":"Authorize",
 "autoAccept":"לקבל אוטומטית תוך 30 שניות",
 "autoGlobalLogout":"יציאה גלובלית מהמערכת תוך 30 שניות",
 "back2CasUrl":"היישום שיצאת ממנו סיפק קישור שהוא היה רוצה שתיגש אליו",
@@ -149,6 +150,7 @@
 "click2Reset":"לחיצה כאן לאיפוס הסיסמה שלך",
 "clickHere":"נא ללחוץ כאן",
 "clickOnYubikey":"יש ללחוץ על ה־Yubikey שלך",
+"clientId":"Client ID",
 "close":"סגירה",
 "closeSSO":"סגירת הפעלת ה־SSO שלך",
 "code":"קוד",
@@ -166,6 +168,13 @@
 "currentPwd":"סיסמה נוכחית",
 "date":"תאריך",
 "decryptCipheredValue":"פענוח ערך מוצפן",
+"deny":"Deny",
+"deviceApproved":"Device Approved",
+"deviceApprovedMsg":"The device has been authorized. You can close this window.",
+"deviceAuthorization":"Device Authorization",
+"deviceAuthorizationMsg":"Enter the code displayed on your device to authorize it.",
+"deviceDenied":"Device Denied",
+"deviceDeniedMsg":"The device authorization has been denied. You can close this window.",
 "enterCred":"נא למלא את פרטי הגישה שלך",
 "enterExt2fCode":"נשלח אליך קוד. נא להקליד אותו",
 "enterMail2fCode":"נשלח קוד לכתובת הדוא״ל שלך. נא להקליד אותו",
@@ -182,6 +191,7 @@
 "firstName":"שם פרטי",
 "forbidden":"הגישה נדחתה",
 "forgotPwd":"שכחת את הסיסמה שלך?",
+"generatePamToken":"Generate Token",
 "generatePwd":"יצירת סיסמה אוטומטית",
 "generic":"פרטי יצירת קשר",
 "generic2fFormatError":"פרטי הקשר שלך לא תואמים לתבנית הנחוצה",
@@ -266,6 +276,15 @@
 "openidPA":"מדיניות השימוש בנתונים זמינה תחת",
 "openidRpns":"המשתנה %s נחוץ שאיחוד אינו זמין",
 "otherSessions":"הפעלות פעילות נוספות",
+"pamAccessInfo":"Generate a temporary token to use as your password for SSH or other PAM-enabled services.",
+"pamAccessTitle":"PAM Access Token",
+"pamExpiresIn":"Expires in",
+"pamInstructions":"Instructions",
+"pamInstructionsText":"Use this token as your password when connecting via SSH or other PAM-enabled services.",
+"pamLogin":"Login",
+"pamTokenDuration":"Token validity",
+"pamTokenError":"Failed to generate token",
+"pamTokenGenerated":"Your temporary token",
 "password":"סיסמה",
 "password2f":"סיסמה",
 "passwordCompromised":"לא נמצאה במסד נתוני הסיסמאות שדלפו",
@@ -304,6 +323,7 @@
 "removeOtherSessions":"הסרת הפעלות אחרות",
 "rename":"Rename",
 "renewSession":"חידוש הפעלה",
+"requestedScope":"Requested scope",
 "resendCode":"לשלוח את הקוד מחדש",
 "resendConfirmMail":"לשלוח את הודעת האימות שוב?",
 "resendTooSoon":"נא להמתין זמן ארוך יותר בטרם ניסיון שליחת הקוד מחדש",
@@ -354,6 +374,8 @@
 "upgradeSession":"שדרוג הפעלה",
 "useYubikey":"שימוש ב־Yubikey שלך",
 "user":"משתמש",
+"userCode":"Device Code",
+"userCodeHelp":"Enter the 8-character code shown on your device",
 "validationDate":"תאריך תיקוף",
 "value":"ערך",
 "verify":"אימות",
diff --git a/lemonldap-ng-portal/site/htdocs/static/languages/it.json b/lemonldap-ng-portal/site/htdocs/static/languages/it.json
index eb795ded4..d2de8a836 100644
--- a/lemonldap-ng-portal/site/htdocs/static/languages/it.json
+++ b/lemonldap-ng-portal/site/htdocs/static/languages/it.json
@@ -124,6 +124,7 @@
 "authLevel":"Livello di autenticazione",
 "authPortal":"Portale di autenticazione",
 "authRemaining":"Rimangono ancora %s autenticazioni, modifica la password!",
+"authorize":"Authorize",
 "autoAccept":"Accetta automaticamente in 30 secondi",
 "autoGlobalLogout":"Logout globale automatico in 30 secondi",
 "back2CasUrl":"L'applicazione dalla quale ti sei appena sconnesso ha fornito un link che dovresti seguire",
@@ -149,6 +150,7 @@
 "click2Reset":"Clicca qui per reimpostare la password",
 "clickHere":"Per favore clicca qui",
 "clickOnYubikey":"Clicca sulla tua Yubikey",
+"clientId":"Client ID",
 "close":"Close",
 "closeSSO":"Chiudi la sessione SSO",
 "code":"Codice",
@@ -166,6 +168,13 @@
 "currentPwd":"Password attuale",
 "date":"Data",
 "decryptCipheredValue":"Decripta un valore cifrato",
+"deny":"Deny",
+"deviceApproved":"Device Approved",
+"deviceApprovedMsg":"The device has been authorized. You can close this window.",
+"deviceAuthorization":"Device Authorization",
+"deviceAuthorizationMsg":"Enter the code displayed on your device to authorize it.",
+"deviceDenied":"Device Denied",
+"deviceDeniedMsg":"The device authorization has been denied. You can close this window.",
 "enterCred":"Inserisci le tue credenziali",
 "enterExt2fCode":"Un codice vi é stato inviato. Inseritelo",
 "enterMail2fCode":"Un codice é stato inviato alla vostra casella email. Inseritelo",
@@ -182,6 +191,7 @@
 "firstName":"Nome",
 "forbidden":"Accesso VIETATO",
 "forgotPwd":"Password dimenticata?",
+"generatePamToken":"Generate Token",
 "generatePwd":"Generare automaticamente la password",
 "generic":"Informazioni di contatto",
 "generic2fFormatError":"Le informazioni di contatto non corrispondono al formato richiesto",
@@ -266,6 +276,15 @@
 "openidPA":"La politica di utilizzo dei dati è disponibile all'indirizzo",
 "openidRpns":"Il parametro %s richiesto per la federazione non è disponibile",
 "otherSessions":"Altre sessioni attive",
+"pamAccessInfo":"Generate a temporary token to use as your password for SSH or other PAM-enabled services.",
+"pamAccessTitle":"PAM Access Token",
+"pamExpiresIn":"Expires in",
+"pamInstructions":"Instructions",
+"pamInstructionsText":"Use this token as your password when connecting via SSH or other PAM-enabled services.",
+"pamLogin":"Login",
+"pamTokenDuration":"Token validity",
+"pamTokenError":"Failed to generate token",
+"pamTokenGenerated":"Your temporary token",
 "password":"Password",
 "password2f":"Password",
 "passwordCompromised":"Non trovato in un database di password compromesse",
@@ -304,6 +323,7 @@
 "removeOtherSessions":"Rimuovere altre sessioni",
 "rename":"Rename",
 "renewSession":"Rinnova la sessione",
+"requestedScope":"Requested scope",
 "resendCode":"Reinvio del codice",
 "resendConfirmMail":"Inviare nuovamente mail di conferma?",
 "resendTooSoon":"Attendere ancora un po' prima di provare a inviare nuovamente il codice",
@@ -354,6 +374,8 @@
 "upgradeSession":"Sessione di aggiornamento",
 "useYubikey":"Usa la tua Yubikey",
 "user":"Utente",
+"userCode":"Device Code",
+"userCodeHelp":"Enter the 8-character code shown on your device",
 "validationDate":"Data di validazione",
 "value":"Valore",
 "verify":"Verifica",
diff --git a/lemonldap-ng-portal/site/htdocs/static/languages/mfe.json b/lemonldap-ng-portal/site/htdocs/static/languages/mfe.json
index 3ef9ad605..8de1214f8 100644
--- a/lemonldap-ng-portal/site/htdocs/static/languages/mfe.json
+++ b/lemonldap-ng-portal/site/htdocs/static/languages/mfe.json
@@ -124,6 +124,7 @@
 "authLevel":"Nivo otantifikasion",
 "authPortal":"Portay otantifikasion",
 "authRemaining":"%s otantifikasion ki reste, sanz ou modpas!",
+"authorize":"Authorize",
 "autoAccept":"Aksepte otomatikman dan 30 segonn",
 "autoGlobalLogout":"Logout globalman otomatikman dan 30 segonn",
 "back2CasUrl":"Aplikasion kot ou fek dekonekte finn donn enn lien pou ou swiv",
@@ -149,6 +150,7 @@
 "click2Reset":"Klik isi pou reset ou modpas",
 "clickHere":"Klik isi silvouple",
 "clickOnYubikey":"Klik lor ou Yubikey",
+"clientId":"Client ID",
 "close":"Ferme",
 "closeSSO":"Ferm ou sesion SSO",
 "code":"Kod",
@@ -166,6 +168,13 @@
 "currentPwd":"Modpas aktiel",
 "date":"Dat",
 "decryptCipheredValue":"Desifre enn valer kode",
+"deny":"Deny",
+"deviceApproved":"Device Approved",
+"deviceApprovedMsg":"The device has been authorized. You can close this window.",
+"deviceAuthorization":"Device Authorization",
+"deviceAuthorizationMsg":"Enter the code displayed on your device to authorize it.",
+"deviceDenied":"Device Denied",
+"deviceDeniedMsg":"The device authorization has been denied. You can close this window.",
 "enterCred":"Silvouple rant ou bann idantifian",
 "enterExt2fCode":"Finn avoy ou enn kod. Met li silvouple",
 "enterMail2fCode":"Finn avoy enn kod lor ou ladres email. Met li silvouple",
@@ -182,6 +191,7 @@
 "firstName":"Prenom",
 "forbidden":"Akse INTERDI",
 "forgotPwd":"Finn bliye ou modpas?",
+"generatePamToken":"Generate Token",
 "generatePwd":"Zener modpas-la otomatikman",
 "generic":"Bann linformasion kontak",
 "generic2fFormatError":"Ou bann linformasion kontak pa koresponn avek format neseser",
@@ -266,6 +276,15 @@
 "openidPA":"Polisi itilizasion done disponib lor",
 "openidRpns":"Paramet %s ki finn demande pou federasion pa disponib",
 "otherSessions":"Bann lezot sesion aktif",
+"pamAccessInfo":"Generate a temporary token to use as your password for SSH or other PAM-enabled services.",
+"pamAccessTitle":"PAM Access Token",
+"pamExpiresIn":"Expires in",
+"pamInstructions":"Instructions",
+"pamInstructionsText":"Use this token as your password when connecting via SSH or other PAM-enabled services.",
+"pamLogin":"Login",
+"pamTokenDuration":"Token validity",
+"pamTokenError":"Failed to generate token",
+"pamTokenGenerated":"Your temporary token",
 "password":"Modpas",
 "password2f":"Modpas",
 "passwordCompromised":"Pa finn trouve dan enn baz done bann modpas ki finn konpromi",
@@ -304,6 +323,7 @@
 "removeOtherSessions":"Retir bann lezot sesion",
 "rename":"Rename",
 "renewSession":"Renouvle sesion",
+"requestedScope":"Requested scope",
 "resendCode":"Re-avoy kod",
 "resendConfirmMail":"Re-avoy bann mail konfirmasion?",
 "resendTooSoon":"Silvouple atann inpe plis avan sey re-avoy kod-la",
@@ -354,6 +374,8 @@
 "upgradeSession":"Sesion ameliorasion",
 "useYubikey":"servi ou Yubikey",
 "user":"Itilizater",
+"userCode":"Device Code",
+"userCodeHelp":"Enter the 8-character code shown on your device",
 "validationDate":"Dat validasion",
 "value":"Valer",
 "verify":"Verifie",
diff --git a/lemonldap-ng-portal/site/htdocs/static/languages/pl.json b/lemonldap-ng-portal/site/htdocs/static/languages/pl.json
index 334f33005..a6a0936bc 100644
--- a/lemonldap-ng-portal/site/htdocs/static/languages/pl.json
+++ b/lemonldap-ng-portal/site/htdocs/static/languages/pl.json
@@ -124,6 +124,7 @@
 "authLevel":"Poziom uwierzytelnienia",
 "authPortal":"Portal uwierzytelniania",
 "authRemaining":"Pozostało %s uwierzytelnień, zmień hasło!",
+"authorize":"Authorize",
 "autoAccept":"Automatycznie zaakceptuj w ciągu 30 sekund",
 "autoGlobalLogout":"Automatyczne globalne wylogowanie w ciągu 30 sekund",
 "back2CasUrl":"Aplikacja, z której właśnie się wylogowałeś, udostępniała link, który chciałeś śledzić",
@@ -149,6 +150,7 @@
 "click2Reset":"Kliknij tu, by zresetować swoje hasło",
 "clickHere":"Kliknij tutaj",
 "clickOnYubikey":"Aktywuj swój Yubikey",
+"clientId":"Client ID",
 "close":"Zamknij",
 "closeSSO":"Zamknij sesję logowania jednokrotnego",
 "code":"Kod",
@@ -166,6 +168,13 @@
 "currentPwd":"Aktualne hasło",
 "date":"Data",
 "decryptCipheredValue":"Odszyfruj zaszyfrowaną wartość",
+"deny":"Deny",
+"deviceApproved":"Device Approved",
+"deviceApprovedMsg":"The device has been authorized. You can close this window.",
+"deviceAuthorization":"Device Authorization",
+"deviceAuthorizationMsg":"Enter the code displayed on your device to authorize it.",
+"deviceDenied":"Device Denied",
+"deviceDeniedMsg":"The device authorization has been denied. You can close this window.",
 "enterCred":"Proszę podać swoje dane uwierzytelniające",
 "enterExt2fCode":"Kod został wysłany do ciebie. Proszę go teraz wpisać",
 "enterMail2fCode":"Kod został wysłany na twój adres e-mail. Proszę go teraz wpisać",
@@ -182,6 +191,7 @@
 "firstName":"Imię",
 "forbidden":"Dostęp ZABRONIONY",
 "forgotPwd":"Zapomniałeś hasła?",
+"generatePamToken":"Generate Token",
 "generatePwd":"Wygeneruj hasło automatycznie",
 "generic":"Informacje kontaktowe",
 "generic2fFormatError":"Twoje dane kontaktowe nie pasują do wymaganego formatu",
@@ -266,6 +276,15 @@
 "openidPA":"Polityka przetwarzania danych jest dostępna pod adresem",
 "openidRpns":"Parametr %s wymagany dla federacji jest niedostępny",
 "otherSessions":"Inne aktywne sesje",
+"pamAccessInfo":"Generate a temporary token to use as your password for SSH or other PAM-enabled services.",
+"pamAccessTitle":"PAM Access Token",
+"pamExpiresIn":"Expires in",
+"pamInstructions":"Instructions",
+"pamInstructionsText":"Use this token as your password when connecting via SSH or other PAM-enabled services.",
+"pamLogin":"Login",
+"pamTokenDuration":"Token validity",
+"pamTokenError":"Failed to generate token",
+"pamTokenGenerated":"Your temporary token",
 "password":"Hasło",
 "password2f":"Hasło",
 "passwordCompromised":"Nie znaleziono w przejętej bazie danych haseł",
@@ -304,6 +323,7 @@
 "removeOtherSessions":"Usuń inne sesje",
 "rename":"Rename",
 "renewSession":"Odnów sesję",
+"requestedScope":"Requested scope",
 "resendCode":"Ponownie wyślij kod",
 "resendConfirmMail":"Czy wysłać ponownie wiadomość z potwierdzeniem?",
 "resendTooSoon":"Poczekaj trochę dłużej, zanim spróbujesz ponownie wysłać kod",
@@ -354,6 +374,8 @@
 "upgradeSession":"Aktualizacja sesji",
 "useYubikey":"użyj swojego Yubikey",
 "user":"Użytkownik",
+"userCode":"Device Code",
+"userCodeHelp":"Enter the 8-character code shown on your device",
 "validationDate":"Data walidacji",
 "value":"Wartość",
 "verify":"Zweryfikuj",
diff --git a/lemonldap-ng-portal/site/htdocs/static/languages/pt.json b/lemonldap-ng-portal/site/htdocs/static/languages/pt.json
index e8003e4f9..79e7df56d 100644
--- a/lemonldap-ng-portal/site/htdocs/static/languages/pt.json
+++ b/lemonldap-ng-portal/site/htdocs/static/languages/pt.json
@@ -124,6 +124,7 @@
 "authLevel":"Nível de autenticação",
 "authPortal":"Portal de autenticação",
 "authRemaining":"%sautenticações restantes, altere sua senha!",
+"authorize":"Authorize",
 "autoAccept":"Aceitar automaticamente em 30 segundos",
 "autoGlobalLogout":"Logout global automático em 30 segundos",
 "back2CasUrl":"O aplicativo do qual você acabou de sair forneceu um link que gostaria que você seguisse",
@@ -149,6 +150,7 @@
 "click2Reset":"Clique aqui para renovar a sua senha",
 "clickHere":"Por favor, clique aqui",
 "clickOnYubikey":"Clique no seu Yubikey",
+"clientId":"Client ID",
 "close":"Fechar",
 "closeSSO":"Feche sua sessão SSO",
 "code":"Código",
@@ -166,6 +168,13 @@
 "currentPwd":"Senha atual",
 "date":"Data",
 "decryptCipheredValue":"Descriptografar um valor cifrado",
+"deny":"Deny",
+"deviceApproved":"Device Approved",
+"deviceApprovedMsg":"The device has been authorized. You can close this window.",
+"deviceAuthorization":"Device Authorization",
+"deviceAuthorizationMsg":"Enter the code displayed on your device to authorize it.",
+"deviceDenied":"Device Denied",
+"deviceDeniedMsg":"The device authorization has been denied. You can close this window.",
 "enterCred":"Por favor insira suas credenciais",
 "enterExt2fCode":"Um código foi enviado para você. Por favor o insira",
 "enterMail2fCode":"Um código foi enviado para o seu endereço de e-mail. Por favor o insira",
@@ -182,6 +191,7 @@
 "firstName":"Primeiro nome",
 "forbidden":"Acesso PROIBIDO",
 "forgotPwd":"Esqueceu sua senha?",
+"generatePamToken":"Generate Token",
 "generatePwd":"Gere a senha automaticamente",
 "generic":"Informações de contato",
 "generic2fFormatError":"Suas informações de contato não atendem ao formato exigido",
@@ -266,6 +276,15 @@
 "openidPA":"A política de uso de dados está disponível em",
 "openidRpns":"Parâmetro %s solicitado para federação não está disponível",
 "otherSessions":"Outras sessões ativas",
+"pamAccessInfo":"Generate a temporary token to use as your password for SSH or other PAM-enabled services.",
+"pamAccessTitle":"PAM Access Token",
+"pamExpiresIn":"Expires in",
+"pamInstructions":"Instructions",
+"pamInstructionsText":"Use this token as your password when connecting via SSH or other PAM-enabled services.",
+"pamLogin":"Login",
+"pamTokenDuration":"Token validity",
+"pamTokenError":"Failed to generate token",
+"pamTokenGenerated":"Your temporary token",
 "password":"Senha",
 "password2f":"Senha",
 "passwordCompromised":"Não foi encontrada em um banco de dados de senhas comprometidas",
@@ -304,6 +323,7 @@
 "removeOtherSessions":"Remover outras sessões",
 "rename":"Rename",
 "renewSession":"Renovar sessão",
+"requestedScope":"Requested scope",
 "resendCode":"Reenviar código",
 "resendConfirmMail":"Reenviar e-mail de confirmação?",
 "resendTooSoon":"Por favor aguarde um pouco mais antes de tentar reenviar o código",
@@ -354,6 +374,8 @@
 "upgradeSession":"Upgrade da sessão",
 "useYubikey":"use seu Yubikey",
 "user":"Usuário",
+"userCode":"Device Code",
+"userCodeHelp":"Enter the 8-character code shown on your device",
 "validationDate":"Data de validação",
 "value":"Valor",
 "verify":"Verificar",
diff --git a/lemonldap-ng-portal/site/htdocs/static/languages/pt_BR.json b/lemonldap-ng-portal/site/htdocs/static/languages/pt_BR.json
index 62fd40185..6e3c977ce 100644
--- a/lemonldap-ng-portal/site/htdocs/static/languages/pt_BR.json
+++ b/lemonldap-ng-portal/site/htdocs/static/languages/pt_BR.json
@@ -124,6 +124,7 @@
 "authLevel":"Nível de autenticação",
 "authPortal":"Portal de autenticação",
 "authRemaining":"%sautenticações restantes, altere sua senha!",
+"authorize":"Authorize",
 "autoAccept":"Aceitar automaticamente em 30 segundos",
 "autoGlobalLogout":"Logout global automático em 30 segundos",
 "back2CasUrl":"O aplicativo do qual você acabou de sair forneceu um link que gostaria que você seguisse",
@@ -149,6 +150,7 @@
 "click2Reset":"Clique aqui para renovar a sua senha",
 "clickHere":"Por favor, clique aqui",
 "clickOnYubikey":"Clique no seu Yubikey",
+"clientId":"Client ID",
 "close":"Fechar",
 "closeSSO":"Feche sua sessão SSO",
 "code":"Código",
@@ -166,6 +168,13 @@
 "currentPwd":"Senha atual",
 "date":"Data",
 "decryptCipheredValue":"Descriptografar um valor cifrado",
+"deny":"Deny",
+"deviceApproved":"Device Approved",
+"deviceApprovedMsg":"The device has been authorized. You can close this window.",
+"deviceAuthorization":"Device Authorization",
+"deviceAuthorizationMsg":"Enter the code displayed on your device to authorize it.",
+"deviceDenied":"Device Denied",
+"deviceDeniedMsg":"The device authorization has been denied. You can close this window.",
 "enterCred":"Por favor insira suas credenciais",
 "enterExt2fCode":"Um código foi enviado para você. Por favor o insira",
 "enterMail2fCode":"Um código foi enviado para o seu endereço de e-mail. Por favor o insira",
@@ -182,6 +191,7 @@
 "firstName":"Primeiro nome",
 "forbidden":"Acesso PROIBIDO",
 "forgotPwd":"Esqueceu sua senha?",
+"generatePamToken":"Generate Token",
 "generatePwd":"Gere a senha automaticamente",
 "generic":"Informações de contato",
 "generic2fFormatError":"Suas informações de contato não atendem ao formato exigido",
@@ -266,6 +276,15 @@
 "openidPA":"A política de uso de dados está disponível em",
 "openidRpns":"Parâmetro %s solicitado para federação não está disponível",
 "otherSessions":"Outras sessões ativas",
+"pamAccessInfo":"Generate a temporary token to use as your password for SSH or other PAM-enabled services.",
+"pamAccessTitle":"PAM Access Token",
+"pamExpiresIn":"Expires in",
+"pamInstructions":"Instructions",
+"pamInstructionsText":"Use this token as your password when connecting via SSH or other PAM-enabled services.",
+"pamLogin":"Login",
+"pamTokenDuration":"Token validity",
+"pamTokenError":"Failed to generate token",
+"pamTokenGenerated":"Your temporary token",
 "password":"Senha",
 "password2f":"Senha",
 "passwordCompromised":"Não foi encontrada em um banco de dados de senhas comprometidas",
@@ -304,6 +323,7 @@
 "removeOtherSessions":"Remover outras sessões",
 "rename":"Rename",
 "renewSession":"Renovar sessão",
+"requestedScope":"Requested scope",
 "resendCode":"Reenviar código",
 "resendConfirmMail":"Reenviar e-mail de confirmação?",
 "resendTooSoon":"Por favor aguarde um pouco mais antes de tentar reenviar o código",
@@ -354,6 +374,8 @@
 "upgradeSession":"Upgrade da sessão",
 "useYubikey":"use seu Yubikey",
 "user":"Usuário",
+"userCode":"Device Code",
+"userCodeHelp":"Enter the 8-character code shown on your device",
 "validationDate":"Data de validação",
 "value":"Valor",
 "verify":"Verificar",
diff --git a/lemonldap-ng-portal/site/htdocs/static/languages/ru.json b/lemonldap-ng-portal/site/htdocs/static/languages/ru.json
index fb540d6a0..3bce81d99 100644
--- a/lemonldap-ng-portal/site/htdocs/static/languages/ru.json
+++ b/lemonldap-ng-portal/site/htdocs/static/languages/ru.json
@@ -124,6 +124,7 @@
 "authLevel":"Уровень аутентификации",
 "authPortal":"Портал аутентификации",
 "authRemaining":"Осталось %s аутентификаций, смените пароль!",
+"authorize":"Authorize",
 "autoAccept":"Автоматически принимать через 30 секунд",
 "autoGlobalLogout":"Автоматический глобальный выход через 30 секунд",
 "back2CasUrl":"Приложение, из которого вы только что вышли, предоставило ссылку, по которой требуется перейти",
@@ -149,6 +150,7 @@
 "click2Reset":"Нажмите, чтобы сбросить пароль",
 "clickHere":"Нажмите сюда",
 "clickOnYubikey":"Нажмите на свой Yubikey",
+"clientId":"Client ID",
 "close":"Закрыть",
 "closeSSO":"Закройте сеанс единого входа",
 "code":"Код",
@@ -166,6 +168,13 @@
 "currentPwd":"Текущий пароль",
 "date":"Дата",
 "decryptCipheredValue":"Расшифровать зашифрованное значение",
+"deny":"Deny",
+"deviceApproved":"Device Approved",
+"deviceApprovedMsg":"The device has been authorized. You can close this window.",
+"deviceAuthorization":"Device Authorization",
+"deviceAuthorizationMsg":"Enter the code displayed on your device to authorize it.",
+"deviceDenied":"Device Denied",
+"deviceDeniedMsg":"The device authorization has been denied. You can close this window.",
 "enterCred":"Пожалуйста, введите свои учетные данные",
 "enterExt2fCode":"Вам был направлен код. Пожалуйста, введите его",
 "enterMail2fCode":"На вашу почту был направлен код. Пожалуйста, введите его",
@@ -182,6 +191,7 @@
 "firstName":"Имя",
 "forbidden":"Доступ ЗАПРЕЩЕН",
 "forgotPwd":"Забыли пароль?",
+"generatePamToken":"Generate Token",
 "generatePwd":"Автоматически сгенерировать пароль",
 "generic":"Контактные данные",
 "generic2fFormatError":"Your contact information does not match the required format",
@@ -266,6 +276,15 @@
 "openidPA":"Политика использования данных доступна на",
 "openidRpns":"Параметр %s, запрошенный для federation, недоступен",
 "otherSessions":"Другие активные сессии",
+"pamAccessInfo":"Generate a temporary token to use as your password for SSH or other PAM-enabled services.",
+"pamAccessTitle":"PAM Access Token",
+"pamExpiresIn":"Expires in",
+"pamInstructions":"Instructions",
+"pamInstructionsText":"Use this token as your password when connecting via SSH or other PAM-enabled services.",
+"pamLogin":"Login",
+"pamTokenDuration":"Token validity",
+"pamTokenError":"Failed to generate token",
+"pamTokenGenerated":"Your temporary token",
 "password":"Пароль",
 "password2f":"Пароль",
 "passwordCompromised":"Не найден в базе скомпрометированных паролей",
@@ -304,6 +323,7 @@
 "removeOtherSessions":"Удалить остальные сеансы",
 "rename":"Rename",
 "renewSession":"Обновить сеанс",
+"requestedScope":"Requested scope",
 "resendCode":"Отправить код еще раз",
 "resendConfirmMail":"Отправить письмо с подтверждением еще раз?",
 "resendTooSoon":"Пожалуйста, подождите немного, прежде чем пытаться повторно отправить код",
@@ -354,6 +374,8 @@
 "upgradeSession":"Обновить сеанс",
 "useYubikey":"используйте свой Yubikey",
 "user":"Пользователь",
+"userCode":"Device Code",
+"userCodeHelp":"Enter the 8-character code shown on your device",
 "validationDate":"Дата проверки",
 "value":"Значение",
 "verify":"Подтвердить",
diff --git a/lemonldap-ng-portal/site/htdocs/static/languages/sk.json b/lemonldap-ng-portal/site/htdocs/static/languages/sk.json
index 2fed9d30c..59abc99db 100644
--- a/lemonldap-ng-portal/site/htdocs/static/languages/sk.json
+++ b/lemonldap-ng-portal/site/htdocs/static/languages/sk.json
@@ -124,6 +124,7 @@
 "authLevel":"Úroveň autentifikácie",
 "authPortal":"Portál autentifikácie",
 "authRemaining":"%s autentifikácií zostáva, zmeňte svoje heslo!",
+"authorize":"Authorize",
 "autoAccept":"Automaticky prijať za 30 sekúnd",
 "autoGlobalLogout":"Automatická globálna odhlásenie za 30 sekúnd",
 "back2CasUrl":"Aplikácia, z ktorej ste sa práve odhlásili, poskytla odkaz, ktorý by ste mali sledovať",
@@ -149,6 +150,7 @@
 "click2Reset":"Kliknite sem na resetovanie hesla",
 "clickHere":"Prosím, kliknite sem",
 "clickOnYubikey":"Kliknite na svoju Yubikey",
+"clientId":"Client ID",
 "close":"Zavrieť",
 "closeSSO":"Zavrieť svoju SSO reláciu",
 "code":"Kód",
@@ -166,6 +168,13 @@
 "currentPwd":"Aktuálne heslo",
 "date":"Dátum",
 "decryptCipheredValue":"Dešifrovať zašifrovanú hodnotu",
+"deny":"Deny",
+"deviceApproved":"Device Approved",
+"deviceApprovedMsg":"The device has been authorized. You can close this window.",
+"deviceAuthorization":"Device Authorization",
+"deviceAuthorizationMsg":"Enter the code displayed on your device to authorize it.",
+"deviceDenied":"Device Denied",
+"deviceDeniedMsg":"The device authorization has been denied. You can close this window.",
 "enterCred":"Prosím, zadajte svoje poverenia",
 "enterExt2fCode":"Kód bol odoslaný na vás. Prosím, zadajte ho",
 "enterMail2fCode":"Kód bol odoslaný na vašu e-mailovú adresu. Prosím, zadajte ho",
@@ -182,6 +191,7 @@
 "firstName":"Meno",
 "forbidden":"Prístup ZAKÁZANÝ",
 "forgotPwd":"Zabudli ste svoje heslo?",
+"generatePamToken":"Generate Token",
 "generatePwd":"Automaticky vygenerovať heslo",
 "generic":"Kontaktné informácie",
 "generic2fFormatError":"Vaše kontaktné informácie nevyhovujú požadovanému formátu",
@@ -266,6 +276,15 @@
 "openidPA":"Politika používania údajov je k dispozícii na",
 "openidRpns":"Parametr %s požadovaný na federáciu nie je k dispozícii",
 "otherSessions":"Iné aktívne relácie",
+"pamAccessInfo":"Generate a temporary token to use as your password for SSH or other PAM-enabled services.",
+"pamAccessTitle":"PAM Access Token",
+"pamExpiresIn":"Expires in",
+"pamInstructions":"Instructions",
+"pamInstructionsText":"Use this token as your password when connecting via SSH or other PAM-enabled services.",
+"pamLogin":"Login",
+"pamTokenDuration":"Token validity",
+"pamTokenError":"Failed to generate token",
+"pamTokenGenerated":"Your temporary token",
 "password":"Heslo",
 "password2f":"Heslo",
 "passwordCompromised":"Nenájdené v databáze kompromitovaných hesiel",
@@ -304,6 +323,7 @@
 "removeOtherSessions":"Odstrániť iné relácie",
 "rename":"Rename",
 "renewSession":"Obnoviť reláciu",
+"requestedScope":"Requested scope",
 "resendCode":"Znovu odoslať kód",
 "resendConfirmMail":"Znovu odoslať potvrdzovací e-mail?",
 "resendTooSoon":"Prosím, počkajte trochu dlhšie pred pokusom o opätovné odoslanie kódu",
@@ -354,6 +374,8 @@
 "upgradeSession":"Zvýšiť reláciu",
 "useYubikey":"použite svoju Yubikey",
 "user":"Používateľ",
+"userCode":"Device Code",
+"userCodeHelp":"Enter the 8-character code shown on your device",
 "validationDate":"Dátum overenia",
 "value":"Hodnota",
 "verify":"Overiť",
diff --git a/lemonldap-ng-portal/site/htdocs/static/languages/tr.json b/lemonldap-ng-portal/site/htdocs/static/languages/tr.json
index 174402f3c..ce89a8204 100644
--- a/lemonldap-ng-portal/site/htdocs/static/languages/tr.json
+++ b/lemonldap-ng-portal/site/htdocs/static/languages/tr.json
@@ -124,6 +124,7 @@
 "authLevel":"Kimlik doğrulama düzeyi",
 "authPortal":"Kimlik doğrulama portalı",
 "authRemaining":"%s kimlik doğrulaması kaldı, parolanızı değiştirin!",
+"authorize":"Authorize",
 "autoAccept":"30 saniye içerisinde otomatik olarak kabul et",
 "autoGlobalLogout":"30 saniye içinde otomatik olarak global çıkış yap",
 "back2CasUrl":"Çıkış yaptığınız uygulama, takip etmenizi istediği bir bağlantı sağladı",
@@ -149,6 +150,7 @@
 "click2Reset":"Parolanızı sıfırlamak için buraya tıklayın",
 "clickHere":"Lütfen buraya tıklayın",
 "clickOnYubikey":"Yubikey'e tıklayın",
+"clientId":"Client ID",
 "close":"Kapalı",
 "closeSSO":"TOA oturumunuzu kapatın",
 "code":"Kod",
@@ -166,6 +168,13 @@
 "currentPwd":"Mevcut parola",
 "date":"Tarih",
 "decryptCipheredValue":"Şifrelenmiş değeri çöz",
+"deny":"Deny",
+"deviceApproved":"Device Approved",
+"deviceApprovedMsg":"The device has been authorized. You can close this window.",
+"deviceAuthorization":"Device Authorization",
+"deviceAuthorizationMsg":"Enter the code displayed on your device to authorize it.",
+"deviceDenied":"Device Denied",
+"deviceDeniedMsg":"The device authorization has been denied. You can close this window.",
 "enterCred":"Lütfen kimlik bilgilerinizi giriniz",
 "enterExt2fCode":"Size bir kod gönderildi. Lütfen onu giriniz",
 "enterMail2fCode":"E-posta adresinize bir kod gönderildi. Lütfen onu giriniz",
@@ -182,6 +191,7 @@
 "firstName":"Ad",
 "forbidden":"Erişim YASAKLI",
 "forgotPwd":"Parolanızı mı unuttunuz?",
+"generatePamToken":"Generate Token",
 "generatePwd":"Parolayı otomatik olarak oluştur",
 "generic":"İletişim bilgileri",
 "generic2fFormatError":"İletişim bilgileriniz gerekli formatla eşleşmiyor",
@@ -266,6 +276,15 @@
 "openidPA":"Veri kullanım ilkesi mevcut",
 "openidRpns":"Federasyon için %s parametre isteği mevcut değil!",
 "otherSessions":"Diğer aktif oturumlar",
+"pamAccessInfo":"Generate a temporary token to use as your password for SSH or other PAM-enabled services.",
+"pamAccessTitle":"PAM Access Token",
+"pamExpiresIn":"Expires in",
+"pamInstructions":"Instructions",
+"pamInstructionsText":"Use this token as your password when connecting via SSH or other PAM-enabled services.",
+"pamLogin":"Login",
+"pamTokenDuration":"Token validity",
+"pamTokenError":"Failed to generate token",
+"pamTokenGenerated":"Your temporary token",
 "password":"Parola",
 "password2f":"Parola",
 "passwordCompromised":"Güvenliği ihlal edilmiş bir parola veritabanında bulunamadı",
@@ -304,6 +323,7 @@
 "removeOtherSessions":"Diğer oturumları sil",
 "rename":"Rename",
 "renewSession":"Oturumu yenile",
+"requestedScope":"Requested scope",
 "resendCode":"Kodu tekrar gönder",
 "resendConfirmMail":"Doğrulama e-postasını tekrar gönder?",
 "resendTooSoon":"Lütfen kodu yeniden göndermeyi denemeden önce biraz bekleyin.",
@@ -354,6 +374,8 @@
 "upgradeSession":"Oturumu yükselt",
 "useYubikey":"Yubikey'inizi kullanın",
 "user":"Kullanıcı",
+"userCode":"Device Code",
+"userCodeHelp":"Enter the 8-character code shown on your device",
 "validationDate":"Doğrulama tarihi",
 "value":"Değer",
 "verify":"Doğrula",
diff --git a/lemonldap-ng-portal/site/htdocs/static/languages/vi.json b/lemonldap-ng-portal/site/htdocs/static/languages/vi.json
index 5f18c25d7..c2a9bae01 100644
--- a/lemonldap-ng-portal/site/htdocs/static/languages/vi.json
+++ b/lemonldap-ng-portal/site/htdocs/static/languages/vi.json
@@ -124,6 +124,7 @@
 "authLevel":"Mức xác thực",
 "authPortal":"Cổng thông tin xác thực",
 "authRemaining":"%s xác thực vẫn còn, thay đổi mật khẩu của bạn!",
+"authorize":"Authorize",
 "autoAccept":"Tự động chấp nhận trong 30 giây",
 "autoGlobalLogout":"Tự động đăng xuất tất cả sau 30 giây",
 "back2CasUrl":"Ứng dụng bạn vừa đăng xuất đã cung cấp một liên kết mà bạn muốn theo dõi",
@@ -149,6 +150,7 @@
 "click2Reset":"Nhấn ở đây để thiết lập lại mật khẩu của bạn",
 "clickHere":"Vui lòng nhấp vào đây",
 "clickOnYubikey":"Nhấp vào Yubikey của bạn",
+"clientId":"Client ID",
 "close":"Đóng",
 "closeSSO":"Đóng phiên SSO của bạn",
 "code":"Mã",
@@ -166,6 +168,13 @@
 "currentPwd":"Mật khẩu hiện tại",
 "date":"Ngày",
 "decryptCipheredValue":"Giải mã một giá trị được mã hóa",
+"deny":"Deny",
+"deviceApproved":"Device Approved",
+"deviceApprovedMsg":"The device has been authorized. You can close this window.",
+"deviceAuthorization":"Device Authorization",
+"deviceAuthorizationMsg":"Enter the code displayed on your device to authorize it.",
+"deviceDenied":"Device Denied",
+"deviceDeniedMsg":"The device authorization has been denied. You can close this window.",
 "enterCred":"Vui lòng nhập thông tin đăng nhập của bạn",
 "enterExt2fCode":"Một mã đã được gửi cho bạn. Hãy nhập nó",
 "enterMail2fCode":"Một mã đã được gửi đến địa chỉ email của bạn. Vui lòng nhập mã đó",
@@ -182,6 +191,7 @@
 "firstName":"Tên",
 "forbidden":"Truy cập bị cấm",
 "forgotPwd":"Quên mật khẩu của bạn?",
+"generatePamToken":"Generate Token",
 "generatePwd":"Tạo mật khẩu tự động",
 "generic":"Thông tin liên lạc",
 "generic2fFormatError":"Your contact information does not match the required format",
@@ -266,6 +276,15 @@
 "openidPA":"Chính sách sử dụng dữ liệu có sẵn tại",
 "openidRpns":"Đã yêu cầu tham số %s không có sẵn",
 "otherSessions":"Các phiên hoạt động khác",
+"pamAccessInfo":"Generate a temporary token to use as your password for SSH or other PAM-enabled services.",
+"pamAccessTitle":"PAM Access Token",
+"pamExpiresIn":"Expires in",
+"pamInstructions":"Instructions",
+"pamInstructionsText":"Use this token as your password when connecting via SSH or other PAM-enabled services.",
+"pamLogin":"Login",
+"pamTokenDuration":"Token validity",
+"pamTokenError":"Failed to generate token",
+"pamTokenGenerated":"Your temporary token",
 "password":"Mật khẩu",
 "password2f":"Mật khẩu",
 "passwordCompromised":"Không tìm thấy trong một cơ sở dữ liệu mật khẩu bị xâm nhập",
@@ -304,6 +323,7 @@
 "removeOtherSessions":"Xóa các phiên khác",
 "rename":"Rename",
 "renewSession":"làm mới phiên",
+"requestedScope":"Requested scope",
 "resendCode":"Gửi lại mã",
 "resendConfirmMail":"Gửi lại thư xác nhận?",
 "resendTooSoon":"Vui lòng đợi thêm trước khi thử gửi lại mã",
@@ -354,6 +374,8 @@
 "upgradeSession":"Phiên nâng cấp",
 "useYubikey":"sử dụng Yubikey của bạn",
 "user":"Người dùng",
+"userCode":"Device Code",
+"userCodeHelp":"Enter the 8-character code shown on your device",
 "validationDate":"ngày xác nhận",
 "value":"Giá trị",
 "verify":"Xác minh",
diff --git a/lemonldap-ng-portal/site/htdocs/static/languages/zh.json b/lemonldap-ng-portal/site/htdocs/static/languages/zh.json
index 2373a717b..1c07b188c 100644
--- a/lemonldap-ng-portal/site/htdocs/static/languages/zh.json
+++ b/lemonldap-ng-portal/site/htdocs/static/languages/zh.json
@@ -124,6 +124,7 @@
 "authLevel":"驗證等級",
 "authPortal":"驗證首頁",
 "authRemaining":"剩餘 %s 驗證，請變更您的密碼！",
+"authorize":"Authorize",
 "autoAccept":"30秒后自动接受",
 "autoGlobalLogout":"在30秒內自動全域登出",
 "back2CasUrl":"您剛登出的應用程式提供了連結，並希望您追蹤該連結",
@@ -149,6 +150,7 @@
 "click2Reset":"點擊此處以重設您的密碼",
 "clickHere":"请点击这里",
 "clickOnYubikey":"點擊您的 Yubikey",
+"clientId":"Client ID",
 "close":"Close",
 "closeSSO":"關閉您的 SSO 工作階段",
 "code":"代码",
@@ -166,6 +168,13 @@
 "currentPwd":"当前密码",
 "date":"日期",
 "decryptCipheredValue":"解密已加密的值",
+"deny":"Deny",
+"deviceApproved":"Device Approved",
+"deviceApprovedMsg":"The device has been authorized. You can close this window.",
+"deviceAuthorization":"Device Authorization",
+"deviceAuthorizationMsg":"Enter the code displayed on your device to authorize it.",
+"deviceDenied":"Device Denied",
+"deviceDeniedMsg":"The device authorization has been denied. You can close this window.",
 "enterCred":"请输入您的认证信息",
 "enterExt2fCode":"验证法已发送，请输入",
 "enterMail2fCode":"代碼已傳送給您的電子郵件。請輸入它",
@@ -182,6 +191,7 @@
 "firstName":"名",
 "forbidden":"禁止存取",
 "forgotPwd":"忘记密码？",
+"generatePamToken":"Generate Token",
 "generatePwd":"自动生成密码",
 "generic":"Contact information",
 "generic2fFormatError":"Your contact information does not match the required format",
@@ -266,6 +276,15 @@
 "openidPA":"数据使用条约可在此处了解",
 "openidRpns":"聯盟要求的 %s 參數不可用",
 "otherSessions":"其他作用中的工作階段",
+"pamAccessInfo":"Generate a temporary token to use as your password for SSH or other PAM-enabled services.",
+"pamAccessTitle":"PAM Access Token",
+"pamExpiresIn":"Expires in",
+"pamInstructions":"Instructions",
+"pamInstructionsText":"Use this token as your password when connecting via SSH or other PAM-enabled services.",
+"pamLogin":"Login",
+"pamTokenDuration":"Token validity",
+"pamTokenError":"Failed to generate token",
+"pamTokenGenerated":"Your temporary token",
 "password":"密码",
 "password2f":"密码",
 "passwordCompromised":"Not found in a compromised password database",
@@ -304,6 +323,7 @@
 "removeOtherSessions":"移除其他会话",
 "rename":"Rename",
 "renewSession":"更新工作階段",
+"requestedScope":"Requested scope",
 "resendCode":"Re-send code",
 "resendConfirmMail":"重新发送确认邮件？",
 "resendTooSoon":"Please wait a little longer before trying to re-send the code",
@@ -354,6 +374,8 @@
 "upgradeSession":"升級工作階段",
 "useYubikey":"使用您的 Yubikey",
 "user":"使用者",
+"userCode":"Device Code",
+"userCodeHelp":"Enter the 8-character code shown on your device",
 "validationDate":"驗證日期",
 "value":"值",
 "verify":"验证",
diff --git a/lemonldap-ng-portal/site/htdocs/static/languages/zh_TW.json b/lemonldap-ng-portal/site/htdocs/static/languages/zh_TW.json
index f472100cc..161228322 100644
--- a/lemonldap-ng-portal/site/htdocs/static/languages/zh_TW.json
+++ b/lemonldap-ng-portal/site/htdocs/static/languages/zh_TW.json
@@ -124,6 +124,7 @@
 "authLevel":"驗證等級",
 "authPortal":"驗證首頁",
 "authRemaining":"剩餘 %s 驗證，請變更您的密碼！",
+"authorize":"Authorize",
 "autoAccept":"在30秒內自動接受",
 "autoGlobalLogout":"在30秒內自動全域登出",
 "back2CasUrl":"您剛登出的應用程式提供了連結，並希望您追蹤該連結",
@@ -149,6 +150,7 @@
 "click2Reset":"點擊此處以重設您的密碼",
 "clickHere":"請點擊此處",
 "clickOnYubikey":"點擊您的 Yubikey",
+"clientId":"Client ID",
 "close":"Close",
 "closeSSO":"關閉您的 SSO 工作階段",
 "code":"代碼",
@@ -166,6 +168,13 @@
 "currentPwd":"目前的密碼",
 "date":"日期",
 "decryptCipheredValue":"解密已加密的值",
+"deny":"Deny",
+"deviceApproved":"Device Approved",
+"deviceApprovedMsg":"The device has been authorized. You can close this window.",
+"deviceAuthorization":"Device Authorization",
+"deviceAuthorizationMsg":"Enter the code displayed on your device to authorize it.",
+"deviceDenied":"Device Denied",
+"deviceDeniedMsg":"The device authorization has been denied. You can close this window.",
 "enterCred":"請輸入您的憑證",
 "enterExt2fCode":"代碼已傳送給您。請輸入它",
 "enterMail2fCode":"代碼已傳送給您的電子郵件。請輸入它",
@@ -182,6 +191,7 @@
 "firstName":"名",
 "forbidden":"禁止存取",
 "forgotPwd":"忘記您的密碼？",
+"generatePamToken":"Generate Token",
 "generatePwd":"自動生成密碼",
 "generic":"Contact information",
 "generic2fFormatError":"Your contact information does not match the required format",
@@ -266,6 +276,15 @@
 "openidPA":"資料使用政策可從以下網站取得：",
 "openidRpns":"聯盟要求的 %s 參數不可用",
 "otherSessions":"其他作用中的工作階段",
+"pamAccessInfo":"Generate a temporary token to use as your password for SSH or other PAM-enabled services.",
+"pamAccessTitle":"PAM Access Token",
+"pamExpiresIn":"Expires in",
+"pamInstructions":"Instructions",
+"pamInstructionsText":"Use this token as your password when connecting via SSH or other PAM-enabled services.",
+"pamLogin":"Login",
+"pamTokenDuration":"Token validity",
+"pamTokenError":"Failed to generate token",
+"pamTokenGenerated":"Your temporary token",
 "password":"密碼",
 "password2f":"密碼",
 "passwordCompromised":"Not found in a compromised password database",
@@ -304,6 +323,7 @@
 "removeOtherSessions":"移除其他工作階段",
 "rename":"Rename",
 "renewSession":"更新工作階段",
+"requestedScope":"Requested scope",
 "resendCode":"Re-send code",
 "resendConfirmMail":"重新傳送確認電子郵件？",
 "resendTooSoon":"Please wait a little longer before trying to re-send the code",
@@ -354,6 +374,8 @@
 "upgradeSession":"升級工作階段",
 "useYubikey":"使用您的 Yubikey",
 "user":"使用者",
+"userCode":"Device Code",
+"userCodeHelp":"Enter the 8-character code shown on your device",
 "validationDate":"驗證日期",
 "value":"值",
 "verify":"驗證",
diff --git a/lemonldap-ng-portal/site/js-src/pamaccess.js b/lemonldap-ng-portal/site/js-src/pamaccess.js
new file mode 100644
index 000000000..27cc530b4
--- /dev/null
+++ b/lemonldap-ng-portal/site/js-src/pamaccess.js
@@ -0,0 +1,60 @@
+(function() {
+  $(window).on("load", function() {
+    var form = document.getElementById('pamTokenForm');
+    if (!form) return;
+
+    var resultDiv = document.getElementById('pamTokenResult');
+    var errorDiv = document.getElementById('pamTokenError');
+    var tokenInput = document.getElementById('pamToken');
+    var loginSpan = document.getElementById('pamLogin');
+    var expiresSpan = document.getElementById('pamExpiresIn');
+    var copyBtn = document.getElementById('copyPamToken');
+    var errorMsg = document.getElementById('pamErrorMessage');
+
+    form.addEventListener('submit', function(e) {
+      e.preventDefault();
+      resultDiv.classList.add('d-none');
+      errorDiv.classList.add('d-none');
+
+      var duration = document.getElementById('pamDuration').value;
+
+      $.ajax({
+        type: "POST",
+        url: scriptname + 'pam',
+        data: { duration: duration },
+        dataType: "json",
+        success: function(data) {
+          if (data.error) {
+            errorMsg.textContent = data.error;
+            errorDiv.classList.remove('d-none');
+          } else {
+            tokenInput.value = data.token;
+            loginSpan.textContent = data.login;
+            var minutes = Math.floor(data.expires_in / 60);
+            var seconds = data.expires_in % 60;
+            expiresSpan.textContent = minutes + ' min ' + (seconds > 0 ? seconds + ' sec' : '');
+            resultDiv.classList.remove('d-none');
+          }
+        },
+        error: function(xhr, status, error) {
+          errorMsg.textContent = error || status;
+          errorDiv.classList.remove('d-none');
+        }
+      });
+    });
+
+    // Copy button
+    if (copyBtn) {
+      copyBtn.addEventListener('click', function() {
+        tokenInput.select();
+        tokenInput.setSelectionRange(0, 99999);
+        navigator.clipboard.writeText(tokenInput.value).then(function() {
+          copyBtn.innerHTML = '<span class="fa fa-check"></span>';
+          setTimeout(function() {
+            copyBtn.innerHTML = '<span class="fa fa-copy"></span>';
+          }, 2000);
+        });
+      });
+    }
+  });
+})();
diff --git a/lemonldap-ng-portal/site/templates/bootstrap/device.tpl b/lemonldap-ng-portal/site/templates/bootstrap/device.tpl
new file mode 100644
index 000000000..53f4191ba
--- /dev/null
+++ b/lemonldap-ng-portal/site/templates/bootstrap/device.tpl
@@ -0,0 +1,113 @@
+<TMPL_INCLUDE NAME="header.tpl">
+
+<div id="logincontent" class="container">
+
+  <TMPL_IF NAME="DEVICE_APPROVED">
+    <!-- Device authorization approved -->
+    <div class="card border-success">
+      <div class="card-header text-white bg-success">
+        <h3 class="card-title">
+          <span class="fa fa-check-circle"></span>
+          <span trspan="deviceApproved">Device Approved</span>
+        </h3>
+      </div>
+      <div class="card-body">
+        <p trspan="deviceApprovedMsg">The device has been authorized. You can close this window.</p>
+        <TMPL_IF NAME="CLIENT_ID">
+          <p>
+            <strong trspan="clientId">Client ID</strong>: <TMPL_VAR NAME="CLIENT_ID">
+          </p>
+        </TMPL_IF>
+        <TMPL_IF NAME="SCOPE">
+          <p>
+            <strong trspan="requestedScope">Requested scope</strong>: <TMPL_VAR NAME="SCOPE">
+          </p>
+        </TMPL_IF>
+      </div>
+    </div>
+
+  <TMPL_ELSE>
+    <TMPL_IF NAME="DEVICE_DENIED">
+      <!-- Device authorization denied -->
+      <div class="card border-danger">
+        <div class="card-header text-white bg-danger">
+          <h3 class="card-title">
+            <span class="fa fa-times-circle"></span>
+            <span trspan="deviceDenied">Device Denied</span>
+          </h3>
+        </div>
+        <div class="card-body">
+          <p trspan="deviceDeniedMsg">The device authorization has been denied. You can close this window.</p>
+        </div>
+      </div>
+
+    <TMPL_ELSE>
+      <!-- Device code entry form -->
+      <form id="deviceform" action="<TMPL_VAR NAME="PORTAL_URL">device" method="post" class="login" role="form">
+
+        <input type="hidden" name="skin" value="<TMPL_VAR NAME="SKIN">" />
+
+        <div class="card border-info">
+          <div class="card-header text-white bg-info">
+            <h3 class="card-title">
+              <span class="fa fa-desktop"></span>
+              <span trspan="deviceAuthorization">Device Authorization</span>
+            </h3>
+          </div>
+          <div class="card-body">
+
+            <p trspan="deviceAuthorizationMsg">Enter the code displayed on your device to authorize it.</p>
+
+            <TMPL_IF NAME="ERROR">
+              <div class="alert alert-danger">
+                <span class="fa fa-exclamation-triangle"></span>
+                <span trspan="<TMPL_VAR NAME="MSG">"><TMPL_VAR NAME="MSG"></span>
+              </div>
+            </TMPL_IF>
+
+            <div class="form-group">
+              <label for="user_code" trspan="userCode">Device Code</label>
+              <input type="text"
+                     name="user_code"
+                     id="user_code"
+                     class="form-control form-control-lg text-center text-uppercase"
+                     value="<TMPL_VAR NAME="USER_CODE">"
+                     placeholder="XXXX-XXXX"
+                     pattern="[A-Za-z0-9\-]{6,12}"
+                     maxlength="12"
+                     autocomplete="off"
+                     autofocus
+                     required />
+              <small class="form-text text-muted" trspan="userCodeHelp">Enter the 8-character code shown on your device</small>
+            </div>
+
+            <div class="buttons">
+              <button type="submit" name="action" value="approve" class="btn btn-success btn-lg">
+                <span class="fa fa-check"></span>
+                <span trspan="authorize">Authorize</span>
+              </button>
+              <button type="submit" name="action" value="deny" class="btn btn-danger">
+                <span class="fa fa-times"></span>
+                <span trspan="deny">Deny</span>
+              </button>
+            </div>
+
+          </div>
+        </div>
+
+      </form>
+    </TMPL_IF>
+  </TMPL_IF>
+
+  <div id="back2portal">
+    <div class="buttons">
+      <a href="<TMPL_VAR NAME="PORTAL_URL">" class="btn btn-primary" role="button">
+        <span class="fa fa-home"></span>
+        <span trspan="goToPortal">Go to portal</span>
+      </a>
+    </div>
+  </div>
+
+</div>
+
+<TMPL_INCLUDE NAME="footer.tpl">
diff --git a/lemonldap-ng-portal/site/templates/bootstrap/pamaccess.tpl b/lemonldap-ng-portal/site/templates/bootstrap/pamaccess.tpl
new file mode 100644
index 000000000..ee0a3ef55
--- /dev/null
+++ b/lemonldap-ng-portal/site/templates/bootstrap/pamaccess.tpl
@@ -0,0 +1,60 @@
+<script type="text/javascript" src="<TMPL_VAR NAME="js">"></script>
+<div class="card border-secondary">
+  <div class="card-header text-white bg-secondary">
+    <h4 class="card-title" trspan="pamAccessTitle">PAM Access Token</h4>
+  </div>
+  <div class="card-body">
+    <p trspan="pamAccessInfo">Generate a temporary token to use as your password for SSH or other PAM-enabled services.</p>
+
+    <form id="pamTokenForm" class="mb-4">
+      <div class="form-group row mb-3">
+        <label class="col-sm-4 col-form-label" for="pamDuration" trspan="pamTokenDuration">Token validity</label>
+        <div class="col-sm-8">
+          <select class="form-control" id="pamDuration" name="duration">
+            <option value="60">1 minute</option>
+            <option value="300">5 minutes</option>
+            <option value="600" selected>10 minutes</option>
+            <option value="1800">30 minutes</option>
+            <option value="3600">1 hour</option>
+          </select>
+        </div>
+      </div>
+      <div class="form-group row">
+        <div class="col-sm-8 offset-sm-4">
+          <button type="submit" class="btn btn-primary" id="generatePamToken">
+            <span class="fa fa-key"></span>
+            <span trspan="generatePamToken">Generate Token</span>
+          </button>
+        </div>
+      </div>
+    </form>
+
+    <div id="pamTokenResult" class="d-none">
+      <div class="alert alert-success">
+        <h5 trspan="pamTokenGenerated">Your temporary token</h5>
+        <div class="input-group mb-3">
+          <input type="text" class="form-control font-monospace" id="pamToken" readonly>
+          <button class="btn btn-outline-secondary" type="button" id="copyPamToken" title="Copy">
+            <span class="fa fa-copy"></span>
+          </button>
+        </div>
+        <p class="mb-1">
+          <strong trspan="pamLogin">Login:</strong>
+          <code id="pamLogin"></code>
+        </p>
+        <p class="mb-0">
+          <strong trspan="pamExpiresIn">Expires in:</strong>
+          <span id="pamExpiresIn"></span>
+        </p>
+      </div>
+      <div class="alert alert-info">
+        <h6 trspan="pamInstructions">Instructions</h6>
+        <p class="mb-0" trspan="pamInstructionsText">Use this token as your password when connecting via SSH or other PAM-enabled services.</p>
+      </div>
+    </div>
+
+    <div id="pamTokenError" class="alert alert-danger d-none">
+      <span trspan="pamTokenError">Failed to generate token</span>: <span id="pamErrorMessage"></span>
+    </div>
+  </div>
+</div>
diff --git a/lemonldap-ng-portal/t/32-OIDC-Device-Authorization.t b/lemonldap-ng-portal/t/32-OIDC-Device-Authorization.t
new file mode 100644
index 000000000..38f29f86c
--- /dev/null
+++ b/lemonldap-ng-portal/t/32-OIDC-Device-Authorization.t
@@ -0,0 +1,390 @@
+use warnings;
+use Test::More;
+use strict;
+use IO::String;
+use MIME::Base64;
+use JSON;
+
+BEGIN {
+    require 't/test-lib.pm';
+    require 't/oidc-lib.pm';
+}
+
+my $debug = 'error';
+
+# Initialization
+my $op = LLNG::Manager::Test->new(
+    {
+        ini => {
+            logLevel                            => $debug,
+            domain                              => 'op.com',
+            portal                              => 'http://auth.op.com/',
+            authentication                      => 'Demo',
+            userDB                              => 'Same',
+            issuerDBOpenIDConnectActivation     => 1,
+            oidcServiceDeviceAuthorizationExpiration => 600,
+            oidcServiceDeviceAuthorizationPollingInterval => 5,
+            oidcServiceDeviceAuthorizationUserCodeLength => 8,
+            oidcRPMetaDataExportedVars          => {
+                rp => {
+                    email              => "mail",
+                    preferred_username => "uid",
+                    name               => "cn",
+                }
+            },
+            oidcRPMetaDataOptions => {
+                rp => {
+                    oidcRPMetaDataOptionsDisplayName                => "RP",
+                    oidcRPMetaDataOptionsIDTokenExpiration          => 3600,
+                    oidcRPMetaDataOptionsIDTokenSignAlg             => "RS256",
+                    oidcRPMetaDataOptionsClientID                   => "rpid",
+                    oidcRPMetaDataOptionsClientSecret               => "rpsecret",
+                    oidcRPMetaDataOptionsUserIDAttr                 => "",
+                    oidcRPMetaDataOptionsAccessTokenExpiration      => 3600,
+                    oidcRPMetaDataOptionsBypassConsent              => 1,
+                    oidcRPMetaDataOptionsRefreshToken               => 1,
+                    oidcRPMetaDataOptionsAllowOffline               => 1,
+                    oidcRPMetaDataOptionsAllowDeviceAuthorizationGrant => 1,
+                },
+                rp_no_device => {
+                    oidcRPMetaDataOptionsDisplayName                => "RP No Device",
+                    oidcRPMetaDataOptionsIDTokenExpiration          => 3600,
+                    oidcRPMetaDataOptionsClientID                   => "rpid_no_device",
+                    oidcRPMetaDataOptionsClientSecret               => "rpsecret",
+                    oidcRPMetaDataOptionsUserIDAttr                 => "",
+                    oidcRPMetaDataOptionsAccessTokenExpiration      => 3600,
+                    oidcRPMetaDataOptionsBypassConsent              => 1,
+                    oidcRPMetaDataOptionsAllowDeviceAuthorizationGrant => 0,
+                },
+            },
+            oidcServicePrivateKeySig => oidc_key_op_private_sig,
+            oidcServicePublicKeySig  => oidc_cert_op_public_sig,
+        }
+    }
+);
+
+my $res;
+
+# Test 1: Device Authorization Request
+# RFC 8628 Section 3.1
+my $query = buildForm(
+    {
+        client_id => 'rpid',
+        scope     => 'openid profile email',
+    }
+);
+
+ok(
+    $res = $op->_post(
+        "/oauth2/device",
+        IO::String->new($query),
+        accept => 'application/json',
+        length => length($query),
+    ),
+    "Post device authorization request"
+);
+
+my $payload = expectJSON($res);
+
+ok( $payload->{device_code}, "Got device_code" );
+ok( $payload->{user_code}, "Got user_code" );
+ok( $payload->{verification_uri}, "Got verification_uri" );
+ok( $payload->{verification_uri_complete}, "Got verification_uri_complete" );
+ok( $payload->{expires_in}, "Got expires_in" );
+is( $payload->{interval}, 5, "Got expected polling interval" );
+count(6);
+
+my $device_code = $payload->{device_code};
+my $user_code   = $payload->{user_code};
+
+# Verify user_code format (8 chars, no vowels)
+like( $user_code, qr/^[BCDFGHJKLMNPQRSTVWXZ23456789]{4}-[BCDFGHJKLMNPQRSTVWXZ23456789]{4}$/,
+    "User code has expected format (XXXX-XXXX)" );
+count(1);
+
+# Test 2: Polling before user authorizes - should get authorization_pending
+$query = buildForm(
+    {
+        grant_type    => 'urn:ietf:params:oauth:grant-type:device_code',
+        device_code   => $device_code,
+    }
+);
+
+ok(
+    $res = $op->_post(
+        "/oauth2/token",
+        IO::String->new($query),
+        accept => 'application/json',
+        length => length($query),
+        custom => {
+            HTTP_AUTHORIZATION => "Basic " . encode_base64("rpid:rpsecret", ''),
+        },
+    ),
+    "Poll token endpoint before authorization"
+);
+
+expectReject( $res, 400, "authorization_pending" );
+
+# Test 3: User authenticates and enters user_code
+# First, login
+my $id = login( $op, 'french' );
+
+# Access device verification page with user_code
+ok(
+    $res = $op->_get(
+        "/device",
+        query  => "user_code=" . ($user_code =~ s/-//gr),  # Remove hyphen
+        cookie => "lemonldap=$id",
+        accept => 'text/html',
+    ),
+    "Get device verification page with user_code"
+);
+count(1);
+
+expectOK($res);
+
+# Verify form is displayed
+like( $res->[2]->[0], qr/deviceform/, "Device authorization form displayed" );
+count(1);
+
+# Test 4: User approves the device
+my $user_code_clean = $user_code =~ s/-//gr;
+$query = buildForm(
+    {
+        user_code => $user_code_clean,
+        action    => 'approve',
+    }
+);
+
+ok(
+    $res = $op->_post(
+        "/device",
+        IO::String->new($query),
+        cookie => "lemonldap=$id",
+        accept => 'text/html',
+        length => length($query),
+    ),
+    "Post device approval"
+);
+count(1);
+
+expectOK($res);
+like( $res->[2]->[0], qr/deviceApproved|success/, "Device approved message displayed" );
+count(1);
+
+# Test 5: Poll again - should now get tokens
+$query = buildForm(
+    {
+        grant_type    => 'urn:ietf:params:oauth:grant-type:device_code',
+        device_code   => $device_code,
+    }
+);
+
+ok(
+    $res = $op->_post(
+        "/oauth2/token",
+        IO::String->new($query),
+        accept => 'application/json',
+        length => length($query),
+        custom => {
+            HTTP_AUTHORIZATION => "Basic " . encode_base64("rpid:rpsecret", ''),
+        },
+    ),
+    "Poll token endpoint after authorization"
+);
+
+$payload = expectJSON($res);
+ok( $payload->{access_token}, "Got access_token" );
+ok( $payload->{token_type} eq 'Bearer', "Got Bearer token type" );
+ok( $payload->{id_token}, "Got id_token" );
+count(3);
+
+my $access_token = $payload->{access_token};
+
+# Test 6: Verify access token works for userinfo
+$res = getUserinfo( $op, $access_token );
+$payload = expectJSON($res);
+is( $payload->{sub}, 'french', "Got correct sub claim" );
+count(1);
+
+# Test 7: Device code should no longer be usable (already exchanged)
+$query = buildForm(
+    {
+        grant_type    => 'urn:ietf:params:oauth:grant-type:device_code',
+        device_code   => $device_code,
+    }
+);
+
+ok(
+    $res = $op->_post(
+        "/oauth2/token",
+        IO::String->new($query),
+        accept => 'application/json',
+        length => length($query),
+        custom => {
+            HTTP_AUTHORIZATION => "Basic " . encode_base64("rpid:rpsecret", ''),
+        },
+    ),
+    "Try to reuse device_code"
+);
+
+expectReject( $res, 400, "expired_token" );
+
+# Test 8: Invalid device_code should fail
+$query = buildForm(
+    {
+        grant_type    => 'urn:ietf:params:oauth:grant-type:device_code',
+        device_code   => 'invalid_device_code',
+    }
+);
+
+ok(
+    $res = $op->_post(
+        "/oauth2/token",
+        IO::String->new($query),
+        accept => 'application/json',
+        length => length($query),
+        custom => {
+            HTTP_AUTHORIZATION => "Basic " . encode_base64("rpid:rpsecret", ''),
+        },
+    ),
+    "Poll with invalid device_code"
+);
+
+expectReject( $res, 400, "expired_token" );
+
+# Test 9: Device authorization not allowed for RP
+$query = buildForm(
+    {
+        client_id => 'rpid_no_device',
+        scope     => 'openid',
+    }
+);
+
+ok(
+    $res = $op->_post(
+        "/oauth2/device",
+        IO::String->new($query),
+        accept => 'application/json',
+        length => length($query),
+    ),
+    "Post device authorization for RP without device grant"
+);
+
+expectReject( $res, 400, "unauthorized_client" );
+
+# Test 10: User denies the device
+# First create a new device authorization
+$query = buildForm(
+    {
+        client_id => 'rpid',
+        scope     => 'openid profile',
+    }
+);
+
+ok(
+    $res = $op->_post(
+        "/oauth2/device",
+        IO::String->new($query),
+        accept => 'application/json',
+        length => length($query),
+    ),
+    "Post new device authorization request"
+);
+
+$payload = expectJSON($res);
+my $device_code2 = $payload->{device_code};
+my $user_code2   = $payload->{user_code};
+$user_code2 =~ s/-//g;
+
+# User denies
+$query = buildForm(
+    {
+        user_code => $user_code2,
+        action    => 'deny',
+    }
+);
+
+ok(
+    $res = $op->_post(
+        "/device",
+        IO::String->new($query),
+        cookie => "lemonldap=$id",
+        accept => 'text/html',
+        length => length($query),
+    ),
+    "Post device denial"
+);
+count(1);
+
+# Poll should get access_denied
+$query = buildForm(
+    {
+        grant_type    => 'urn:ietf:params:oauth:grant-type:device_code',
+        device_code   => $device_code2,
+    }
+);
+
+ok(
+    $res = $op->_post(
+        "/oauth2/token",
+        IO::String->new($query),
+        accept => 'application/json',
+        length => length($query),
+        custom => {
+            HTTP_AUTHORIZATION => "Basic " . encode_base64("rpid:rpsecret", ''),
+        },
+    ),
+    "Poll after user denial"
+);
+
+expectReject( $res, 400, "access_denied" );
+
+# Test 11: Expired device code
+$query = buildForm(
+    {
+        client_id => 'rpid',
+        scope     => 'openid',
+    }
+);
+
+ok(
+    $res = $op->_post(
+        "/oauth2/device",
+        IO::String->new($query),
+        accept => 'application/json',
+        length => length($query),
+    ),
+    "Post device authorization for expiration test"
+);
+
+$payload = expectJSON($res);
+my $device_code3 = $payload->{device_code};
+
+# Fast-forward time past expiration
+Time::Fake->offset("+15m");
+
+$query = buildForm(
+    {
+        grant_type    => 'urn:ietf:params:oauth:grant-type:device_code',
+        device_code   => $device_code3,
+    }
+);
+
+ok(
+    $res = $op->_post(
+        "/oauth2/token",
+        IO::String->new($query),
+        accept => 'application/json',
+        length => length($query),
+        custom => {
+            HTTP_AUTHORIZATION => "Basic " . encode_base64("rpid:rpsecret", ''),
+        },
+    ),
+    "Poll with expired device_code"
+);
+
+expectReject( $res, 400, "expired_token" );
+
+clean_sessions();
+done_testing();
diff --git a/lemonldap-ng-portal/t/78-PamAccess-SSHCA.t b/lemonldap-ng-portal/t/78-PamAccess-SSHCA.t
new file mode 100644
index 000000000..5fa77989e
--- /dev/null
+++ b/lemonldap-ng-portal/t/78-PamAccess-SSHCA.t
@@ -0,0 +1,388 @@
+use warnings;
+use Test::More;
+use strict;
+use IO::String;
+use JSON;
+use File::Temp qw(tempdir);
+use MIME::Base64;
+
+require 't/test-lib.pm';
+require 't/oidc-lib.pm';
+
+my $debug = 'error';
+my ( $op, $res );
+
+# Create temp directory for KRL file
+my $tmpdir = tempdir( CLEANUP => 1 );
+my $krlPath = "$tmpdir/revoked_keys";
+
+# Generate a test Ed25519 key pair for SSH CA
+my $caPrivateKey;
+my $caPublicKey;
+
+eval {
+    require Crypt::PK::Ed25519;
+    my $pk = Crypt::PK::Ed25519->new();
+    $pk->generate_key();
+    $caPrivateKey = $pk->export_key_pem('private');
+    $caPublicKey  = $pk->export_key_pem('public');
+};
+if ($@) {
+    plan skip_all => "Crypt::PK::Ed25519 not available: $@";
+}
+
+diag("Generated test CA key pair");
+
+# Initialization - OP with PAM Access and SSH CA enabled
+ok(
+    $op = LLNG::Manager::Test->new( {
+            ini => {
+                logLevel                        => $debug,
+                domain                          => 'op.com',
+                portal                          => 'http://auth.op.com',
+                authentication                  => 'Demo',
+                userDB                          => 'Same',
+                issuerDBOpenIDConnectActivation => 1,
+                oidcRPMetaDataExportedVars      => {
+                    'pam-access' => {
+                        email  => 'mail',
+                        name   => 'cn',
+                    }
+                },
+                oidcServiceMetaDataAuthorizeURI       => 'authorize',
+                oidcServiceMetaDataCheckSessionURI    => 'check_session',
+                oidcServiceMetaDataJWKSURI            => 'jwks',
+                oidcServiceMetaDataEndSessionURI      => 'logout',
+                oidcServiceMetaDataRegistrationURI    => 'register',
+                oidcServiceMetaDataTokenURI           => 'token',
+                oidcServiceMetaDataUserInfoURI        => 'userinfo',
+                oidcServiceMetaDataIntrospectionURI   => 'introspect',
+                oidcServiceAllowAuthorizationCodeFlow => 1,
+                oidcRPMetaDataOptions                 => {
+                    'pam-access' => {
+                        oidcRPMetaDataOptionsDisplayName  => 'PAM Access',
+                        oidcRPMetaDataOptionsClientID     => 'pam-access',
+                        oidcRPMetaDataOptionsClientSecret => 'pamsecret',
+                    }
+                },
+                oidcOPMetaDataOptions    => {},
+                oidcOPMetaDataJSON       => {},
+                oidcOPMetaDataJWKS       => {},
+                oidcServicePrivateKeySig => oidc_key_op_private_sig(),
+                oidcServicePublicKeySig  => oidc_cert_op_public_sig(),
+
+                # PAM Access config
+                pamAccessActivation    => 1,
+                portalDisplayPamAccess => 1,
+
+                # SSH CA config
+                sshCaActivation          => 1,
+                sshCaKeyType             => 'ed25519',
+                sshCaKeyRef              => 'ssh-ca-key',
+                sshCaCertDefaultValidity => 30,
+                sshCaCertMaxValidity     => 60,
+                sshCaPrincipalSources    => '$uid',
+                sshCaKrlPath             => $krlPath,
+                sshCaSerialPath          => "$tmpdir/serial",
+
+                # Keys store with SSH CA key
+                keys => {
+                    'ssh-ca-key' => {
+                        keyPrivate => $caPrivateKey,
+                        keyPublic  => $caPublicKey,
+                        keyId      => 'ssh-ca-key',
+                        keyComment => 'Test SSH CA Key',
+                    },
+                },
+            }
+        }
+    ),
+    'OP with PamAccess and SSH CA initialized'
+);
+
+# ============================================
+# PART 1: SSH CA Public Key endpoint tests
+# ============================================
+
+# Test 1: GET /ssh/ca - should return SSH public key
+ok(
+    $res = $op->_get(
+        '/ssh/ca',
+        accept => 'text/plain',
+    ),
+    'GET /ssh/ca'
+);
+expectOK($res);
+
+my $sshPubKey = $res->[2]->[0];
+ok( $sshPubKey, 'Got SSH public key' );
+ok( $sshPubKey =~ /^ssh-ed25519\s+/, 'Public key is in SSH format (ssh-ed25519)' );
+ok( $sshPubKey =~ /LLNG-SSH-CA/, 'Public key has LLNG comment' );
+diag("SSH CA Public Key: $sshPubKey");
+
+# Test 2: Check Content-Type header
+my %headers = @{ $res->[1] };
+ok( $headers{'Content-Type'} =~ /text\/plain/, 'Content-Type is text/plain' );
+
+# ============================================
+# PART 2: SSH CA KRL endpoint tests
+# ============================================
+
+# Test 3: GET /ssh/revoked - should return empty when no KRL file exists
+ok(
+    $res = $op->_get(
+        '/ssh/revoked',
+        accept => 'application/octet-stream',
+    ),
+    'GET /ssh/revoked (no KRL file)'
+);
+expectOK($res);
+
+my $krlData = $res->[2]->[0];
+ok( defined $krlData, 'Got KRL response (empty)' );
+is( $krlData, '', 'KRL is empty when file does not exist' );
+
+# Test 4: Create a KRL file and test again
+my $testKrlContent = "SSH_KRL_TEST_DATA";
+open my $fh, '>', $krlPath or die "Cannot write KRL: $!";
+print $fh $testKrlContent;
+close $fh;
+
+ok(
+    $res = $op->_get(
+        '/ssh/revoked',
+        accept => 'application/octet-stream',
+    ),
+    'GET /ssh/revoked (with KRL file)'
+);
+expectOK($res);
+
+$krlData = $res->[2]->[0];
+is( $krlData, $testKrlContent, 'KRL content matches file' );
+
+# Test 5: Check Content-Type header for KRL
+%headers = @{ $res->[1] };
+ok( $headers{'Content-Type'} =~ /application\/octet-stream/, 'Content-Type is application/octet-stream' );
+
+# ============================================
+# PART 3: SSH CA Sign endpoint tests (stub)
+# ============================================
+
+# First authenticate a user (use dwho which is in Demo accounts with uid)
+my $query = 'user=dwho&password=dwho';
+ok(
+    $res = $op->_post(
+        '/',
+        IO::String->new($query),
+        accept => 'text/html',
+        length => length($query),
+    ),
+    'Auth query'
+);
+my $id = expectCookie($res);
+ok( $id, 'Got session cookie' );
+
+# Test 6: POST /ssh/sign without authentication (should redirect or fail)
+my $sign_body = to_json( {
+    public_key => 'ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAITestKey test@example.com',
+} );
+ok(
+    $res = $op->_post(
+        '/ssh/sign',
+        IO::String->new($sign_body),
+        accept => 'application/json',
+        type   => 'application/json',
+        length => length($sign_body),
+    ),
+    'POST /ssh/sign without authentication'
+);
+# Should not be 200 OK (either redirect 302 or error)
+ok( $res->[0] != 200 || ( $res->[2]->[0] && $res->[2]->[0] =~ /error/i ),
+    'Unauthenticated request to /ssh/sign is rejected' );
+
+# Generate a real Ed25519 key pair for signing test
+my $userPk = Crypt::PK::Ed25519->new();
+$userPk->generate_key();
+my $userPubKeyRaw = $userPk->export_key_raw('public');
+my $userKeyType = 'ssh-ed25519';
+my $userBlob = pack('N', length($userKeyType)) . $userKeyType
+             . pack('N', length($userPubKeyRaw)) . $userPubKeyRaw;
+my $userPubKey = "$userKeyType " . MIME::Base64::encode_base64($userBlob, '') . " test\@example.com";
+
+diag("User public key for signing: $userPubKey");
+
+# Test 7: POST /ssh/sign with valid public key
+$sign_body = to_json( {
+    public_key       => $userPubKey,
+    validity_minutes => 10,
+} );
+ok(
+    $res = $op->_post(
+        '/ssh/sign',
+        IO::String->new($sign_body),
+        accept => 'application/json',
+        type   => 'application/json',
+        length => length($sign_body),
+        cookie => "lemonldap=$id",
+    ),
+    'POST /ssh/sign with valid public key'
+);
+
+SKIP: {
+    skip "ssh-keygen may not support Ed25519 PEM keys", 8 if $res->[0] == 500;
+
+    expectOK($res);
+    my $json = expectJSON($res);
+
+    ok( $json->{certificate}, 'Got certificate in response' );
+    ok( $json->{certificate} =~ /^ssh-ed25519-cert-v01\@openssh\.com\s+/,
+        'Certificate is in correct format' );
+    ok( $json->{serial}, 'Got serial number' );
+    ok( $json->{valid_until}, 'Got valid_until timestamp' );
+    ok( $json->{principals} && ref $json->{principals} eq 'ARRAY',
+        'Got principals array' );
+    ok( $json->{key_id}, 'Got key_id' );
+    ok( $json->{key_id} =~ /dwho\@llng-/, 'Key ID contains username' );
+
+    diag("Certificate serial: $json->{serial}");
+    diag("Certificate key_id: $json->{key_id}");
+    diag("Certificate principals: " . join(',', @{$json->{principals}}));
+}
+
+# Test 8: POST /ssh/sign with custom principals
+$sign_body = to_json( {
+    public_key => $userPubKey,
+    principals => ['admin', 'root'],
+} );
+ok(
+    $res = $op->_post(
+        '/ssh/sign',
+        IO::String->new($sign_body),
+        accept => 'application/json',
+        type   => 'application/json',
+        length => length($sign_body),
+        cookie => "lemonldap=$id",
+    ),
+    'POST /ssh/sign with custom principals'
+);
+
+SKIP: {
+    skip "ssh-keygen may not support Ed25519 PEM keys", 2 if $res->[0] == 500;
+
+    expectOK($res);
+    my $json = expectJSON($res);
+    ok( grep( { $_ eq 'admin' } @{$json->{principals}} ),
+        'Custom principal admin included' );
+    ok( grep( { $_ eq 'root' } @{$json->{principals}} ),
+        'Custom principal root included' );
+}
+
+# Test 9: POST /ssh/sign with excessive validity (should be capped)
+$sign_body = to_json( {
+    public_key       => $userPubKey,
+    validity_minutes => 9999,
+} );
+ok(
+    $res = $op->_post(
+        '/ssh/sign',
+        IO::String->new($sign_body),
+        accept => 'application/json',
+        type   => 'application/json',
+        length => length($sign_body),
+        cookie => "lemonldap=$id",
+    ),
+    'POST /ssh/sign with excessive validity'
+);
+
+SKIP: {
+    skip "ssh-keygen may not support Ed25519 PEM keys", 1 if $res->[0] == 500;
+    expectOK($res);
+    # We can't easily check the validity was capped without parsing the cert,
+    # but the request should succeed
+}
+
+# Test 10: POST /ssh/sign with invalid public key format
+$sign_body = to_json( {
+    public_key => 'not-a-valid-key',
+} );
+ok(
+    $res = $op->_post(
+        '/ssh/sign',
+        IO::String->new($sign_body),
+        accept => 'application/json',
+        type   => 'application/json',
+        length => length($sign_body),
+        cookie => "lemonldap=$id",
+    ),
+    'POST /ssh/sign with invalid public key'
+);
+expectReject( $res, 400 );
+
+# Test 11: POST /ssh/sign without public_key parameter
+$sign_body = to_json( {
+    validity_minutes => 10,
+} );
+ok(
+    $res = $op->_post(
+        '/ssh/sign',
+        IO::String->new($sign_body),
+        accept => 'application/json',
+        type   => 'application/json',
+        length => length($sign_body),
+        cookie => "lemonldap=$id",
+    ),
+    'POST /ssh/sign without public_key'
+);
+expectReject( $res, 400 );
+
+# ============================================
+# PART 4: SSH CA disabled tests
+# ============================================
+
+# Create a new instance without SSH CA enabled
+my $op_no_sshca;
+ok(
+    $op_no_sshca = LLNG::Manager::Test->new( {
+            ini => {
+                logLevel                        => $debug,
+                domain                          => 'op2.com',
+                portal                          => 'http://auth.op2.com',
+                authentication                  => 'Demo',
+                userDB                          => 'Same',
+                issuerDBOpenIDConnectActivation => 1,
+                oidcRPMetaDataOptions           => {
+                    'pam-access' => {
+                        oidcRPMetaDataOptionsDisplayName  => 'PAM Access',
+                        oidcRPMetaDataOptionsClientID     => 'pam-access',
+                        oidcRPMetaDataOptionsClientSecret => 'pamsecret',
+                    }
+                },
+                oidcOPMetaDataOptions    => {},
+                oidcOPMetaDataJSON       => {},
+                oidcOPMetaDataJWKS       => {},
+                oidcServicePrivateKeySig => oidc_key_op_private_sig(),
+                oidcServicePublicKeySig  => oidc_cert_op_public_sig(),
+
+                # PAM Access enabled but SSH CA disabled
+                pamAccessActivation => 1,
+                sshCaActivation     => 0,
+            }
+        }
+    ),
+    'OP with PamAccess but SSH CA disabled'
+);
+
+# Test 8: GET /ssh/ca should fail when SSH CA is disabled
+ok(
+    $res = $op_no_sshca->_get(
+        '/ssh/ca',
+        accept => 'text/plain',
+    ),
+    'GET /ssh/ca with SSH CA disabled'
+);
+# When SSH CA is disabled, the route is not registered, so we get a redirect or error
+ok( $res->[0] != 200 || $res->[2]->[0] !~ /^ssh-/, 'SSH CA endpoint not available when disabled' );
+
+# Cleanup
+clean_sessions();
+done_testing();
diff --git a/lemonldap-ng-portal/t/78-PamAccess.t b/lemonldap-ng-portal/t/78-PamAccess.t
new file mode 100644
index 000000000..7cb15e824
--- /dev/null
+++ b/lemonldap-ng-portal/t/78-PamAccess.t
@@ -0,0 +1,584 @@
+use warnings;
+use Test::More;
+use strict;
+use IO::String;
+use JSON;
+
+require 't/test-lib.pm';
+require 't/oidc-lib.pm';
+
+my $debug = 'error';
+my ( $op, $res );
+
+# Initialization - OP with PAM Access and Device Authorization plugins enabled
+ok(
+    $op = LLNG::Manager::Test->new( {
+            ini => {
+                logLevel                        => $debug,
+                domain                          => 'op.com',
+                portal                          => 'http://auth.op.com',
+                authentication                  => 'Demo',
+                userDB                          => 'Same',
+                issuerDBOpenIDConnectActivation => 1,
+                issuerDBOpenIDConnectRule       => '$uid eq "french"',
+                oidcRPMetaDataExportedVars      => {
+                    'pam-access' => {
+                        email  => 'mail',
+                        name   => 'cn',
+                        groups => 'groups',
+                    }
+                },
+                pamAccessExportedVars => {
+                    gecos => 'cn',
+                    shell => 'uid',  # Using uid as dummy shell value for test
+                },
+                oidcServiceMetaDataAuthorizeURI       => 'authorize',
+                oidcServiceMetaDataCheckSessionURI    => 'check_session',
+                oidcServiceMetaDataJWKSURI            => 'jwks',
+                oidcServiceMetaDataEndSessionURI      => 'logout',
+                oidcServiceMetaDataRegistrationURI    => 'register',
+                oidcServiceMetaDataTokenURI           => 'token',
+                oidcServiceMetaDataUserInfoURI        => 'userinfo',
+                oidcServiceMetaDataIntrospectionURI   => 'introspect',
+                oidcServiceAllowHybridFlow            => 1,
+                oidcServiceAllowImplicitFlow          => 1,
+                oidcServiceAllowAuthorizationCodeFlow => 1,
+                oidcRPMetaDataOptions                 => {
+                    'pam-access' => {
+                        oidcRPMetaDataOptionsDisplayName  => 'PAM Access',
+                        oidcRPMetaDataOptionsClientID     => 'pam-access',
+                        oidcRPMetaDataOptionsClientSecret => 'pamsecret',
+                        oidcRPMetaDataOptionsAccessTokenExpiration => 600,
+                        oidcRPMetaDataOptionsAllowDeviceAuthorizationGrant => 1,
+                    }
+                },
+                oidcRPMetaDataScopeRules => {
+                    'pam-access' => {
+                        pam          => '1',
+                        'pam:server' => '1',
+                    }
+                },
+                oidcOPMetaDataOptions    => {},
+                oidcOPMetaDataJSON       => {},
+                oidcOPMetaDataJWKS       => {},
+                oidcServicePrivateKeySig => oidc_key_op_private_sig(),
+                oidcServicePublicKeySig  => oidc_cert_op_public_sig(),
+                pamAccessActivation      => 1,
+                portalDisplayPamAccess   => 1,
+                pamAccessTokenDuration   => 600,
+                pamAccessMaxDuration     => 3600,
+                pamAccessServerGroups    => {
+                    default    => '$groups =~ /users/',
+                    production => '$groups =~ /admins/',
+                    dev        => '1',
+                },
+                pamAccessRp => 'pam-access',
+            }
+        }
+    ),
+    'OP with PamAccess and DeviceAuthorization initialized'
+);
+
+# ============================================
+# PART 1: User token generation tests (/pam)
+# ============================================
+
+# Test 1: Authenticate a user
+my $query = 'user=french&password=french';
+ok(
+    $res = $op->_post(
+        '/',
+        IO::String->new($query),
+        accept => 'text/html',
+        length => length($query),
+    ),
+    'Auth query'
+);
+my $id = expectCookie($res);
+ok( $id, 'Got session cookie' );
+
+# Test 2: Access /pam interface (authenticated)
+ok(
+    $res = $op->_get(
+        '/pam',
+        accept => 'text/html',
+        cookie => "lemonldap=$id",
+    ),
+    'GET /pam interface'
+);
+expectOK($res);
+
+# Test 3: Generate a PAM token via POST /pam
+$query = 'duration=300';
+ok(
+    $res = $op->_post(
+        '/pam',
+        IO::String->new($query),
+        accept => 'application/json',
+        cookie => "lemonldap=$id",
+        length => length($query),
+    ),
+    'POST /pam to generate token'
+);
+expectOK($res);
+my $json = expectJSON($res);
+ok( $json->{token},             'Got access token' );
+ok( $json->{login} eq 'french', 'Correct login returned' );
+ok( $json->{expires_in} == 300, 'Correct expiration returned' );
+
+my $user_token = $json->{token};
+diag("User token: $user_token");
+
+# Note: User tokens are now one-time PAMTOKEN sessions, not OIDC access tokens.
+# They will be verified via /pam/verify after server enrollment (see PART 3).
+
+# Test 5: Test maximum duration enforcement
+$query = 'duration=9999';
+ok(
+    $res = $op->_post(
+        '/pam',
+        IO::String->new($query),
+        accept => 'application/json',
+        cookie => "lemonldap=$id",
+        length => length($query),
+    ),
+    'POST /pam with excessive duration'
+);
+expectOK($res);
+$json = expectJSON($res);
+ok( $json->{expires_in} <= 3600, 'Duration capped at max (3600)' );
+
+# ============================================
+# PART 2: Server enrollment via Device Authorization Grant
+# ============================================
+
+# Test 6: Initiate Device Authorization flow
+$query = 'client_id=pam-access&scope=pam:server';
+ok(
+    $res = $op->_post(
+        '/oauth2/device',
+        IO::String->new($query),
+        accept => 'application/json',
+        length => length($query),
+    ),
+    'POST /oauth2/device to initiate server enrollment'
+);
+expectOK($res);
+$json = expectJSON($res);
+ok( $json->{device_code},      'Got device_code' );
+ok( $json->{user_code},        'Got user_code' );
+ok( $json->{verification_uri}, 'Got verification_uri' );
+
+my $device_code = $json->{device_code};
+my $user_code   = $json->{user_code};
+diag("Device code: $device_code");
+diag("User code: $user_code");
+
+# Remove hyphen from user_code for submission
+$user_code =~ s/-//g;
+
+# Test 7: Admin validates the device (authenticate and approve)
+# First, access the verification page
+ok(
+    $res = $op->_get(
+        '/device',
+        accept => 'text/html',
+        cookie => "lemonldap=$id",
+    ),
+    'GET /device verification page'
+);
+expectOK($res);
+
+# Submit the user code
+$query = "user_code=$user_code";
+ok(
+    $res = $op->_post(
+        '/device',
+        IO::String->new($query),
+        accept => 'text/html',
+        cookie => "lemonldap=$id",
+        length => length($query),
+    ),
+    'POST /device with user_code'
+);
+expectOK($res);
+
+# Approve the device
+$query = "user_code=$user_code&confirm=1";
+ok(
+    $res = $op->_post(
+        '/device',
+        IO::String->new($query),
+        accept => 'text/html',
+        cookie => "lemonldap=$id",
+        length => length($query),
+    ),
+    'POST /device to approve'
+);
+expectOK($res);
+
+# Test 8: Server polls for token
+$query =
+    "grant_type=urn:ietf:params:oauth:grant-type:device_code"
+  . "&device_code=$device_code"
+  . "&client_id=pam-access"
+  . "&client_secret=pamsecret";
+ok(
+    $res = $op->_post(
+        '/oauth2/token',
+        IO::String->new($query),
+        accept => 'application/json',
+        length => length($query),
+    ),
+    'POST /oauth2/token with device_code grant'
+);
+expectOK($res);
+$json = expectJSON($res);
+ok( $json->{access_token}, 'Got server access_token' );
+
+my $server_token = $json->{access_token};
+diag("Server token: $server_token");
+
+# ============================================
+# PART 2b: Verify one-time user token via /pam/verify
+# ============================================
+
+# Test: Verify the one-time user token via /pam/verify
+my $verify_body = to_json( { token => $user_token } );
+ok(
+    $res = $op->_post(
+        '/pam/verify',
+        IO::String->new($verify_body),
+        accept => 'application/json',
+        type   => 'application/json',
+        length => length($verify_body),
+        custom => {
+            HTTP_AUTHORIZATION => "Bearer $server_token",
+        },
+    ),
+    'POST /pam/verify to validate user token'
+);
+expectOK($res);
+$json = expectJSON($res);
+ok( $json->{valid},             'Token is valid' );
+ok( $json->{user} eq 'french',  'Correct user returned' );
+ok( ref $json->{groups} eq 'ARRAY', 'Groups is an array' );
+
+# Test: Verify exported attributes are present
+ok( ref $json->{attrs} eq 'HASH', 'Attrs object is present' );
+ok( $json->{attrs}->{gecos},      'gecos attribute exported' );
+ok( $json->{attrs}->{shell},      'shell attribute exported' );
+diag("Exported attrs: gecos=$json->{attrs}->{gecos}, shell=$json->{attrs}->{shell}");
+
+# Test: Try to verify the same token again (should fail - one-time use)
+ok(
+    $res = $op->_post(
+        '/pam/verify',
+        IO::String->new($verify_body),
+        accept => 'application/json',
+        type   => 'application/json',
+        length => length($verify_body),
+        custom => {
+            HTTP_AUTHORIZATION => "Bearer $server_token",
+        },
+    ),
+    'POST /pam/verify again (token already consumed)'
+);
+expectOK($res);
+$json = expectJSON($res);
+ok( !$json->{valid},                        'Token is no longer valid (one-time use)' );
+ok( $json->{error} =~ /invalid|expired/i,   'Error message indicates invalid/expired token' );
+
+# ============================================
+# PART 3: Server-to-server authorization (/pam/authorize)
+# ============================================
+
+# Test 9: Test /pam/authorize without token (should fail 401)
+my $auth_body = to_json( { user => 'french', host => 'server.example.com' } );
+ok(
+    $res = $op->_post(
+        '/pam/authorize',
+        IO::String->new($auth_body),
+        accept => 'application/json',
+        type   => 'application/json',
+        length => length($auth_body),
+    ),
+    'POST /pam/authorize without Bearer token'
+);
+expectReject( $res, 401 );
+
+# Test 10: Test /pam/authorize with PAMTOKEN (should fail 401 - not a valid OIDC token)
+# Note: PAM user tokens are stored as sessions (kind=PAMTOKEN), not as OIDC access tokens.
+# They cannot be used as Bearer tokens for /pam/authorize.
+ok(
+    $res = $op->_post(
+        '/pam/authorize',
+        IO::String->new($auth_body),
+        accept => 'application/json',
+        type   => 'application/json',
+        length => length($auth_body),
+        custom => {
+            HTTP_AUTHORIZATION => "Bearer $user_token",
+        },
+    ),
+    'POST /pam/authorize with PAMTOKEN (not a valid OIDC Bearer token)'
+);
+expectReject( $res, 401 );
+
+# Test 11: Test /pam/authorize with enrolled server token
+ok(
+    $res = $op->_post(
+        '/pam/authorize',
+        IO::String->new($auth_body),
+        accept => 'application/json',
+        type   => 'application/json',
+        length => length($auth_body),
+        custom => {
+            HTTP_AUTHORIZATION => "Bearer $server_token",
+        },
+    ),
+    'POST /pam/authorize with enrolled server token'
+);
+expectOK($res);
+$json = expectJSON($res);
+ok( exists $json->{authorized}, 'Response has authorized field' );
+ok( $json->{user} eq 'french',  'Correct user in response' );
+
+# Test 12: Test /pam/authorize with non-existent user
+$auth_body = to_json( { user => 'nonexistent', host => 'server.example.com' } );
+ok(
+    $res = $op->_post(
+        '/pam/authorize',
+        IO::String->new($auth_body),
+        accept => 'application/json',
+        type   => 'application/json',
+        length => length($auth_body),
+        custom => {
+            HTTP_AUTHORIZATION => "Bearer $server_token",
+        },
+    ),
+    'POST /pam/authorize with non-existent user'
+);
+expectOK($res);
+$json = expectJSON($res);
+ok( !$json->{authorized}, 'User not authorized (not found)' );
+ok( $json->{reason},      'Reason provided' );
+
+# Test 13: Test /pam/authorize with missing user parameter
+$auth_body = to_json( { host => 'server.example.com' } );
+ok(
+    $res = $op->_post(
+        '/pam/authorize',
+        IO::String->new($auth_body),
+        accept => 'application/json',
+        type   => 'application/json',
+        length => length($auth_body),
+        custom => {
+            HTTP_AUTHORIZATION => "Bearer $server_token",
+        },
+    ),
+    'POST /pam/authorize without user parameter'
+);
+expectReject( $res, 400 );
+
+# Test 14: Test /pam/authorize with invalid JSON
+$auth_body = 'not valid json';
+ok(
+    $res = $op->_post(
+        '/pam/authorize',
+        IO::String->new($auth_body),
+        accept => 'application/json',
+        type   => 'application/json',
+        length => length($auth_body),
+        custom => {
+            HTTP_AUTHORIZATION => "Bearer $server_token",
+        },
+    ),
+    'POST /pam/authorize with invalid JSON'
+);
+expectReject( $res, 400 );
+
+# ============================================
+# PART 4: Server groups tests
+# ============================================
+
+# Test 15: Test /pam/authorize with default server_group (user is in 'users' group)
+$auth_body = to_json( { user => 'french', host => 'server.example.com' } );
+ok(
+    $res = $op->_post(
+        '/pam/authorize',
+        IO::String->new($auth_body),
+        accept => 'application/json',
+        type   => 'application/json',
+        length => length($auth_body),
+        custom => {
+            HTTP_AUTHORIZATION => "Bearer $server_token",
+        },
+    ),
+    'POST /pam/authorize with implicit default server_group'
+);
+expectOK($res);
+$json = expectJSON($res);
+ok( $json->{authorized},
+    'User authorized for default group (has users group)' );
+
+# Test 16: Test /pam/authorize with explicit default server_group
+$auth_body = to_json( {
+        user         => 'french',
+        host         => 'server.example.com',
+        server_group => 'default'
+    }
+);
+ok(
+    $res = $op->_post(
+        '/pam/authorize',
+        IO::String->new($auth_body),
+        accept => 'application/json',
+        type   => 'application/json',
+        length => length($auth_body),
+        custom => {
+            HTTP_AUTHORIZATION => "Bearer $server_token",
+        },
+    ),
+    'POST /pam/authorize with explicit default server_group'
+);
+expectOK($res);
+$json = expectJSON($res);
+ok( $json->{authorized}, 'User authorized for explicit default group' );
+
+# Test 17: Test /pam/authorize with 'dev' server_group (rule is '1' = allow all)
+$auth_body = to_json(
+    { user => 'french', host => 'dev.example.com', server_group => 'dev' } );
+ok(
+    $res = $op->_post(
+        '/pam/authorize',
+        IO::String->new($auth_body),
+        accept => 'application/json',
+        type   => 'application/json',
+        length => length($auth_body),
+        custom => {
+            HTTP_AUTHORIZATION => "Bearer $server_token",
+        },
+    ),
+    'POST /pam/authorize with dev server_group'
+);
+expectOK($res);
+$json = expectJSON($res);
+ok( $json->{authorized}, 'User authorized for dev group (rule is 1)' );
+
+# Test 18: Test /pam/authorize with 'production' server_group (user NOT in admins)
+$auth_body = to_json( {
+        user         => 'french',
+        host         => 'prod.example.com',
+        server_group => 'production'
+    }
+);
+ok(
+    $res = $op->_post(
+        '/pam/authorize',
+        IO::String->new($auth_body),
+        accept => 'application/json',
+        type   => 'application/json',
+        length => length($auth_body),
+        custom => {
+            HTTP_AUTHORIZATION => "Bearer $server_token",
+        },
+    ),
+    'POST /pam/authorize with production server_group'
+);
+expectOK($res);
+$json = expectJSON($res);
+ok( !$json->{authorized},
+    'User NOT authorized for production (not in admins group)' );
+ok( $json->{reason}, 'Reason provided for denial' );
+
+# Test 19: Test /pam/authorize with unknown server_group (should fallback to default)
+$auth_body = to_json( {
+        user         => 'french',
+        host         => 'unknown.example.com',
+        server_group => 'unknown_group'
+    }
+);
+ok(
+    $res = $op->_post(
+        '/pam/authorize',
+        IO::String->new($auth_body),
+        accept => 'application/json',
+        type   => 'application/json',
+        length => length($auth_body),
+        custom => {
+            HTTP_AUTHORIZATION => "Bearer $server_token",
+        },
+    ),
+    'POST /pam/authorize with unknown server_group (fallback to default)'
+);
+expectOK($res);
+$json = expectJSON($res);
+ok( $json->{authorized}, 'User authorized via fallback to default rule' );
+
+# ============================================
+# PART 5: NSS userinfo tests (/pam/userinfo)
+# ============================================
+
+# Test 20: Test /pam/userinfo for existing user
+my $userinfo_body = to_json( { user => 'french' } );
+ok(
+    $res = $op->_post(
+        '/pam/userinfo',
+        IO::String->new($userinfo_body),
+        accept => 'application/json',
+        type   => 'application/json',
+        length => length($userinfo_body),
+        custom => {
+            HTTP_AUTHORIZATION => "Bearer $server_token",
+        },
+    ),
+    'POST /pam/userinfo for existing user'
+);
+expectOK($res);
+$json = expectJSON($res);
+ok( $json->{found},            'User found' );
+ok( $json->{user} eq 'french', 'Correct username returned' );
+ok( ref $json->{groups} eq 'ARRAY', 'Groups is an array' );
+
+# Test: Check exported attributes
+ok( $json->{gecos}, 'gecos attribute exported via pamAccessExportedVars' );
+diag("Userinfo attrs: gecos=$json->{gecos}");
+
+# Test 21: Test /pam/userinfo for non-existing user
+$userinfo_body = to_json( { user => 'nonexistent' } );
+ok(
+    $res = $op->_post(
+        '/pam/userinfo',
+        IO::String->new($userinfo_body),
+        accept => 'application/json',
+        type   => 'application/json',
+        length => length($userinfo_body),
+        custom => {
+            HTTP_AUTHORIZATION => "Bearer $server_token",
+        },
+    ),
+    'POST /pam/userinfo for non-existing user'
+);
+expectOK($res);
+$json = expectJSON($res);
+ok( !$json->{found}, 'User not found' );
+
+# Test 22: Test /pam/userinfo without Bearer token
+ok(
+    $res = $op->_post(
+        '/pam/userinfo',
+        IO::String->new($userinfo_body),
+        accept => 'application/json',
+        type   => 'application/json',
+        length => length($userinfo_body),
+    ),
+    'POST /pam/userinfo without Bearer token'
+);
+expectReject( $res, 401 );
+
+# Cleanup
+clean_sessions();
+done_testing();
+
+__END__
diff --git a/lemonldap-ng-portal/t/test_pam.pl b/lemonldap-ng-portal/t/test_pam.pl
new file mode 100644
index 000000000..f544058e0
--- /dev/null
+++ b/lemonldap-ng-portal/t/test_pam.pl
@@ -0,0 +1,79 @@
+use warnings;
+use Test::More;
+use strict;
+use IO::String;
+use JSON;
+
+require 't/test-lib.pm';
+require 't/oidc-lib.pm';
+
+my $op = LLNG::Manager::Test->new({
+    ini => {
+        logLevel                        => "error",
+        domain                          => "op.com",
+        portal                          => "http://auth.op.com",
+        authentication                  => "Demo",
+        userDB                          => "Same",
+        issuerDBOpenIDConnectActivation => 1,
+        issuerDBOpenIDConnectRule       => '$uid eq "french"',
+        oidcRPMetaDataExportedVars      => { "pam-access" => { groups => "groups" } },
+        oidcServiceMetaDataAuthorizeURI       => "authorize",
+        oidcServiceMetaDataTokenURI           => "token",
+        oidcServiceMetaDataIntrospectionURI   => "introspect",
+        oidcRPMetaDataOptions                 => {
+            "pam-access" => {
+                oidcRPMetaDataOptionsClientID     => "pam-access",
+                oidcRPMetaDataOptionsClientSecret => "pamsecret",
+                oidcRPMetaDataOptionsAllowDeviceAuthorizationGrant => 1,
+            }
+        },
+        oidcRPMetaDataScopeRules => { "pam-access" => { pam => "1", "pam:server" => "1" } },
+        oidcServicePrivateKeySig => oidc_key_op_private_sig(),
+        oidcServicePublicKeySig  => oidc_cert_op_public_sig(),
+        pamAccessActivation      => 1,
+        pamAccessServerGroups    => {
+            default    => '$groups =~ /users/',
+            production => '$groups =~ /admins/',
+        },
+        pamAccessRp => "pam-access",
+    }
+});
+
+# Authenticate user
+my $query = "user=french&password=french";
+my $res = $op->_post("/", IO::String->new($query), accept => "text/html", length => length($query));
+my $id = expectCookie($res);
+
+# Get device code
+$query = "client_id=pam-access&scope=pam:server";
+$res = $op->_post("/oauth2/device", IO::String->new($query), accept => "application/json", length => length($query));
+my $json = from_json($res->[2]->[0]);
+my $device_code = $json->{device_code};
+my $user_code = $json->{user_code};
+
+# Approve device
+$res = $op->_get("/device", accept => "text/html", cookie => "lemonldap=$id", query => "user_code=$user_code");
+$res = $op->_post("/device", IO::String->new("user_code=$user_code&confirm=1"), accept => "text/html", cookie => "lemonldap=$id", length => length("user_code=$user_code&confirm=1"));
+
+# Get server token
+$query = "grant_type=urn:ietf:params:oauth:grant-type:device_code&device_code=$device_code&client_id=pam-access&client_secret=pamsecret";
+$res = $op->_post("/oauth2/token", IO::String->new($query), accept => "application/json", length => length($query));
+$json = from_json($res->[2]->[0]);
+my $server_token = $json->{access_token};
+
+# Test authorize with production
+my $auth_body = to_json({ user => "french", host => "test", server_group => "production" });
+$res = $op->_post(
+    "/pam/authorize",
+    IO::String->new($auth_body),
+    accept => "application/json",
+    type   => "application/json",
+    length => length($auth_body),
+    custom => { HTTP_AUTHORIZATION => "Bearer $server_token" },
+);
+$json = from_json($res->[2]->[0]);
+print "Authorized: " . ($json->{authorized} ? "true" : "false") . "\n";
+print "Groups: " . join(",", @{$json->{groups} || []}) . "\n";
+print "Reason: " . ($json->{reason} || "none") . "\n";
+
+done_testing();
