# Service Accounts Configuration for Open Bastion
#
# This file defines local service accounts (ansible, backup, deploy, etc.)
# that authenticate via SSH key only, without OIDC authentication.
#
# SECURITY: This file must be:
# - Owned by root (uid 0)
# - Mode 0600 (read/write only by owner)
# - Not a symlink
#
# IMPORTANT: SSH server must have ExposeAuthInfo=yes in /etc/ssh/sshd_config
# for fingerprint validation to work.
#
# File location: /etc/open-bastion/service-accounts.conf
# (configurable via service_accounts_file in openbastion.conf)
#
# Format:
#   [accountname]
#   key_fingerprint = SHA256:...
#   sudo_allowed = true|false
#   sudo_nopasswd = true|false (optional, default: false)
#   gecos = Description (optional)
#   shell = /path/to/shell (optional, must be in approved_shells)
#   home = /path/to/home (optional, must match approved_home_prefixes)
#   uid = number (optional, 0 = auto-assign)
#   gid = number (optional, 0 = auto-assign)
#
# Account names must:
# - Start with a lowercase letter or underscore
# - Contain only lowercase letters, digits, underscores, and hyphens
# - Be at most 32 characters long
#
# Key fingerprint must:
# - Start with SHA256: or MD5:
# - Contain only base64-safe characters
#
# The SSH key fingerprint can be obtained with:
#   ssh-keygen -lf /path/to/key.pub
#
# Example output: 256 SHA256:abc123def456 ansible@example.com (ED25519)
# Use the SHA256:... part as the fingerprint.

# Ansible automation account
# Used for configuration management and deployments
[ansible]
key_fingerprint = SHA256:CHANGE_ME_ansible_key_fingerprint
sudo_allowed = true
sudo_nopasswd = true
gecos = Ansible Automation
shell = /bin/bash
home = /var/lib/ansible

# Backup service account
# Used for automated backups (rsync, borg, restic, etc.)
[backup]
key_fingerprint = SHA256:CHANGE_ME_backup_key_fingerprint
sudo_allowed = false
gecos = Backup Service Account
shell = /bin/sh
home = /var/lib/backup

# Monitoring agent account
# Used for Prometheus node exporter, Zabbix agent, etc.
[monitoring]
key_fingerprint = SHA256:CHANGE_ME_monitoring_key_fingerprint
sudo_allowed = false
gecos = Monitoring Agent
shell = /bin/sh
home = /var/lib/monitoring

# Deployment account
# Used for CI/CD pipelines (GitLab Runner, GitHub Actions, etc.)
[deploy]
key_fingerprint = SHA256:CHANGE_ME_deploy_key_fingerprint
sudo_allowed = true
sudo_nopasswd = false
gecos = Deployment Account
shell = /bin/bash
home = /home/deploy
